<transformation>
  <info>
    <name>repair_template</name>
    <description/>
    <extended_description/>
    <trans_version/>
    <trans_type>Normal</trans_type>
    <directory>/home/aparna</directory>
    <parameters>
    </parameters>
    <log>
      <trans-log-table>
        <connection/>
        <schema/>
        <table/>
        <size_limit_lines/>
        <interval/>
        <timeout_days/>
        <field>
          <id>ID_BATCH</id>
          <enabled>Y</enabled>
          <name>ID_BATCH</name>
        </field>
        <field>
          <id>CHANNEL_ID</id>
          <enabled>Y</enabled>
          <name>CHANNEL_ID</name>
        </field>
        <field>
          <id>TRANSNAME</id>
          <enabled>Y</enabled>
          <name>TRANSNAME</name>
        </field>
        <field>
          <id>STATUS</id>
          <enabled>Y</enabled>
          <name>STATUS</name>
        </field>
        <field>
          <id>LINES_READ</id>
          <enabled>Y</enabled>
          <name>LINES_READ</name>
          <subject/>
        </field>
        <field>
          <id>LINES_WRITTEN</id>
          <enabled>Y</enabled>
          <name>LINES_WRITTEN</name>
          <subject/>
        </field>
        <field>
          <id>LINES_UPDATED</id>
          <enabled>Y</enabled>
          <name>LINES_UPDATED</name>
          <subject/>
        </field>
        <field>
          <id>LINES_INPUT</id>
          <enabled>Y</enabled>
          <name>LINES_INPUT</name>
          <subject/>
        </field>
        <field>
          <id>LINES_OUTPUT</id>
          <enabled>Y</enabled>
          <name>LINES_OUTPUT</name>
          <subject/>
        </field>
        <field>
          <id>LINES_REJECTED</id>
          <enabled>Y</enabled>
          <name>LINES_REJECTED</name>
          <subject/>
        </field>
        <field>
          <id>ERRORS</id>
          <enabled>Y</enabled>
          <name>ERRORS</name>
        </field>
        <field>
          <id>STARTDATE</id>
          <enabled>Y</enabled>
          <name>STARTDATE</name>
        </field>
        <field>
          <id>ENDDATE</id>
          <enabled>Y</enabled>
          <name>ENDDATE</name>
        </field>
        <field>
          <id>LOGDATE</id>
          <enabled>Y</enabled>
          <name>LOGDATE</name>
        </field>
        <field>
          <id>DEPDATE</id>
          <enabled>Y</enabled>
          <name>DEPDATE</name>
        </field>
        <field>
          <id>REPLAYDATE</id>
          <enabled>Y</enabled>
          <name>REPLAYDATE</name>
        </field>
        <field>
          <id>LOG_FIELD</id>
          <enabled>Y</enabled>
          <name>LOG_FIELD</name>
        </field>
        <field>
          <id>EXECUTING_SERVER</id>
          <enabled>N</enabled>
          <name>EXECUTING_SERVER</name>
        </field>
        <field>
          <id>EXECUTING_USER</id>
          <enabled>N</enabled>
          <name>EXECUTING_USER</name>
        </field>
        <field>
          <id>CLIENT</id>
          <enabled>N</enabled>
          <name>CLIENT</name>
        </field>
      </trans-log-table>
      <perf-log-table>
        <connection/>
        <schema/>
        <table/>
        <interval/>
        <timeout_days/>
        <field>
          <id>ID_BATCH</id>
          <enabled>Y</enabled>
          <name>ID_BATCH</name>
        </field>
        <field>
          <id>SEQ_NR</id>
          <enabled>Y</enabled>
          <name>SEQ_NR</name>
        </field>
        <field>
          <id>LOGDATE</id>
          <enabled>Y</enabled>
          <name>LOGDATE</name>
        </field>
        <field>
          <id>TRANSNAME</id>
          <enabled>Y</enabled>
          <name>TRANSNAME</name>
        </field>
        <field>
          <id>STEPNAME</id>
          <enabled>Y</enabled>
          <name>STEPNAME</name>
        </field>
        <field>
          <id>STEP_COPY</id>
          <enabled>Y</enabled>
          <name>STEP_COPY</name>
        </field>
        <field>
          <id>LINES_READ</id>
          <enabled>Y</enabled>
          <name>LINES_READ</name>
        </field>
        <field>
          <id>LINES_WRITTEN</id>
          <enabled>Y</enabled>
          <name>LINES_WRITTEN</name>
        </field>
        <field>
          <id>LINES_UPDATED</id>
          <enabled>Y</enabled>
          <name>LINES_UPDATED</name>
        </field>
        <field>
          <id>LINES_INPUT</id>
          <enabled>Y</enabled>
          <name>LINES_INPUT</name>
        </field>
        <field>
          <id>LINES_OUTPUT</id>
          <enabled>Y</enabled>
          <name>LINES_OUTPUT</name>
        </field>
        <field>
          <id>LINES_REJECTED</id>
          <enabled>Y</enabled>
          <name>LINES_REJECTED</name>
        </field>
        <field>
          <id>ERRORS</id>
          <enabled>Y</enabled>
          <name>ERRORS</name>
        </field>
        <field>
          <id>INPUT_BUFFER_ROWS</id>
          <enabled>Y</enabled>
          <name>INPUT_BUFFER_ROWS</name>
        </field>
        <field>
          <id>OUTPUT_BUFFER_ROWS</id>
          <enabled>Y</enabled>
          <name>OUTPUT_BUFFER_ROWS</name>
        </field>
      </perf-log-table>
      <channel-log-table>
        <connection/>
        <schema/>
        <table/>
        <timeout_days/>
        <field>
          <id>ID_BATCH</id>
          <enabled>Y</enabled>
          <name>ID_BATCH</name>
        </field>
        <field>
          <id>CHANNEL_ID</id>
          <enabled>Y</enabled>
          <name>CHANNEL_ID</name>
        </field>
        <field>
          <id>LOG_DATE</id>
          <enabled>Y</enabled>
          <name>LOG_DATE</name>
        </field>
        <field>
          <id>LOGGING_OBJECT_TYPE</id>
          <enabled>Y</enabled>
          <name>LOGGING_OBJECT_TYPE</name>
        </field>
        <field>
          <id>OBJECT_NAME</id>
          <enabled>Y</enabled>
          <name>OBJECT_NAME</name>
        </field>
        <field>
          <id>OBJECT_COPY</id>
          <enabled>Y</enabled>
          <name>OBJECT_COPY</name>
        </field>
        <field>
          <id>REPOSITORY_DIRECTORY</id>
          <enabled>Y</enabled>
          <name>REPOSITORY_DIRECTORY</name>
        </field>
        <field>
          <id>FILENAME</id>
          <enabled>Y</enabled>
          <name>FILENAME</name>
        </field>
        <field>
          <id>OBJECT_ID</id>
          <enabled>Y</enabled>
          <name>OBJECT_ID</name>
        </field>
        <field>
          <id>OBJECT_REVISION</id>
          <enabled>Y</enabled>
          <name>OBJECT_REVISION</name>
        </field>
        <field>
          <id>PARENT_CHANNEL_ID</id>
          <enabled>Y</enabled>
          <name>PARENT_CHANNEL_ID</name>
        </field>
        <field>
          <id>ROOT_CHANNEL_ID</id>
          <enabled>Y</enabled>
          <name>ROOT_CHANNEL_ID</name>
        </field>
      </channel-log-table>
      <step-log-table>
        <connection/>
        <schema/>
        <table/>
        <timeout_days/>
        <field>
          <id>ID_BATCH</id>
          <enabled>Y</enabled>
          <name>ID_BATCH</name>
        </field>
        <field>
          <id>CHANNEL_ID</id>
          <enabled>Y</enabled>
          <name>CHANNEL_ID</name>
        </field>
        <field>
          <id>LOG_DATE</id>
          <enabled>Y</enabled>
          <name>LOG_DATE</name>
        </field>
        <field>
          <id>TRANSNAME</id>
          <enabled>Y</enabled>
          <name>TRANSNAME</name>
        </field>
        <field>
          <id>STEPNAME</id>
          <enabled>Y</enabled>
          <name>STEPNAME</name>
        </field>
        <field>
          <id>STEP_COPY</id>
          <enabled>Y</enabled>
          <name>STEP_COPY</name>
        </field>
        <field>
          <id>LINES_READ</id>
          <enabled>Y</enabled>
          <name>LINES_READ</name>
        </field>
        <field>
          <id>LINES_WRITTEN</id>
          <enabled>Y</enabled>
          <name>LINES_WRITTEN</name>
        </field>
        <field>
          <id>LINES_UPDATED</id>
          <enabled>Y</enabled>
          <name>LINES_UPDATED</name>
        </field>
        <field>
          <id>LINES_INPUT</id>
          <enabled>Y</enabled>
          <name>LINES_INPUT</name>
        </field>
        <field>
          <id>LINES_OUTPUT</id>
          <enabled>Y</enabled>
          <name>LINES_OUTPUT</name>
        </field>
        <field>
          <id>LINES_REJECTED</id>
          <enabled>Y</enabled>
          <name>LINES_REJECTED</name>
        </field>
        <field>
          <id>ERRORS</id>
          <enabled>Y</enabled>
          <name>ERRORS</name>
        </field>
        <field>
          <id>LOG_FIELD</id>
          <enabled>N</enabled>
          <name>LOG_FIELD</name>
        </field>
      </step-log-table>
      <metrics-log-table>
        <connection/>
        <schema/>
        <table/>
        <timeout_days/>
        <field>
          <id>ID_BATCH</id>
          <enabled>Y</enabled>
          <name>ID_BATCH</name>
        </field>
        <field>
          <id>CHANNEL_ID</id>
          <enabled>Y</enabled>
          <name>CHANNEL_ID</name>
        </field>
        <field>
          <id>LOG_DATE</id>
          <enabled>Y</enabled>
          <name>LOG_DATE</name>
        </field>
        <field>
          <id>METRICS_DATE</id>
          <enabled>Y</enabled>
          <name>METRICS_DATE</name>
        </field>
        <field>
          <id>METRICS_CODE</id>
          <enabled>Y</enabled>
          <name>METRICS_CODE</name>
        </field>
        <field>
          <id>METRICS_DESCRIPTION</id>
          <enabled>Y</enabled>
          <name>METRICS_DESCRIPTION</name>
        </field>
        <field>
          <id>METRICS_SUBJECT</id>
          <enabled>Y</enabled>
          <name>METRICS_SUBJECT</name>
        </field>
        <field>
          <id>METRICS_TYPE</id>
          <enabled>Y</enabled>
          <name>METRICS_TYPE</name>
        </field>
        <field>
          <id>METRICS_VALUE</id>
          <enabled>Y</enabled>
          <name>METRICS_VALUE</name>
        </field>
      </metrics-log-table>
    </log>
    <maxdate>
      <connection/>
      <table/>
      <field/>
      <offset>0.0</offset>
      <maxdiff>0.0</maxdiff>
    </maxdate>
    <size_rowset>10000</size_rowset>
    <sleep_time_empty>50</sleep_time_empty>
    <sleep_time_full>50</sleep_time_full>
    <unique_connections>N</unique_connections>
    <feedback_shown>Y</feedback_shown>
    <feedback_size>50000</feedback_size>
    <using_thread_priorities>Y</using_thread_priorities>
    <shared_objects_file/>
    <capture_step_performance>N</capture_step_performance>
    <step_performance_capturing_delay>1000</step_performance_capturing_delay>
    <step_performance_capturing_size_limit>100</step_performance_capturing_size_limit>
    <dependencies>
    </dependencies>
    <partitionschemas>
    </partitionschemas>
    <slaveservers>
      <slaveserver>
        <name>4Sight BI - PDI Server</name>
        <hostname>10.0.0.21</hostname>
        <port>9080</port>
        <webAppName>pentaho-di</webAppName>
        <username>joe</username>
        <password>Encrypted 2be98afc86aa7f2e4bb18bd63c99dbdde</password>
        <proxy_hostname/>
        <proxy_port/>
        <non_proxy_hosts/>
        <master>Y</master>
        <sslMode>N</sslMode>
      </slaveserver>
      <slaveserver>
        <name>Carte 1</name>
        <hostname>localhost</hostname>
        <port>9081</port>
        <webAppName/>
        <username>cluster</username>
        <password>Encrypted 2be98afc86aa7f2e4cb1aa265cd86aac8</password>
        <proxy_hostname/>
        <proxy_port/>
        <non_proxy_hosts/>
        <master>N</master>
        <sslMode>N</sslMode>
      </slaveserver>
      <slaveserver>
        <name>DI Server</name>
        <hostname>localhost</hostname>
        <port>9080</port>
        <webAppName>pentaho-di</webAppName>
        <username>joe</username>
        <password>Encrypted 2be98afc86aa7f2e4bb18bd63c99dbdde</password>
        <proxy_hostname/>
        <proxy_port/>
        <non_proxy_hosts/>
        <master>Y</master>
        <sslMode>N</sslMode>
      </slaveserver>
      <slaveserver>
        <name>MM_ETL_DEV</name>
        <hostname>magspentaho</hostname>
        <port>9080</port>
        <webAppName>pentaho-di</webAppName>
        <username>shota</username>
        <password>Encrypted 2be98afc86aa7f2e4cb79ce63d69dbbdb</password>
        <proxy_hostname/>
        <proxy_port/>
        <non_proxy_hosts/>
        <master>Y</master>
        <sslMode>N</sslMode>
      </slaveserver>
      <slaveserver>
        <name>MM_ETL_SERVER</name>
        <hostname>http://magspentaho</hostname>
        <port>9080</port>
        <webAppName>pentaho-di</webAppName>
        <username>shota</username>
        <password>Encrypted 2be98afc86aa7f2e4cb79ce63d69dbbdb</password>
        <proxy_hostname/>
        <proxy_port/>
        <non_proxy_hosts/>
        <master>Y</master>
        <sslMode>N</sslMode>
      </slaveserver>
      <slaveserver>
        <name>MM_ETL_TEST</name>
        <hostname>magspentahotest</hostname>
        <port>9080</port>
        <webAppName>pentaho-di</webAppName>
        <username>admin</username>
        <password>Encrypted 2be98afc86aa7f2e4bb18bd63c99dbdde</password>
        <proxy_hostname/>
        <proxy_port/>
        <non_proxy_hosts/>
        <master>N</master>
        <sslMode>N</sslMode>
      </slaveserver>
      <slaveserver>
        <name>MM_PENTAHO</name>
        <hostname>magspentaho</hostname>
        <port>9080</port>
        <webAppName>pentaho-di</webAppName>
        <username>admin</username>
        <password>Encrypted 2be98afc86aa7f2e4bb18bd63c99dbdde</password>
        <proxy_hostname/>
        <proxy_port/>
        <non_proxy_hosts/>
        <master>N</master>
        <sslMode>N</sslMode>
      </slaveserver>
      <slaveserver>
        <name>MM_PENTAHO_BTS</name>
        <hostname>129.144.25.104</hostname>
        <port>9080</port>
        <webAppName>pentaho-di</webAppName>
        <username>admin</username>
        <password>Encrypted 2be98afc86aa7f2e4bb18bd63c99dbdde</password>
        <proxy_hostname/>
        <proxy_port/>
        <non_proxy_hosts/>
        <master>N</master>
        <sslMode>N</sslMode>
      </slaveserver>
      <slaveserver>
        <name>MM_PENTAHO_DEV</name>
        <hostname>magspentahodev</hostname>
        <port>9080</port>
        <webAppName>pentaho-di</webAppName>
        <username>admin</username>
        <password>Encrypted 2be98afc86aa7f2e4bb18bd63c99dbdde</password>
        <proxy_hostname/>
        <proxy_port/>
        <non_proxy_hosts/>
        <master>Y</master>
        <sslMode>N</sslMode>
      </slaveserver>
      <slaveserver>
        <name>Master</name>
        <hostname>localhost</hostname>
        <port>8081</port>
        <webAppName/>
        <username>cluster</username>
        <password>Encrypted 2be98afc86aa7f2e4cb1aa265cd86aac8</password>
        <proxy_hostname/>
        <proxy_port/>
        <non_proxy_hosts/>
        <master>Y</master>
        <sslMode>N</sslMode>
      </slaveserver>
      <slaveserver>
        <name>SERVER1</name>
        <hostname>LOCALHOST</hostname>
        <port>3306</port>
        <webAppName/>
        <username>root</username>
        <password>Encrypted 2be98afc86aa7f2e4bb18bd63c99dbdde</password>
        <proxy_hostname/>
        <proxy_port/>
        <non_proxy_hosts/>
        <master>Y</master>
        <sslMode>N</sslMode>
      </slaveserver>
      <slaveserver>
        <name>SLAVE ONE</name>
        <hostname>192.168.2.101</hostname>
        <port>3306</port>
        <webAppName/>
        <username>root</username>
        <password>Encrypted 2be98afc86aa7f2e4a418bd63c99dbdde</password>
        <proxy_hostname/>
        <proxy_port/>
        <non_proxy_hosts/>
        <master>Y</master>
        <sslMode>N</sslMode>
      </slaveserver>
      <slaveserver>
        <name>SLAVE TWO</name>
        <hostname>192.168.2.101</hostname>
        <port>3306</port>
        <webAppName/>
        <username>root</username>
        <password>Encrypted 2be98afc86aa7f2e4bb18bd63c99dbdde</password>
        <proxy_hostname/>
        <proxy_port/>
        <non_proxy_hosts/>
        <master>N</master>
        <sslMode>N</sslMode>
      </slaveserver>
      <slaveserver>
        <name>Slave1</name>
        <hostname>localhost</hostname>
        <port>8082</port>
        <webAppName/>
        <username>cluster</username>
        <password>Encrypted 2be98afc86aa7f2e4cb1aa265cd86aac8</password>
        <proxy_hostname/>
        <proxy_port/>
        <non_proxy_hosts/>
        <master>N</master>
        <sslMode>N</sslMode>
      </slaveserver>
      <slaveserver>
        <name>Slave2</name>
        <hostname>localhost</hostname>
        <port>8083</port>
        <webAppName/>
        <username>cluster</username>
        <password>Encrypted 2be98afc86aa7f2e4cb1aa265cd86aac8</password>
        <proxy_hostname/>
        <proxy_port/>
        <non_proxy_hosts/>
        <master>N</master>
        <sslMode>N</sslMode>
      </slaveserver>
      <slaveserver>
        <name>Slave3</name>
        <hostname>localhost</hostname>
        <port>8084</port>
        <webAppName/>
        <username>cluster</username>
        <password>Encrypted 2be98afc86aa7f2e4cb1aa265cd86aac8</password>
        <proxy_hostname/>
        <proxy_port/>
        <non_proxy_hosts/>
        <master>N</master>
        <sslMode>N</sslMode>
      </slaveserver>
      <slaveserver>
        <name>local DIS</name>
        <hostname>localhost</hostname>
        <port>9080</port>
        <webAppName>pentaho-di</webAppName>
        <username>admin</username>
        <password>Encrypted 2be98afc86aa7f2e4bb18bd63c99dbdde</password>
        <proxy_hostname/>
        <proxy_port/>
        <non_proxy_hosts/>
        <master>N</master>
        <sslMode>N</sslMode>
      </slaveserver>
      <slaveserver>
        <name>magspentahodev</name>
        <hostname>magspentahodev</hostname>
        <port>9080</port>
        <webAppName>pentaho-di</webAppName>
        <username>admin</username>
        <password>Encrypted 2be98afc86aa7f2e4bb18bd63c99dbdde</password>
        <proxy_hostname/>
        <proxy_port/>
        <non_proxy_hosts/>
        <master>Y</master>
        <sslMode>N</sslMode>
      </slaveserver>
    </slaveservers>
    <clusterschemas>
      <clusterschema>
        <name>4sbi_admin</name>
        <base_port>40000</base_port>
        <sockets_buffer_size>2000</sockets_buffer_size>
        <sockets_flush_interval>5000</sockets_flush_interval>
        <sockets_compressed>Y</sockets_compressed>
        <dynamic>N</dynamic>
        <slaveservers>
        </slaveservers>
      </clusterschema>
      <clusterschema>
        <name>ClusterSchema</name>
        <base_port>40000</base_port>
        <sockets_buffer_size>2000</sockets_buffer_size>
        <sockets_flush_interval>5000</sockets_flush_interval>
        <sockets_compressed>Y</sockets_compressed>
        <dynamic>N</dynamic>
        <slaveservers>
          <name>Slave3</name>
          <name>Slave2</name>
          <name>Slave1</name>
          <name>Master</name>
        </slaveservers>
      </clusterschema>
      <clusterschema>
        <name>cluster A</name>
        <base_port>40000</base_port>
        <sockets_buffer_size>2000</sockets_buffer_size>
        <sockets_flush_interval>5000</sockets_flush_interval>
        <sockets_compressed>Y</sockets_compressed>
        <dynamic>N</dynamic>
        <slaveservers>
          <name>Carte 1</name>
          <name>local DIS</name>
        </slaveservers>
      </clusterschema>
    </clusterschemas>
    <created_user>-</created_user>
    <created_date>2018/11/09 21:35:32.456</created_date>
    <modified_user>aparna</modified_user>
    <modified_date>2018/11/09 23:29:49.308</modified_date>
    <key_for_session_key/>
    <is_key_private>N</is_key_private>
  </info>
  <notepads>
  </notepads>
  <connection>
    <name>DRABPRD</name>
    <server>172.18.1.131</server>
    <type>ORACLE</type>
    <access>Native</access>
    <database>DRABPRD</database>
    <port>1521</port>
    <username>MAGDWR</username>
    <password>Encrypted 2be98afc86aa7f2e4cb1db962ce80a0de</password>
    <servername/>
    <data_tablespace/>
    <index_tablespace/>
    <attributes>
      <attribute>
        <code>FORCE_IDENTIFIERS_TO_LOWERCASE</code>
        <attribute>N</attribute>
      </attribute>
      <attribute>
        <code>FORCE_IDENTIFIERS_TO_UPPERCASE</code>
        <attribute>N</attribute>
      </attribute>
      <attribute>
        <code>IS_CLUSTERED</code>
        <attribute>N</attribute>
      </attribute>
      <attribute>
        <code>PORT_NUMBER</code>
        <attribute>1521</attribute>
      </attribute>
      <attribute>
        <code>PRESERVE_RESERVED_WORD_CASE</code>
        <attribute>Y</attribute>
      </attribute>
      <attribute>
        <code>QUOTE_ALL_FIELDS</code>
        <attribute>N</attribute>
      </attribute>
      <attribute>
        <code>STRICT_NUMBER_38_INTERPRETATION</code>
        <attribute>N</attribute>
      </attribute>
      <attribute>
        <code>SUPPORTS_BOOLEAN_DATA_TYPE</code>
        <attribute>Y</attribute>
      </attribute>
      <attribute>
        <code>SUPPORTS_TIMESTAMP_DATA_TYPE</code>
        <attribute>Y</attribute>
      </attribute>
      <attribute>
        <code>USE_POOLING</code>
        <attribute>N</attribute>
      </attribute>
    </attributes>
  </connection>
  <connection>
    <name>magstage_DRABPRD</name>
    <server>172.18.1.131</server>
    <type>ORACLE</type>
    <access>Native</access>
    <database>DRABPRD</database>
    <port>1521</port>
    <username>magstage</username>
    <password>Encrypted 2be98afc86aa7f2e4864da925cac6a889</password>
    <servername/>
    <data_tablespace/>
    <index_tablespace/>
    <attributes>
      <attribute>
        <code>FORCE_IDENTIFIERS_TO_LOWERCASE</code>
        <attribute>N</attribute>
      </attribute>
      <attribute>
        <code>FORCE_IDENTIFIERS_TO_UPPERCASE</code>
        <attribute>N</attribute>
      </attribute>
      <attribute>
        <code>IS_CLUSTERED</code>
        <attribute>N</attribute>
      </attribute>
      <attribute>
        <code>PORT_NUMBER</code>
        <attribute>1521</attribute>
      </attribute>
      <attribute>
        <code>PRESERVE_RESERVED_WORD_CASE</code>
        <attribute>Y</attribute>
      </attribute>
      <attribute>
        <code>QUOTE_ALL_FIELDS</code>
        <attribute>N</attribute>
      </attribute>
      <attribute>
        <code>STRICT_NUMBER_38_INTERPRETATION</code>
        <attribute>N</attribute>
      </attribute>
      <attribute>
        <code>SUPPORTS_BOOLEAN_DATA_TYPE</code>
        <attribute>Y</attribute>
      </attribute>
      <attribute>
        <code>SUPPORTS_TIMESTAMP_DATA_TYPE</code>
        <attribute>Y</attribute>
      </attribute>
      <attribute>
        <code>USE_POOLING</code>
        <attribute>N</attribute>
      </attribute>
    </attributes>
  </connection>
  <connection>
    <name>STAGE_OLAP_PROD_DRA_17</name>
    <server>172.18.1.114</server>
    <type>ORACLE</type>
    <access>Native</access>
    <database>DRA17PRD</database>
    <port>1521</port>
    <username>magstage</username>
    <password>Encrypted 2be98afc86aa7f2e4a618a963ca93a8df</password>
    <servername/>
    <data_tablespace/>
    <index_tablespace/>
    <attributes>
      <attribute>
        <code>FORCE_IDENTIFIERS_TO_LOWERCASE</code>
        <attribute>N</attribute>
      </attribute>
      <attribute>
        <code>FORCE_IDENTIFIERS_TO_UPPERCASE</code>
        <attribute>N</attribute>
      </attribute>
      <attribute>
        <code>IS_CLUSTERED</code>
        <attribute>N</attribute>
      </attribute>
      <attribute>
        <code>PORT_NUMBER</code>
        <attribute>1521</attribute>
      </attribute>
      <attribute>
        <code>PRESERVE_RESERVED_WORD_CASE</code>
        <attribute>N</attribute>
      </attribute>
      <attribute>
        <code>QUOTE_ALL_FIELDS</code>
        <attribute>N</attribute>
      </attribute>
      <attribute>
        <code>SUPPORTS_BOOLEAN_DATA_TYPE</code>
        <attribute>Y</attribute>
      </attribute>
      <attribute>
        <code>SUPPORTS_TIMESTAMP_DATA_TYPE</code>
        <attribute>Y</attribute>
      </attribute>
      <attribute>
        <code>USE_POOLING</code>
        <attribute>N</attribute>
      </attribute>
    </attributes>
  </connection>
  <order>
    <hop>
      <from>FACT_POLICY_DATES</from>
      <to>DATES_LU</to>
      <enabled>Y</enabled>
    </hop>
    <hop>
      <from>STG_DM_POLICY_PV</from>
      <to>DATES_LU</to>
      <enabled>Y</enabled>
    </hop>
    <hop>
      <from>CVDRSK_TYP_AND_NM_LU</from>
      <to>CVDRSK_ENTYP_AND_LICENSE LU</to>
      <enabled>Y</enabled>
    </hop>
    <hop>
      <from>DIM_COVEREDRISK</from>
      <to>CVDRSK_TYP_AND_NM_LU</to>
      <enabled>Y</enabled>
    </hop>
    <hop>
      <from>DIM_COVEREDRISK_Entity</from>
      <to>CVDRSK_ENTYP_AND_LICENSE LU</to>
      <enabled>Y</enabled>
    </hop>
    <hop>
      <from>INSURED_LU</from>
      <to>CVDRSK_TYP_AND_NM_LU</to>
      <enabled>Y</enabled>
    </hop>
    <hop>
      <from>VDIM_FIRSTINSURED</from>
      <to>INSURED_LU</to>
      <enabled>Y</enabled>
    </hop>
    <hop>
      <from>DATES_LU</from>
      <to>INSURED_LU</to>
      <enabled>Y</enabled>
    </hop>
    <hop>
      <from>CLAIMS_CONSULTANT</from>
      <to>POLICY CALIMS CON LU</to>
      <enabled>Y</enabled>
    </hop>
    <hop>
      <from>COVERAGE_STATUS</from>
      <to>COVERAGE_STATUS LU</to>
      <enabled>Y</enabled>
    </hop>
    <hop>
      <from>COVERAGE_STATUS LU</from>
      <to>PREMIUM_LU</to>
      <enabled>Y</enabled>
    </hop>
    <hop>
      <from>DIM_COVEREDRISKEXT</from>
      <to>RISK STATE ETC</to>
      <enabled>Y</enabled>
    </hop>
    <hop>
      <from>DIM_POLICY</from>
      <to>POLICY_LU</to>
      <enabled>Y</enabled>
    </hop>
    <hop>
      <from>DIM_POLICYEXTENSION</from>
      <to>POLICY_TYPE_LU</to>
      <enabled>Y</enabled>
    </hop>
    <hop>
      <from>FACT_POLICYCOVERAGE_FOR_PREMIUM_AND_POL_STATUS</from>
      <to>PREMIUM_LU</to>
      <enabled>Y</enabled>
    </hop>
    <hop>
      <from>ILF_TERRITORY</from>
      <to>ILF_TERRITORY_LOOKUP</to>
      <enabled>Y</enabled>
    </hop>
    <hop>
      <from>POLICY CALIMS CON LU</from>
      <to>COVERAGE_STATUS LU</to>
      <enabled>Y</enabled>
    </hop>
    <hop>
      <from>POLICY_LU</from>
      <to>POLICY CALIMS CON LU</to>
      <enabled>Y</enabled>
    </hop>
    <hop>
      <from>POLICY_TYPE_LU</from>
      <to>ILF_TERRITORY_LOOKUP</to>
      <enabled>Y</enabled>
    </hop>
    <hop>
      <from>RISK STATE ETC</from>
      <to>POLICY_LU</to>
      <enabled>Y</enabled>
    </hop>
    <hop>
      <from>CVDRSK_ENTYP_AND_LICENSE LU</from>
      <to>RISK STATE ETC</to>
      <enabled>Y</enabled>
    </hop>
    <hop>
      <from>PREMIUM_LU</from>
      <to>POLICY_TYPE_LU</to>
      <enabled>Y</enabled>
    </hop>
    <hop>
      <from>DIM_COVERAGE</from>
      <to>COV_DESCRIPTION_LU</to>
      <enabled>Y</enabled>
    </hop>
    <hop>
      <from>FACT_POLICYTRANSACTION</from>
      <to>MONTHLY_TRANSACTION_LU</to>
      <enabled>Y</enabled>
    </hop>
    <hop>
      <from>FP_LEGALENTITY_COMPANY</from>
      <to>MASTER COMPANY 2</to>
      <enabled>Y</enabled>
    </hop>
    <hop>
      <from>STG_MINI_PM_POLNO_XREF</from>
      <to>MINI_UNIQID NON HUL LU</to>
      <enabled>Y</enabled>
    </hop>
    <hop>
      <from>STG_MINI_PM_POLNO_XREF 2</from>
      <to>MINI_UNIQID HUL LU </to>
      <enabled>Y</enabled>
    </hop>
    <hop>
      <from>VDIM_PRODUCER</from>
      <to>PRODUCER_NAME</to>
      <enabled>Y</enabled>
    </hop>
    <hop>
      <from>ILF_TERRITORY_LOOKUP</from>
      <to>PRODUCER_NAME</to>
      <enabled>Y</enabled>
    </hop>
    <hop>
      <from>COMMISSION_AMOUNT</from>
      <to>LOOKUP_COMMISSION_AMOUNT</to>
      <enabled>Y</enabled>
    </hop>
    <hop>
      <from>DIM_ENTITY</from>
      <to>INCEP DATE</to>
      <enabled>Y</enabled>
    </hop>
    <hop>
      <from>LOB_MAPPING</from>
      <to>LOB_LU</to>
      <enabled>Y</enabled>
    </hop>
    <hop>
      <from>SHARED_LIMIT</from>
      <to>LOOKUP_SHARED_LIMIT_B</to>
      <enabled>Y</enabled>
    </hop>
    <hop>
      <from>VDIM_UNDERWRITER </from>
      <to>UNDERWRITER_NAME</to>
      <enabled>Y</enabled>
    </hop>
    <hop>
      <from>MASTER COMPANY 2</from>
      <to>MINI_UNIQID HUL LU </to>
      <enabled>Y</enabled>
    </hop>
    <hop>
      <from>PRODUCER_NAME</from>
      <to>MASTER COMPANY 2</to>
      <enabled>Y</enabled>
    </hop>
    <hop>
      <from>MINI_UNIQID HUL LU </from>
      <to>MINI_UNIQID NON HUL LU</to>
      <enabled>Y</enabled>
    </hop>
    <hop>
      <from>MINI_UNIQID NON HUL LU</from>
      <to>MONTHLY_TRANSACTION_LU</to>
      <enabled>Y</enabled>
    </hop>
    <hop>
      <from>MONTHLY_TRANSACTION_LU</from>
      <to>COV_DESCRIPTION_LU</to>
      <enabled>Y</enabled>
    </hop>
    <hop>
      <from>COV_DESCRIPTION_LU</from>
      <to>UNDERWRITER_NAME</to>
      <enabled>Y</enabled>
    </hop>
    <hop>
      <from>UNDERWRITER_NAME</from>
      <to>INCEP DATE</to>
      <enabled>Y</enabled>
    </hop>
    <hop>
      <from>INCEP DATE</from>
      <to>LOB_LU</to>
      <enabled>Y</enabled>
    </hop>
    <hop>
      <from>LOB_LU</from>
      <to>LOOKUP_SHARED_LIMIT_B</to>
      <enabled>Y</enabled>
    </hop>
    <hop>
      <from>LOOKUP_SHARED_LIMIT_B</from>
      <to>LOOKUP_COMMISSION_AMOUNT</to>
      <enabled>Y</enabled>
    </hop>
    <hop>
      <from>LOOKUP_COMMISSION_AMOUNT</from>
      <to>DM_POLICY_PV</to>
      <enabled>Y</enabled>
    </hop>
  </order>
  <step>
    <name>CLAIMS_CONSULTANT</name>
    <type>TableInput</type>
    <description/>
    <distribute>Y</distribute>
    <custom_distribution/>
    <copies>1</copies>
    <partitioning>
      <method>none</method>
      <schema_name/>
    </partitioning>
    <connection>DRABPRD</connection>
    <sql>SELECT DP.POL_POLICYNUMBER, DLE.MMLENTY_FORMATTED_NAME AS CLAIMS_CONSULTANT
FROM   DIM_ENTITY_ROLE DER, 
       DIM_ENTITY      DE,
       DIM_LEGALENTITY DLE,
       DIM_POLICY      DP
WHERE  DER.ER_ENTITY_FK = DE.EN_ENTITY_PK
AND    DER.ER_EXTERNAL_ID = DP.POL_POLICYNUMBER
AND    DER.ER_ROLE_TYPE_CODE = 'UNDCM'
AND    DER.ER_ROLE_TYPE_CODE = DLE.LENTY_ROLE
AND    DE.EN_CLIENT_ID = DLE.LENTY_UNIQUEID</sql>
    <limit>0</limit>
    <lookup/>
    <execute_each_row>N</execute_each_row>
    <variables_active>N</variables_active>
    <lazy_conversion_active>N</lazy_conversion_active>
    <cluster_schema/>
    <remotesteps>
      <input>
      </input>
      <output>
      </output>
    </remotesteps>
    <GUI>
      <xloc>1360</xloc>
      <yloc>32</yloc>
      <draw>Y</draw>
    </GUI>
  </step>
  <step>
    <name>COMMISSION_AMOUNT</name>
    <type>TableInput</type>
    <description/>
    <distribute>Y</distribute>
    <custom_distribution/>
    <copies>1</copies>
    <partitioning>
      <method>none</method>
      <schema_name/>
    </partitioning>
    <connection>magstage_DRABPRD</connection>
    <sql>  SELECT a.month_id
        ,a.pol_uniqueid
        ,SUM (a.commission)                   AS commission_amount
        ,SUM (a.commission_begin_balance)     AS commission_begin_balance
    FROM vrpt_ar_lvl4_2016 a
GROUP BY a.month_id, a.pol_uniqueid
ORDER BY month_id, pol_uniqueid</sql>
    <limit>0</limit>
    <lookup/>
    <execute_each_row>N</execute_each_row>
    <variables_active>N</variables_active>
    <lazy_conversion_active>N</lazy_conversion_active>
    <cluster_schema/>
    <remotesteps>
      <input>
      </input>
      <output>
      </output>
    </remotesteps>
    <GUI>
      <xloc>400</xloc>
      <yloc>688</yloc>
      <draw>Y</draw>
    </GUI>
  </step>
  <step>
    <name>COVERAGE_STATUS</name>
    <type>TableInput</type>
    <description/>
    <distribute>Y</distribute>
    <custom_distribution/>
    <copies>1</copies>
    <partitioning>
      <method>none</method>
      <schema_name/>
    </partitioning>
    <connection>DRABPRD</connection>
    <sql>SELECT DISTINCT CX.COVERAGEEXTENSION_ID, CX.MMCOV_COVERAGE_STATUS
FROM DIM_COVERAGEEXTENSION CX

ORDER BY CX.COVERAGEEXTENSION_ID</sql>
    <limit>0</limit>
    <lookup/>
    <execute_each_row>N</execute_each_row>
    <variables_active>N</variables_active>
    <lazy_conversion_active>N</lazy_conversion_active>
    <cluster_schema/>
    <remotesteps>
      <input>
      </input>
      <output>
      </output>
    </remotesteps>
    <GUI>
      <xloc>1552</xloc>
      <yloc>32</yloc>
      <draw>Y</draw>
    </GUI>
  </step>
  <step>
    <name>COVERAGE_STATUS LU</name>
    <type>StreamLookup</type>
    <description/>
    <distribute>Y</distribute>
    <custom_distribution/>
    <copies>1</copies>
    <partitioning>
      <method>none</method>
      <schema_name/>
    </partitioning>
    <from>COVERAGE_STATUS</from>
    <input_sorted>N</input_sorted>
    <preserve_memory>Y</preserve_memory>
    <sorted_list>N</sorted_list>
    <integer_pair>N</integer_pair>
    <lookup>
      <key>
        <name>COV_EXT_ID</name>
        <field>COVERAGEEXTENSION_ID</field>
      </key>
      <value>
        <name>MMCOV_COVERAGE_STATUS</name>
        <rename>MMCOV_COVERAGE_STATUS</rename>
        <default/>
        <type>String</type>
      </value>
    </lookup>
    <cluster_schema/>
    <remotesteps>
      <input>
      </input>
      <output>
      </output>
    </remotesteps>
    <GUI>
      <xloc>1552</xloc>
      <yloc>144</yloc>
      <draw>Y</draw>
    </GUI>
  </step>
  <step>
    <name>COV_DESCRIPTION_LU</name>
    <type>StreamLookup</type>
    <description/>
    <distribute>N</distribute>
    <custom_distribution/>
    <copies>1</copies>
    <partitioning>
      <method>none</method>
      <schema_name/>
    </partitioning>
    <from>DIM_COVERAGE</from>
    <input_sorted>N</input_sorted>
    <preserve_memory>Y</preserve_memory>
    <sorted_list>N</sorted_list>
    <integer_pair>N</integer_pair>
    <lookup>
      <key>
        <name>COV_TYP</name>
        <field>COV_TYPE</field>
      </key>
      <value>
        <name>COV_DESCRIPTION</name>
        <rename>COV_DESCRIPTION</rename>
        <default/>
        <type>String</type>
      </value>
      <value>
        <name>LIMIT_TYPE</name>
        <rename>LIMIT_TYPE</rename>
        <default/>
        <type>String</type>
      </value>
    </lookup>
    <cluster_schema/>
    <remotesteps>
      <input>
      </input>
      <output>
      </output>
    </remotesteps>
    <GUI>
      <xloc>1312</xloc>
      <yloc>576</yloc>
      <draw>Y</draw>
    </GUI>
  </step>
  <step>
    <name>CVDRSK_ENTYP_AND_LICENSE LU</name>
    <type>StreamLookup</type>
    <description/>
    <distribute>Y</distribute>
    <custom_distribution/>
    <copies>1</copies>
    <partitioning>
      <method>none</method>
      <schema_name/>
    </partitioning>
    <from>DIM_COVEREDRISK_Entity</from>
    <input_sorted>N</input_sorted>
    <preserve_memory>Y</preserve_memory>
    <sorted_list>N</sorted_list>
    <integer_pair>N</integer_pair>
    <lookup>
      <key>
        <name>COVRSK_ID</name>
        <field>COVEREDRISK_ID</field>
      </key>
      <value>
        <name>COV_RISK_TYPE_ENTITY</name>
        <rename>COV_RISK_TYPE_ENTITY</rename>
        <default/>
        <type>String</type>
      </value>
      <value>
        <name>CLIENT_ID</name>
        <rename>CLIENT_ID</rename>
        <default/>
        <type>String</type>
      </value>
      <value>
        <name>RISK_LICENSE_NO</name>
        <rename>RISK_LICENSE_NO</rename>
        <default/>
        <type>String</type>
      </value>
      <value>
        <name>RISK_LICENSE_TYPE</name>
        <rename>RISK_LICENSE_TYPE</rename>
        <default/>
        <type>String</type>
      </value>
      <value>
        <name>RISK_LICENSE_TYPE_DESC</name>
        <rename>RISK_LICENSE_TYPE_DESC</rename>
        <default/>
        <type>String</type>
      </value>
      <value>
        <name>RISK_LICENSE_STATE</name>
        <rename>RISK_LICENSE_STATE</rename>
        <default/>
        <type>String</type>
      </value>
      <value>
        <name>RISK_LICENSED_DATE</name>
        <rename>RISK_LICENSED_DATE</rename>
        <default/>
        <type>Timestamp</type>
      </value>
      <value>
        <name>RISK_LICENSE_EXP_DATE</name>
        <rename>RISK_LICENSE_EXP_DATE</rename>
        <default/>
        <type>Timestamp</type>
      </value>
    </lookup>
    <cluster_schema/>
    <remotesteps>
      <input>
      </input>
      <output>
      </output>
    </remotesteps>
    <GUI>
      <xloc>832</xloc>
      <yloc>144</yloc>
      <draw>Y</draw>
    </GUI>
  </step>
  <step>
    <name>CVDRSK_TYP_AND_NM_LU</name>
    <type>StreamLookup</type>
    <description/>
    <distribute>Y</distribute>
    <custom_distribution/>
    <copies>1</copies>
    <partitioning>
      <method>none</method>
      <schema_name/>
    </partitioning>
    <from>DIM_COVEREDRISK</from>
    <input_sorted>N</input_sorted>
    <preserve_memory>Y</preserve_memory>
    <sorted_list>N</sorted_list>
    <integer_pair>N</integer_pair>
    <lookup>
      <key>
        <name>COVRSK_ID</name>
        <field>COVEREDRISK_ID</field>
      </key>
      <value>
        <name>CVRSK_TYPE</name>
        <rename>CVRSK_TYPE</rename>
        <default/>
        <type>String</type>
      </value>
      <value>
        <name>COVEREDRISK_NAME</name>
        <rename>COVEREDRISK_NAME</rename>
        <default/>
        <type>String</type>
      </value>
      <value>
        <name>COV_STATE</name>
        <rename>COV_STATE</rename>
        <default/>
        <type>String</type>
      </value>
      <value>
        <name>CVRSK_TYPE_CODE</name>
        <rename>CVRSK_TYPE_CODE</rename>
        <default/>
        <type>String</type>
      </value>
      <value>
        <name>COVEREDRISK_ADDRESS</name>
        <rename>COVEREDRISK_ADDRESS</rename>
        <default/>
        <type>String</type>
      </value>
      <value>
        <name>COVEREDRISK_CITY</name>
        <rename>COVEREDRISK_CITY</rename>
        <default/>
        <type>String</type>
      </value>
      <value>
        <name>COVEREDRISK_COUNTY</name>
        <rename>COVEREDRISK_COUNTY</rename>
        <default/>
        <type>String</type>
      </value>
      <value>
        <name>COVEREDRISK_ZIPCODE</name>
        <rename>COVEREDRISK_ZIPCODE</rename>
        <default/>
        <type>String</type>
      </value>
    </lookup>
    <cluster_schema/>
    <remotesteps>
      <input>
      </input>
      <output>
      </output>
    </remotesteps>
    <GUI>
      <xloc>608</xloc>
      <yloc>144</yloc>
      <draw>Y</draw>
    </GUI>
  </step>
  <step>
    <name>DATES_LU</name>
    <type>StreamLookup</type>
    <description/>
    <distribute>Y</distribute>
    <custom_distribution/>
    <copies>1</copies>
    <partitioning>
      <method>none</method>
      <schema_name/>
    </partitioning>
    <from>FACT_POLICY_DATES</from>
    <input_sorted>N</input_sorted>
    <preserve_memory>Y</preserve_memory>
    <sorted_list>N</sorted_list>
    <integer_pair>N</integer_pair>
    <lookup>
      <key>
        <name>POL_ID</name>
        <field>POLICY_ID</field>
      </key>
      <key>
        <name>POLEFFDT_ID</name>
        <field>POLICYEFFECTIVEDATE_ID</field>
      </key>
      <key>
        <name>POLEXPDT_ID</name>
        <field>POLICYEXPIRATIONDATE_ID</field>
      </key>
      <key>
        <name>MONTH_ID</name>
        <field>MONTH_ID</field>
      </key>
      <value>
        <name>MON_STARTDATE</name>
        <rename>MON_STARTDATE</rename>
        <default/>
        <type>Timestamp</type>
      </value>
      <value>
        <name>POLEXP_DATE</name>
        <rename>POLEXP_DATE</rename>
        <default/>
        <type>Timestamp</type>
      </value>
      <value>
        <name>POLEFF_DATE</name>
        <rename>POLEFF_DATE</rename>
        <default/>
        <type>Timestamp</type>
      </value>
      <value>
        <name>COMPANY_ID</name>
        <rename>COMPANY_ID</rename>
        <default/>
        <type>Integer</type>
      </value>
      <value>
        <name>PRODUCER_ID</name>
        <rename>PRODUCER_ID</rename>
        <default/>
        <type>Integer</type>
      </value>
      <value>
        <name>UNDERWRITER_ID</name>
        <rename>UNDERWRITER_ID</rename>
        <default/>
        <type>Integer</type>
      </value>
      <value>
        <name>POLICYNEWORRENEWAL</name>
        <rename>POLICYNEWORRENEWAL</rename>
        <default/>
        <type>String</type>
      </value>
      <value>
        <name>POLICY_STATUS</name>
        <rename>POLICY_STATUS</rename>
        <default/>
        <type>String</type>
      </value>
    </lookup>
    <cluster_schema/>
    <remotesteps>
      <input>
      </input>
      <output>
      </output>
    </remotesteps>
    <GUI>
      <xloc>288</xloc>
      <yloc>144</yloc>
      <draw>Y</draw>
    </GUI>
  </step>
  <step>
    <name>DIM_COVERAGE</name>
    <type>TableInput</type>
    <description/>
    <distribute>Y</distribute>
    <custom_distribution/>
    <copies>1</copies>
    <partitioning>
      <method>none</method>
      <schema_name/>
    </partitioning>
    <connection>DRABPRD</connection>
    <sql>SELECT DISTINCT COV_TYPE, COV_DESCRIPTION,
CASE 
	WHEN SUBSTR(COV_TYPE, -1,1) = 'I' THEN 'SHARED'
	WHEN SUBSTR(COV_TYPE, -1,1) = 'O' THEN 'SEPARATE'
END LIMIT_TYPE
FROM DIM_COVERAGE
ORDER BY COV_TYPE</sql>
    <limit>0</limit>
    <lookup/>
    <execute_each_row>N</execute_each_row>
    <variables_active>N</variables_active>
    <lazy_conversion_active>N</lazy_conversion_active>
    <cluster_schema/>
    <remotesteps>
      <input>
      </input>
      <output>
      </output>
    </remotesteps>
    <GUI>
      <xloc>1312</xloc>
      <yloc>704</yloc>
      <draw>Y</draw>
    </GUI>
  </step>
  <step>
    <name>DIM_COVEREDRISK</name>
    <type>TableInput</type>
    <description/>
    <distribute>Y</distribute>
    <custom_distribution/>
    <copies>1</copies>
    <partitioning>
      <method>none</method>
      <schema_name/>
    </partitioning>
    <connection>DRABPRD</connection>
    <sql>SELECT 
C.COVEREDRISK_ID, C.CVRSK_TYPE AS CVRSK_TYPE_CODE, C.CVRSK_TYPEDESCRIPTION AS CVRSK_TYPE, 
CASE 
WHEN VC.COVEREDRISK_FORMATTED_NAME IS NULL AND DE.EN_ENTITY_TYPE = 'Person' THEN DE.EN_FORMATTED_NAME 
WHEN VC.COVEREDRISK_FORMATTED_NAME IS NULL AND DE.EN_ENTITY_TYPE = 'Organization' THEN DE.EN_ORGANIZATION_NAME 
ELSE VC.COVEREDRISK_FORMATTED_NAME END AS COVEREDRISK_NAME,
VC.COVEREDRISK_ADDRESS1 ||' '|| VC.COVEREDRISK_ADDRESS2 || ' '||VC.COVEREDRISK_ADDRESS3 AS COVEREDRISK_ADDRESS,
VC.COVEREDRISK_CITY,
VC.COVEREDRISK_STATE AS COV_STATE,
VC.COVEREDRISK_COUNTY,
VC.COVEREDRISK_ZIPCODE
FROM DIM_COVEREDRISK C
LEFT JOIN VDIM_COVEREDRISKNAME VC
ON VC.COVEREDRISK_ID = C.COVEREDRISK_ID
INNER JOIN DIM_ENTITY DE
ON C.CVRSK_NUMBER = DE.EN_CLIENT_ID
ORDER BY C.COVEREDRISK_ID, C.CVRSK_TYPEDESCRIPTION, VC.COVEREDRISK_FORMATTED_NAME



</sql>
    <limit>0</limit>
    <lookup/>
    <execute_each_row>N</execute_each_row>
    <variables_active>N</variables_active>
    <lazy_conversion_active>N</lazy_conversion_active>
    <cluster_schema/>
    <remotesteps>
      <input>
      </input>
      <output>
      </output>
    </remotesteps>
    <GUI>
      <xloc>608</xloc>
      <yloc>32</yloc>
      <draw>Y</draw>
    </GUI>
  </step>
  <step>
    <name>DIM_COVEREDRISKEXT</name>
    <type>TableInput</type>
    <description/>
    <distribute>Y</distribute>
    <custom_distribution/>
    <copies>1</copies>
    <partitioning>
      <method>none</method>
      <schema_name/>
    </partitioning>
    <connection>DRABPRD</connection>
    <sql>SELECT   RX.COVEREDRISKEXTENSION_ID,
  RX.MMRSK_SPECIALTY_CODE    AS RISK_SPECIALTY_CODE,
  RX.MMRSK_SPEC_DESC              AS RISK_SPECIALTY_DESC,
  RX.MMRSK_COUNTY_CODE            AS RISK_COUNTY_CODE,
  RX.MMRSK_COUNTY_DESC            AS RISK_COUNTY_DESC,
  RX.MMRSK_CURRENT_STATUS         AS RISK_CURRENT_STATUS,
  RX.MMRSK_PRIMARY_RISK_B         AS POLICY_PRIMARY_RISK,
  RX.MMRSK_CANCEL_REASON_CODE     AS RISK_CANCEL_REASON_CODE,
  RX.MMRSK_CANCEL_REASON_DESC     AS RISK_CANCEL_REASON_DESC,
  RX.MMRSK_SLOT_ID                AS SLOT_ID,
  RX.MMRSK_NUM_OF_EMPLOYED_DOCTOR AS NUM_DOCS_ON_SLOT,
  RX.MMRSK_NUMBER_OF_BED          AS NUM_OF_BEDS,
  RX.MMRSK_PRACTICE_STATE_CODE    AS RISK_PRACTICE_STATE_CODE,
  RX.MMRSK_FTE_FULL_TIME_HRS      AS FTE_FULL_TIME_HRS,
  RX.MMRSK_FTE_PART_TIME_HRS      AS FTE_PART_TIME_HRS,
  RX.MMRSK_LEGACY_DATA_ID         AS POINT_MAG_ID,
  RX.MMRSK_CITY_CODE              AS RISK_CITY_CODE,
  RX.RSK_EFFECTIVE_FROM_DATE,
  RX.RSK_EFFECTIVE_TO_DATE

FROM DIM_COVEREDRISKEXTENSION RX
ORDER BY   RX.COVEREDRISKEXTENSION_ID</sql>
    <limit>0</limit>
    <lookup/>
    <execute_each_row>N</execute_each_row>
    <variables_active>N</variables_active>
    <lazy_conversion_active>N</lazy_conversion_active>
    <cluster_schema/>
    <remotesteps>
      <input>
      </input>
      <output>
      </output>
    </remotesteps>
    <GUI>
      <xloc>1056</xloc>
      <yloc>32</yloc>
      <draw>Y</draw>
    </GUI>
  </step>
  <step>
    <name>DIM_COVEREDRISK_Entity</name>
    <type>TableInput</type>
    <description/>
    <distribute>Y</distribute>
    <custom_distribution/>
    <copies>1</copies>
    <partitioning>
      <method>none</method>
      <schema_name/>
    </partitioning>
    <connection>DRABPRD</connection>
    <sql>SELECT DISTINCT DC.COVEREDRISK_ID,
  DE.EN_ENTITY_TYPE AS COV_RISK_TYPE_Entity,
  DE.EN_CLIENT_ID   AS CLIENT_ID,
  DL.LIC_LICENSE_NO AS RISK_LICENSE_NO,
  DL.LIC_LICENSE_TYPE_CODE AS RISK_LICENSE_TYPE,
  DL.LIC_LICENSE_TYPE_SHORT_DESC AS RISK_LICENSE_TYPE_DESC,
  DL.LIC_LICENSED_STATE_CODE AS RISK_LICENSE_STATE,
  DL.LIC_DATE_LICENSED AS RISK_LICENSED_DATE,
  CASE WHEN TO_CHAR(DL.LIC_EXPIRATION_DATE, 'MM/DD/YYYY') = '01/01/3000'
       THEN NULL 
       ELSE DL.LIC_EXPIRATION_DATE 
  END AS RISK_LICENSE_EXP_DATE

FROM DIM_COVEREDRISK DC
INNER JOIN DIM_LEGALENTITY DL
ON DC.CVRSK_NUMBER = DL.LENTY_UNIQUEID
INNER JOIN DIM_ENTITY DE
ON DE.EN_CLIENT_ID = DL.LENTY_UNIQUEID
INNER JOIN VDIM_COVEREDRISKNAME VCR
ON VCR.COVEREDRISK_ID = DC.COVEREDRISK_ID
LEFT JOIN DIM_LICENSE_PROFILE DL
ON DL.LIC_ENTITY_FK = DE.EN_ENTITY_PK
ORDER BY DC.COVEREDRISK_ID





</sql>
    <limit>0</limit>
    <lookup/>
    <execute_each_row>N</execute_each_row>
    <variables_active>N</variables_active>
    <lazy_conversion_active>N</lazy_conversion_active>
    <cluster_schema/>
    <remotesteps>
      <input>
      </input>
      <output>
      </output>
    </remotesteps>
    <GUI>
      <xloc>832</xloc>
      <yloc>32</yloc>
      <draw>Y</draw>
    </GUI>
  </step>
  <step>
    <name>DIM_ENTITY</name>
    <type>TableInput</type>
    <description/>
    <distribute>N</distribute>
    <custom_distribution/>
    <copies>1</copies>
    <partitioning>
      <method>none</method>
      <schema_name/>
    </partitioning>
    <connection>DRABPRD</connection>
    <sql>SELECT Z.EN_INSURED_SINCE_DATE AS POL_INCEP_DATE,
Q.LEGALENTITY_ID,
Q.LENTY_TYPE,
Q.VALID_TODATE AS ENTITY_EXPIRATION_DATE,
CASE WHEN  EXTRACT (YEAR FROM Q.VALID_TODATE) ='3000' THEN 'ACTIVE' 
  ELSE 'EXPIRED' END AS ENTITY_STATUS 
FROM DIM_ENTITY Z
INNER JOIN DIM_LEGALENTITY Q ON 
TO_CHAR(Z.EN_ENTITY_PK) = Q.LENTY_NUMBER</sql>
    <limit>0</limit>
    <lookup/>
    <execute_each_row>N</execute_each_row>
    <variables_active>N</variables_active>
    <lazy_conversion_active>N</lazy_conversion_active>
    <cluster_schema/>
    <remotesteps>
      <input>
      </input>
      <output>
      </output>
    </remotesteps>
    <GUI>
      <xloc>944</xloc>
      <yloc>688</yloc>
      <draw>Y</draw>
    </GUI>
  </step>
  <step>
    <name>DIM_POLICY</name>
    <type>TableInput</type>
    <description/>
    <distribute>Y</distribute>
    <custom_distribution/>
    <copies>1</copies>
    <partitioning>
      <method>none</method>
      <schema_name/>
    </partitioning>
    <connection>DRABPRD</connection>
    <sql>SELECT DISTINCT P.POLICY_ID,
  P.POL_POLICYNUMBER,
  P.POL_MASTERSTATE,
  P.POL_UNIQUEID
FROM DIM_POLICY P
ORDER BY P.POLICY_ID,
  P.POL_POLICYNUMBER,P.POL_UNIQUEID</sql>
    <limit>0</limit>
    <lookup/>
    <execute_each_row>N</execute_each_row>
    <variables_active>N</variables_active>
    <lazy_conversion_active>N</lazy_conversion_active>
    <cluster_schema/>
    <remotesteps>
      <input>
      </input>
      <output>
      </output>
    </remotesteps>
    <GUI>
      <xloc>1200</xloc>
      <yloc>32</yloc>
      <draw>Y</draw>
    </GUI>
  </step>
  <step>
    <name>DIM_POLICYEXTENSION</name>
    <type>TableInput</type>
    <description/>
    <distribute>Y</distribute>
    <custom_distribution/>
    <copies>1</copies>
    <partitioning>
      <method>none</method>
      <schema_name/>
    </partitioning>
    <connection>DRABPRD</connection>
    <sql>SELECT X.POLICYEXTENSION_ID,
  X.MMPOL_POLICY_TYPE_CODE       AS POLICY_TYPE_CODE,
  X.MMPOL_POLICY_TYPE_DESC       AS POLICY_TYPE_DESC,
  X.MMPOL_ORGANIZATION_TYPE_CODE AS ORGANIZATION_TYPE,
  X.MMPOL_RENEWAL_INDICATOR_CODE AS POLICY_RENEWAL_INDICATOR_CODE,
  X.MMPOL_RENEWAL_INDICATOR_DESC AS POLICY_RENEWAL_INDICATOR_DESC,
  X.MMPOL_POLICY_CANCEL_TYPE_CODE AS POLICY_CANCEL_TYPE_CODE,
  X.MMPOL_POLICY_CANCEL_TYPE_DESC AS POLICY_CANCEL_TYPE_DESC,
  X.MMPOL_POL_CANCEL_REASON_CODE AS POLICY_CANCEL_REASON_CODE,  
  X.MMPOL_POL_CANCEL_REASON_DESC AS POLICY_CANCEL_REASON_DESC
FROM DIM_POLICYEXTENSION X
ORDER BY X.POLICYEXTENSION_ID</sql>
    <limit>0</limit>
    <lookup/>
    <execute_each_row>N</execute_each_row>
    <variables_active>N</variables_active>
    <lazy_conversion_active>N</lazy_conversion_active>
    <cluster_schema/>
    <remotesteps>
      <input>
      </input>
      <output>
      </output>
    </remotesteps>
    <GUI>
      <xloc>2192</xloc>
      <yloc>32</yloc>
      <draw>Y</draw>
    </GUI>
  </step>
  <step>
    <name>DM_POLICY_PV</name>
    <type>TableOutput</type>
    <description/>
    <distribute>Y</distribute>
    <custom_distribution/>
    <copies>1</copies>
    <partitioning>
      <method>none</method>
      <schema_name/>
    </partitioning>
    <connection>STAGE_OLAP_PROD_DRA_17</connection>
    <schema/>
    <table>DM_POLICY_PV</table>
    <commit>1000</commit>
    <truncate>N</truncate>
    <ignore_errors>N</ignore_errors>
    <use_batch>Y</use_batch>
    <specify_fields>Y</specify_fields>
    <partitioning_enabled>N</partitioning_enabled>
    <partitioning_field/>
    <partitioning_daily>N</partitioning_daily>
    <partitioning_monthly>Y</partitioning_monthly>
    <tablename_in_field>N</tablename_in_field>
    <tablename_field/>
    <tablename_in_table>Y</tablename_in_table>
    <return_keys>N</return_keys>
    <return_field/>
    <fields>
      <field>
        <column_name>POL_ID</column_name>
        <stream_name>POL_ID</stream_name>
      </field>
      <field>
        <column_name>COVRSK_ID</column_name>
        <stream_name>COVRSK_ID</stream_name>
      </field>
      <field>
        <column_name>POLEFFDT_ID</column_name>
        <stream_name>POLEFFDT_ID</stream_name>
      </field>
      <field>
        <column_name>POLEXPDT_ID</column_name>
        <stream_name>POLEXPDT_ID</stream_name>
      </field>
      <field>
        <column_name>MONTH_ID</column_name>
        <stream_name>MONTH_ID</stream_name>
      </field>
      <field>
        <column_name>COV_TYP</column_name>
        <stream_name>COV_TYP</stream_name>
      </field>
      <field>
        <column_name>COMPONENT_TYP</column_name>
        <stream_name>COMPONENT_TYP</stream_name>
      </field>
      <field>
        <column_name>IND_EXP_BOTH</column_name>
        <stream_name>IND_EXP_BOTH</stream_name>
      </field>
      <field>
        <column_name>CGL_AGG</column_name>
        <stream_name>CGL_AGG</stream_name>
      </field>
      <field>
        <column_name>CGL_LIMIT</column_name>
        <stream_name>CGL_LIMIT</stream_name>
      </field>
      <field>
        <column_name>EXS_AGG</column_name>
        <stream_name>EXS_AGG</stream_name>
      </field>
      <field>
        <column_name>EXS_LIMIT</column_name>
        <stream_name>EXS_LIMIT</stream_name>
      </field>
      <field>
        <column_name>PRI_AGG</column_name>
        <stream_name>PRI_AGG</stream_name>
      </field>
      <field>
        <column_name>PRI_LIMIT</column_name>
        <stream_name>PRI_LIMIT</stream_name>
      </field>
      <field>
        <column_name>UMB_AGG</column_name>
        <stream_name>UMB_AGG</stream_name>
      </field>
      <field>
        <column_name>UMB_LIMIT</column_name>
        <stream_name>UMB_LIMIT</stream_name>
      </field>
      <field>
        <column_name>PL_LIMIT</column_name>
        <stream_name>PL_LIMIT</stream_name>
      </field>
      <field>
        <column_name>ADM_AGG</column_name>
        <stream_name>ADM_AGG</stream_name>
      </field>
      <field>
        <column_name>ADM_LIMIT</column_name>
        <stream_name>ADM_LIMIT</stream_name>
      </field>
      <field>
        <column_name>AUT_AGG</column_name>
        <stream_name>AUT_AGG</stream_name>
      </field>
      <field>
        <column_name>AUT_LIMIT</column_name>
        <stream_name>AUT_LIMIT</stream_name>
      </field>
      <field>
        <column_name>EBL_AGG</column_name>
        <stream_name>EBL_AGG</stream_name>
      </field>
      <field>
        <column_name>EBL_LIMIT</column_name>
        <stream_name>EBL_LIMIT</stream_name>
      </field>
      <field>
        <column_name>EVA_AGG</column_name>
        <stream_name>EVA_AGG</stream_name>
      </field>
      <field>
        <column_name>EVA_LIMIT</column_name>
        <stream_name>EVA_LIMIT</stream_name>
      </field>
      <field>
        <column_name>FIR_AGG</column_name>
        <stream_name>FIR_AGG</stream_name>
      </field>
      <field>
        <column_name>FIR_LIMIT</column_name>
        <stream_name>FIR_LIMIT</stream_name>
      </field>
      <field>
        <column_name>LOS_AGG</column_name>
        <stream_name>LOS_AGG</stream_name>
      </field>
      <field>
        <column_name>LOS_LIMIT</column_name>
        <stream_name>LOS_LIMIT</stream_name>
      </field>
      <field>
        <column_name>MED_AGG</column_name>
        <stream_name>MED_AGG</stream_name>
      </field>
      <field>
        <column_name>MED_LIMIT</column_name>
        <stream_name>MED_LIMIT</stream_name>
      </field>
      <field>
        <column_name>PLH_AGG</column_name>
        <stream_name>PLH_AGG</stream_name>
      </field>
      <field>
        <column_name>PLH_LIMIT</column_name>
        <stream_name>PLH_LIMIT</stream_name>
      </field>
      <field>
        <column_name>ADM_DED_AGG</column_name>
        <stream_name>ADM_DED_AGG</stream_name>
      </field>
      <field>
        <column_name>ADM_DED_PER_INS</column_name>
        <stream_name>ADM_DED_PER_INS</stream_name>
      </field>
      <field>
        <column_name>AUT_DED_AGG</column_name>
        <stream_name>AUT_DED_AGG</stream_name>
      </field>
      <field>
        <column_name>AUT_DED_PER_INS</column_name>
        <stream_name>AUT_DED_PER_INS</stream_name>
      </field>
      <field>
        <column_name>CGL_DED_AGG</column_name>
        <stream_name>CGL_DED_AGG</stream_name>
      </field>
      <field>
        <column_name>CGL_DED_PER_INS</column_name>
        <stream_name>CGL_DED_PER_INS</stream_name>
      </field>
      <field>
        <column_name>EBL_DED_AGG</column_name>
        <stream_name>EBL_DED_AGG</stream_name>
      </field>
      <field>
        <column_name>EBL_DED_PER_INS</column_name>
        <stream_name>EBL_DED_PER_INS</stream_name>
      </field>
      <field>
        <column_name>EVA_DED_AGG</column_name>
        <stream_name>EVA_DED_AGG</stream_name>
      </field>
      <field>
        <column_name>EVA_DED_PER_INS</column_name>
        <stream_name>EVA_DED_PER_INS</stream_name>
      </field>
      <field>
        <column_name>EXS_DED_AGG</column_name>
        <stream_name>EXS_DED_AGG</stream_name>
      </field>
      <field>
        <column_name>EXS_DED_PER_INS</column_name>
        <stream_name>EXS_DED_PER_INS</stream_name>
      </field>
      <field>
        <column_name>FIR_DED_AGG</column_name>
        <stream_name>FIR_DED_AGG</stream_name>
      </field>
      <field>
        <column_name>FIR_DED_PER_INS</column_name>
        <stream_name>FIR_DED_PER_INS</stream_name>
      </field>
      <field>
        <column_name>LOS_DED_AGG</column_name>
        <stream_name>LOS_DED_AGG</stream_name>
      </field>
      <field>
        <column_name>LOS_DED_PER_INS</column_name>
        <stream_name>LOS_DED_PER_INS</stream_name>
      </field>
      <field>
        <column_name>MED_DED_AGG</column_name>
        <stream_name>MED_DED_AGG</stream_name>
      </field>
      <field>
        <column_name>MED_DED_PER_INS</column_name>
        <stream_name>MED_DED_PER_INS</stream_name>
      </field>
      <field>
        <column_name>PLH_DED_AGG</column_name>
        <stream_name>PLH_DED_AGG</stream_name>
      </field>
      <field>
        <column_name>PLH_DED_PER_INS</column_name>
        <stream_name>PLH_DED_PER_INS</stream_name>
      </field>
      <field>
        <column_name>PRI_DED_AGG</column_name>
        <stream_name>PRI_DED_AGG</stream_name>
      </field>
      <field>
        <column_name>PRI_DED_PER_INS</column_name>
        <stream_name>PRI_DED_PER_INS</stream_name>
      </field>
      <field>
        <column_name>UMB_DED_AGG</column_name>
        <stream_name>UMB_DED_AGG</stream_name>
      </field>
      <field>
        <column_name>UMB_DED_PER_INS</column_name>
        <stream_name>UMB_DED_PER_INS</stream_name>
      </field>
      <field>
        <column_name>COV_NAME</column_name>
        <stream_name>COV_NAME</stream_name>
      </field>
      <field>
        <column_name>HLP_AGG</column_name>
        <stream_name>HLP_AGG</stream_name>
      </field>
      <field>
        <column_name>HLP_DED_AGG</column_name>
        <stream_name>HLP_DED_AGG</stream_name>
      </field>
      <field>
        <column_name>HLP_DED_PER_INS</column_name>
        <stream_name>HLP_DED_PER_INS</stream_name>
      </field>
      <field>
        <column_name>HLP_LIMIT</column_name>
        <stream_name>HLP_LIMIT</stream_name>
      </field>
      <field>
        <column_name>HPL_AGG</column_name>
        <stream_name>HPL_AGG</stream_name>
      </field>
      <field>
        <column_name>HPL_DED_AGG</column_name>
        <stream_name>HPL_DED_AGG</stream_name>
      </field>
      <field>
        <column_name>HPL_DED_PER_INS</column_name>
        <stream_name>HPL_DED_PER_INS</stream_name>
      </field>
      <field>
        <column_name>HPL_LIMIT</column_name>
        <stream_name>HPL_LIMIT</stream_name>
      </field>
      <field>
        <column_name>HRF_AGG</column_name>
        <stream_name>HRF_AGG</stream_name>
      </field>
      <field>
        <column_name>HRF_DED_AGG</column_name>
        <stream_name>HRF_DED_AGG</stream_name>
      </field>
      <field>
        <column_name>HRF_DED_PER_INS</column_name>
        <stream_name>HRF_DED_PER_INS</stream_name>
      </field>
      <field>
        <column_name>HRF_LIMIT</column_name>
        <stream_name>HRF_LIMIT</stream_name>
      </field>
      <field>
        <column_name>HUL_AGG</column_name>
        <stream_name>HUL_AGG</stream_name>
      </field>
      <field>
        <column_name>HUL_DED_AGG</column_name>
        <stream_name>HUL_DED_AGG</stream_name>
      </field>
      <field>
        <column_name>HUL_DED_PER_INS</column_name>
        <stream_name>HUL_DED_PER_INS</stream_name>
      </field>
      <field>
        <column_name>HUL_LIMIT</column_name>
        <stream_name>HUL_LIMIT</stream_name>
      </field>
      <field>
        <column_name>PSL_AGG</column_name>
        <stream_name>PSL_AGG</stream_name>
      </field>
      <field>
        <column_name>PSL_DED_AGG</column_name>
        <stream_name>PSL_DED_AGG</stream_name>
      </field>
      <field>
        <column_name>PSL_DED_PER_INS</column_name>
        <stream_name>PSL_DED_PER_INS</stream_name>
      </field>
      <field>
        <column_name>PSL_LIMIT</column_name>
        <stream_name>PSL_LIMIT</stream_name>
      </field>
      <field>
        <column_name>COVG_ID</column_name>
        <stream_name>COVG_ID</stream_name>
      </field>
      <field>
        <column_name>COMP_ID</column_name>
        <stream_name>COMP_ID</stream_name>
      </field>
      <field>
        <column_name>NON_AGG</column_name>
        <stream_name>NON_AGG</stream_name>
      </field>
      <field>
        <column_name>NON_DED_AGG</column_name>
        <stream_name>NON_DED_AGG</stream_name>
      </field>
      <field>
        <column_name>NON_DED_PER_INS</column_name>
        <stream_name>NON_DED_PER_INS</stream_name>
      </field>
      <field>
        <column_name>NON_LIMIT</column_name>
        <stream_name>NON_LIMIT</stream_name>
      </field>
      <field>
        <column_name>FI_ID</column_name>
        <stream_name>FI_ID</stream_name>
      </field>
      <field>
        <column_name>VAS_AGG</column_name>
        <stream_name>VAS_AGG</stream_name>
      </field>
      <field>
        <column_name>VAS_DED_AGG</column_name>
        <stream_name>VAS_DED_AGG</stream_name>
      </field>
      <field>
        <column_name>VAS_DED_PER_INS</column_name>
        <stream_name>VAS_DED_PER_INS</stream_name>
      </field>
      <field>
        <column_name>VAS_LIMIT</column_name>
        <stream_name>VAS_LIMIT</stream_name>
      </field>
      <field>
        <column_name>COV_EXT_ID</column_name>
        <stream_name>COV_EXT_ID</stream_name>
      </field>
      <field>
        <column_name>COV_CLAS_EXT_ID</column_name>
        <stream_name>COV_CLAS_EXT_ID</stream_name>
      </field>
      <field>
        <column_name>COVEFFDT_ID</column_name>
        <stream_name>COVEFFDT_ID</stream_name>
      </field>
      <field>
        <column_name>COVEXPDT_ID</column_name>
        <stream_name>COVEXPDT_ID</stream_name>
      </field>
      <field>
        <column_name>COVRSKEXTN_ID</column_name>
        <stream_name>COVRSKEXTN_ID</stream_name>
      </field>
      <field>
        <column_name>POLEXTN_ID</column_name>
        <stream_name>POLEXTN_ID</stream_name>
      </field>
      <field>
        <column_name>MON_STARTDATE</column_name>
        <stream_name>MON_STARTDATE</stream_name>
      </field>
      <field>
        <column_name>POLEXP_DATE</column_name>
        <stream_name>POLEXP_DATE</stream_name>
      </field>
      <field>
        <column_name>POLEFF_DATE</column_name>
        <stream_name>POLEFF_DATE</stream_name>
      </field>
      <field>
        <column_name>COMPANY_ID</column_name>
        <stream_name>COMPANY_ID</stream_name>
      </field>
      <field>
        <column_name>PRODUCER_ID</column_name>
        <stream_name>PRODUCER_ID</stream_name>
      </field>
      <field>
        <column_name>UNDERWRITER_ID</column_name>
        <stream_name>UNDERWRITER_ID</stream_name>
      </field>
      <field>
        <column_name>POLICYNEWORRENEWAL</column_name>
        <stream_name>POLICYNEWORRENEWAL</stream_name>
      </field>
      <field>
        <column_name>POLICY_STATUS</column_name>
        <stream_name>POLICY_STATUS</stream_name>
      </field>
      <field>
        <column_name>FIRST_INSURED</column_name>
        <stream_name>FIRST_INSURED</stream_name>
      </field>
      <field>
        <column_name>FIRSTINSURED_ID</column_name>
        <stream_name>FIRSTINSURED_ID</stream_name>
      </field>
      <field>
        <column_name>FIRST_INSURED_V_LONG_NM</column_name>
        <stream_name>FIRST_INSURED_V_LONG_NM</stream_name>
      </field>
      <field>
        <column_name>CVRSK_TYPE</column_name>
        <stream_name>CVRSK_TYPE</stream_name>
      </field>
      <field>
        <column_name>COVEREDRISK_NAME</column_name>
        <stream_name>COVEREDRISK_NAME</stream_name>
      </field>
      <field>
        <column_name>COV_STATE</column_name>
        <stream_name>COV_STATE</stream_name>
      </field>
      <field>
        <column_name>CVRSK_TYPE_CODE</column_name>
        <stream_name>CVRSK_TYPE_CODE</stream_name>
      </field>
      <field>
        <column_name>COVEREDRISK_ADDRESS</column_name>
        <stream_name>COVEREDRISK_ADDRESS</stream_name>
      </field>
      <field>
        <column_name>COVEREDRISK_CITY</column_name>
        <stream_name>COVEREDRISK_CITY</stream_name>
      </field>
      <field>
        <column_name>COVEREDRISK_COUNTY</column_name>
        <stream_name>COVEREDRISK_COUNTY</stream_name>
      </field>
      <field>
        <column_name>COVEREDRISK_ZIPCODE</column_name>
        <stream_name>COVEREDRISK_ZIPCODE</stream_name>
      </field>
      <field>
        <column_name>COV_RISK_TYPE_ENTITY</column_name>
        <stream_name>COV_RISK_TYPE_ENTITY</stream_name>
      </field>
      <field>
        <column_name>CLIENT_ID</column_name>
        <stream_name>CLIENT_ID</stream_name>
      </field>
      <field>
        <column_name>RISK_LICENSE_NO</column_name>
        <stream_name>RISK_LICENSE_NO</stream_name>
      </field>
      <field>
        <column_name>RISK_LICENSE_TYPE</column_name>
        <stream_name>RISK_LICENSE_TYPE</stream_name>
      </field>
      <field>
        <column_name>RISK_LICENSE_TYPE_DESC</column_name>
        <stream_name>RISK_LICENSE_TYPE_DESC</stream_name>
      </field>
      <field>
        <column_name>RISK_LICENSE_STATE</column_name>
        <stream_name>RISK_LICENSE_STATE</stream_name>
      </field>
      <field>
        <column_name>RISK_LICENSED_DATE</column_name>
        <stream_name>RISK_LICENSED_DATE</stream_name>
      </field>
      <field>
        <column_name>RISK_LICENSE_EXP_DATE</column_name>
        <stream_name>RISK_LICENSE_EXP_DATE</stream_name>
      </field>
      <field>
        <column_name>RISK_SPECIALTY_CODE</column_name>
        <stream_name>RISK_SPECIALTY_CODE</stream_name>
      </field>
      <field>
        <column_name>RISK_SPECIALTY_DESC</column_name>
        <stream_name>RISK_SPECIALTY_DESC</stream_name>
      </field>
      <field>
        <column_name>RISK_COUNTY_CODE</column_name>
        <stream_name>RISK_COUNTY_CODE</stream_name>
      </field>
      <field>
        <column_name>RISK_COUNTY_DESC</column_name>
        <stream_name>RISK_COUNTY_DESC</stream_name>
      </field>
      <field>
        <column_name>RISK_CURRENT_STATUS</column_name>
        <stream_name>RISK_CURRENT_STATUS</stream_name>
      </field>
      <field>
        <column_name>POLICY_PRIMARY_RISK</column_name>
        <stream_name>POLICY_PRIMARY_RISK</stream_name>
      </field>
      <field>
        <column_name>RISK_CANCEL_REASON_CODE</column_name>
        <stream_name>RISK_CANCEL_REASON_CODE</stream_name>
      </field>
      <field>
        <column_name>RISK_CANCEL_REASON_DESC</column_name>
        <stream_name>RISK_CANCEL_REASON_DESC</stream_name>
      </field>
      <field>
        <column_name>SLOT_ID</column_name>
        <stream_name>SLOT_ID</stream_name>
      </field>
      <field>
        <column_name>NUM_DOCS_ON_SLOT</column_name>
        <stream_name>NUM_DOCS_ON_SLOT</stream_name>
      </field>
      <field>
        <column_name>NUM_OF_BEDS</column_name>
        <stream_name>NUM_OF_BEDS</stream_name>
      </field>
      <field>
        <column_name>RISK_PRACTICE_STATE_CODE</column_name>
        <stream_name>RISK_PRACTICE_STATE_CODE</stream_name>
      </field>
      <field>
        <column_name>FTE_FULL_TIME_HRS</column_name>
        <stream_name>FTE_FULL_TIME_HRS</stream_name>
      </field>
      <field>
        <column_name>FTE_PART_TIME_HRS</column_name>
        <stream_name>FTE_PART_TIME_HRS</stream_name>
      </field>
      <field>
        <column_name>POINT_MAG_ID</column_name>
        <stream_name>POINT_MAG_ID</stream_name>
      </field>
      <field>
        <column_name>RISK_CITY_CODE</column_name>
        <stream_name>RISK_CITY_CODE</stream_name>
      </field>
      <field>
        <column_name>RSK_EFFECTIVE_FROM_DATE</column_name>
        <stream_name>RSK_EFFECTIVE_FROM_DATE</stream_name>
      </field>
      <field>
        <column_name>RSK_EFFECTIVE_TO_DATE</column_name>
        <stream_name>RSK_EFFECTIVE_TO_DATE</stream_name>
      </field>
      <field>
        <column_name>POL_POLICYNUMBER</column_name>
        <stream_name>POL_POLICYNUMBER</stream_name>
      </field>
      <field>
        <column_name>POL_MASTERSTATE</column_name>
        <stream_name>POL_MASTERSTATE</stream_name>
      </field>
      <field>
        <column_name>POL_UNIQUEID</column_name>
        <stream_name>POL_UNIQUEID</stream_name>
      </field>
      <field>
        <column_name>CLAIMS_CONSULTANT</column_name>
        <stream_name>CLAIMS_CONSULTANT</stream_name>
      </field>
      <field>
        <column_name>MMCOV_COVERAGE_STATUS</column_name>
        <stream_name>MMCOV_COVERAGE_STATUS</stream_name>
      </field>
      <field>
        <column_name>WRTN_PREM_AMT</column_name>
        <stream_name>WRTN_PREM_AMT</stream_name>
      </field>
      <field>
        <column_name>EARNED_PREM_AMT</column_name>
        <stream_name>EARNED_PREM_AMT</stream_name>
      </field>
      <field>
        <column_name>UNEARNED_PREM</column_name>
        <stream_name>UNEARNED_PREM</stream_name>
      </field>
      <field>
        <column_name>WRTN_PREM_AMT_YTD</column_name>
        <stream_name>WRTN_PREM_AMT_YTD</stream_name>
      </field>
      <field>
        <column_name>EARNED_PREM_AMT_YTD</column_name>
        <stream_name>EARNED_PREM_AMT_YTD</stream_name>
      </field>
      <field>
        <column_name>WRTN_PREM_AMT_ITD</column_name>
        <stream_name>WRTN_PREM_AMT_ITD</stream_name>
      </field>
      <field>
        <column_name>EARNED_PREM_AMT_ITD</column_name>
        <stream_name>EARNED_PREM_AMT_ITD</stream_name>
      </field>
      <field>
        <column_name>BASE_TERR_CODE</column_name>
        <stream_name>BASE_TERR_CODE</stream_name>
      </field>
      <field>
        <column_name>BASE_TERR_NAME</column_name>
        <stream_name>BASE_TERR_NAME</stream_name>
      </field>
      <field>
        <column_name>POLICY_TYPE_CODE</column_name>
        <stream_name>POLICY_TYPE_CODE</stream_name>
      </field>
      <field>
        <column_name>POLICY_TYPE_DESC</column_name>
        <stream_name>POLICY_TYPE_DESC</stream_name>
      </field>
      <field>
        <column_name>ORGANIZATION_TYPE</column_name>
        <stream_name>ORGANIZATION_TYPE</stream_name>
      </field>
      <field>
        <column_name>POLICY_RENEWAL_INDICATOR_CODE</column_name>
        <stream_name>POLICY_RENEWAL_INDICATOR_CODE</stream_name>
      </field>
      <field>
        <column_name>POLICY_RENEWAL_INDICATOR_DESC</column_name>
        <stream_name>POLICY_RENEWAL_INDICATOR_DESC</stream_name>
      </field>
      <field>
        <column_name>POLICY_CANCEL_TYPE_CODE</column_name>
        <stream_name>POLICY_CANCEL_TYPE_CODE</stream_name>
      </field>
      <field>
        <column_name>POLICY_CANCEL_TYPE_DESC</column_name>
        <stream_name>POLICY_CANCEL_TYPE_DESC</stream_name>
      </field>
      <field>
        <column_name>POLICY_CANCEL_REASON_CODE</column_name>
        <stream_name>POLICY_CANCEL_REASON_CODE</stream_name>
      </field>
      <field>
        <column_name>POLICY_CANCEL_REASON_DESC</column_name>
        <stream_name>POLICY_CANCEL_REASON_DESC</stream_name>
      </field>
      <field>
        <column_name>ILF_TERRITORY</column_name>
        <stream_name>ILF_TERRITORY</stream_name>
      </field>
      <field>
        <column_name>PRODUCER_NAME</column_name>
        <stream_name>PRODUCER_NAME</stream_name>
      </field>
      <field>
        <column_name>AGENCY_TYPE</column_name>
        <stream_name>AGENCY_TYPE</stream_name>
      </field>
      <field>
        <column_name>COMPANY</column_name>
        <stream_name>COMPANY</stream_name>
      </field>
      <field>
        <column_name>COMP_NUMBER</column_name>
        <stream_name>COMP_NUMBER</stream_name>
      </field>
      <field>
        <column_name>MINI_POL_UMB_XREF_UNQID</column_name>
        <stream_name>MINI_POL_UMB_XREF_UNQID</stream_name>
      </field>
      <field>
        <column_name>MINI_POL_XREF_UNQID</column_name>
        <stream_name>MINI_POL_XREF_UNQID</stream_name>
      </field>
      <field>
        <column_name>TRANS_NAME</column_name>
        <stream_name>TRANS_NAME</stream_name>
      </field>
      <field>
        <column_name>ACCT_DATE</column_name>
        <stream_name>ACCT_DATE</stream_name>
      </field>
      <field>
        <column_name>TRANS_EFF_DATE</column_name>
        <stream_name>TRANS_EFF_DATE</stream_name>
      </field>
      <field>
        <column_name>TRANS_CODE</column_name>
        <stream_name>TRANS_CODE</stream_name>
      </field>
      <field>
        <column_name>TRAN_AMOUNT</column_name>
        <stream_name>TRAN_AMOUNT</stream_name>
      </field>
      <field>
        <column_name>TRANS_DATE</column_name>
        <stream_name>TRANS_DATE</stream_name>
      </field>
      <field>
        <column_name>TRANS_DESC</column_name>
        <stream_name>TRANS_DESC</stream_name>
      </field>
      <field>
        <column_name>COV_DESCRIPTION</column_name>
        <stream_name>COV_DESCRIPTION</stream_name>
      </field>
      <field>
        <column_name>LIMIT_TYPE</column_name>
        <stream_name>LIMIT_TYPE</stream_name>
      </field>
      <field>
        <column_name>UNDERWRITER_NAME</column_name>
        <stream_name>UNDERWRITER_NAME</stream_name>
      </field>
      <field>
        <column_name>POL_INCEP_DATE</column_name>
        <stream_name>POL_INCEP_DATE</stream_name>
      </field>
      <field>
        <column_name>LENTY_TYPE</column_name>
        <stream_name>LENTY_TYPE</stream_name>
      </field>
      <field>
        <column_name>ENTITY_EXPIRATION_DATE</column_name>
        <stream_name>ENTITY_EXPIRATION_DATE</stream_name>
      </field>
      <field>
        <column_name>ENTITY_STATUS</column_name>
        <stream_name>ENTITY_STATUS</stream_name>
      </field>
      <field>
        <column_name>LOB_CODE</column_name>
        <stream_name>LOB_CODE</stream_name>
      </field>
      <field>
        <column_name>LOSSRUN_MAP_CODE</column_name>
        <stream_name>LOSSRUN_MAP_CODE</stream_name>
      </field>
      <field>
        <column_name>CLAIM_MAP_CODE</column_name>
        <stream_name>CLAIM_MAP_CODE</stream_name>
      </field>
      <field>
        <column_name>MMCOV_SHARED_LIMIT_B</column_name>
        <stream_name>MMCOV_SHARED_LIMIT_B</stream_name>
      </field>
      <field>
        <column_name>SHARE_GROUP_DESC</column_name>
        <stream_name>SHARE_GROUP_DESC</stream_name>
      </field>
      <field>
        <column_name>COV_LIMIT_OWNER</column_name>
        <stream_name>COV_LIMIT_OWNER</stream_name>
      </field>
      <field>
        <column_name>COMMISSION_AMOUNT</column_name>
        <stream_name>COMMISSION_AMOUNT</stream_name>
      </field>
    </fields>
    <cluster_schema/>
    <remotesteps>
      <input>
      </input>
      <output>
      </output>
    </remotesteps>
    <GUI>
      <xloc>176</xloc>
      <yloc>576</yloc>
      <draw>Y</draw>
    </GUI>
  </step>
  <step>
    <name>FACT_POLICYCOVERAGE_FOR_PREMIUM_AND_POL_STATUS</name>
    <type>TableInput</type>
    <description/>
    <distribute>Y</distribute>
    <custom_distribution/>
    <copies>1</copies>
    <partitioning>
      <method>none</method>
      <schema_name/>
    </partitioning>
    <connection>DRABPRD</connection>
    <sql>SELECT DISTINCT
  FPCOV.MONTH_ID,
  FPCOV.POLICY_ID,
  FPCOV.POLICYEFFECTIVEDATE_ID,
  FPCOV.POLICYEXPIRATIONDATE_ID,
  FPCOV.FIRSTINSURED_ID,
  FPCOV.COVEREDRISK_ID,
  FPCOV.POLICYEXTENSION_ID,
  FPCOV.COVERAGE_ID,
  FPCOV.COMPONENT_ID,
  DS.STAT_STATUS AS POLICY_STATUS,
  DC.COV_TYPE,
  CX.MMCOV_COVERAGE_STATUS,
  DT.TERR_CODE AS BASE_TERR_CODE,
  DT.TERR_NAME AS BASE_TERR_NAME,FPCOV.COVERAGEEXTENSION_ID,
  SUM(FPCOV.WRTN_PREM_AMT)       AS WRTN_PREM_AMT,
  SUM(FPCOV.EARNED_PREM_AMT)     AS EARNED_PREM_AMT,
  SUM(FPCOV.UNEARNED_PREM)       AS UNEARNED_PREM,
  SUM(FPCOV.WRTN_PREM_AMT_YTD)   AS WRTN_PREM_AMT_YTD,
  SUM(FPCOV.EARNED_PREM_AMT_YTD) AS EARNED_PREM_AMT_YTD,
  SUM(FPCOV.WRTN_PREM_AMT_ITD)   AS WRTN_PREM_AMT_ITD,
  SUM(FPCOV.EARNED_PREM_AMT_ITD) AS EARNED_PREM_AMT_ITD
  

FROM FACT_POLICYSNAPSHOT FPCOV
INNER JOIN DIM_COVERAGE DC
ON FPCOV.COVERAGE_ID = DC.COVERAGE_ID
LEFT JOIN DIM_STATUS DS
ON FPCOV.POLICYSTATUS_ID = DS.STATUS_ID
INNER JOIN DIM_COVERAGEEXTENSION CX
ON FPCOV.COVERAGEEXTENSION_ID = CX.COVERAGEEXTENSION_ID
AND CX.MMCOV_COVERAGE_STATUS NOT IN ( 'OFFER','DECLINE')
INNER JOIN DIM_COMPONENT
ON FPCOV.COMPONENT_ID = DIM_COMPONENT.COMPONENT_ID
INNER JOIN DIM_TERRITORY DT
ON FPCOV.TERRITORY_ID = DT.TERRITORY_ID
GROUP BY FPCOV.MONTH_ID,
  FPCOV.POLICY_ID,
  FPCOV.POLICYEFFECTIVEDATE_ID,
  FPCOV.POLICYEXPIRATIONDATE_ID,
  FPCOV.FIRSTINSURED_ID,
  FPCOV.COVEREDRISK_ID,
  FPCOV.POLICYEXTENSION_ID,
  FPCOV.COVERAGE_ID,
  FPCOV.COMPONENT_ID,
  DS.STAT_STATUS,
  DC.COV_TYPE,
  FPCOV.COVERAGEEXTENSION_ID,
  CX.MMCOV_COVERAGE_STATUS,
  DT.TERR_CODE,
  DT.TERR_NAME
ORDER BY FPCOV.MONTH_ID,
  FPCOV.POLICY_ID,
  FPCOV.POLICYEFFECTIVEDATE_ID,
  FPCOV.POLICYEXPIRATIONDATE_ID,
  FPCOV.COVEREDRISK_ID,
  FPCOV.POLICYEXTENSION_ID,
  FPCOV.COMPONENT_ID,
  FPCOV.COVERAGE_ID,
  DC.COV_TYPE</sql>
    <limit>0</limit>
    <lookup/>
    <execute_each_row>N</execute_each_row>
    <variables_active>N</variables_active>
    <lazy_conversion_active>N</lazy_conversion_active>
    <cluster_schema/>
    <remotesteps>
      <input>
      </input>
      <output>
      </output>
    </remotesteps>
    <GUI>
      <xloc>1840</xloc>
      <yloc>32</yloc>
      <draw>Y</draw>
    </GUI>
  </step>
  <step>
    <name>FACT_POLICYTRANSACTION</name>
    <type>TableInput</type>
    <description/>
    <distribute>Y</distribute>
    <custom_distribution/>
    <copies>1</copies>
    <partitioning>
      <method>none</method>
      <schema_name/>
    </partitioning>
    <connection>DRABPRD</connection>
    <sql>SELECT DISTINCT FP.POLICY_ID,
  FP.POLICYEFFECTIVEDATE_ID,
  FP.POLICYEXPIRATIONDATE_ID,
  FP.COVEREDRISK_ID,
  FP.COVERAGE_ID,
  DT.TRANS_NAME,
  DT.TRANS_CODE,
  FP.EFFECTIVEDATE_ID AS TRANS_EFF_DATE,
  FP.AMOUNT           AS TRAN_AMOUNT,
  FP.FINANCIALACCOUNTINGDATE_ID AS ACCT_DATE,
  FP.TRANSACTIONDATE_ID AS TRANS_DATE,
  SUBSTR(FP.FINANCIALACCOUNTINGDATE_ID, 1, 6)  || '01' AS JOIN_MONTH_ID,
  DP.MMPT_COMMENTS AS TRANS_DESC
FROM FACT_POLICYTRANSACTION FP
INNER JOIN DIM_TRANSACTIONTYPE DT
ON DT.TRANSACTIONTYPE_ID = FP.TRANSACTIONTYPE_ID
INNER JOIN DIM_POLICYTRANSACTIONEXTENSION DP
ON FP.POLICYTRANSACTIONEXTENSION_ID = DP.POLICYTRANSACTIONEXTENSION_ID
WHERE FP.EARNFROMDATE_ID = '30000101'
AND DT.TRANS_CATEGORY    = 'policy'
ORDER BY FP.POLICY_ID,
  FP.POLICYEFFECTIVEDATE_ID,
  FP.POLICYEXPIRATIONDATE_ID,
  FP.FINANCIALACCOUNTINGDATE_ID,
  FP.COVERAGE_ID,
  DT.TRANS_NAME,
  TRANS_EFF_DATE</sql>
    <limit>0</limit>
    <lookup/>
    <execute_each_row>N</execute_each_row>
    <variables_active>Y</variables_active>
    <lazy_conversion_active>N</lazy_conversion_active>
    <cluster_schema/>
    <remotesteps>
      <input>
      </input>
      <output>
      </output>
    </remotesteps>
    <GUI>
      <xloc>1552</xloc>
      <yloc>704</yloc>
      <draw>Y</draw>
    </GUI>
  </step>
  <step>
    <name>FACT_POLICY_DATES</name>
    <type>TableInput</type>
    <description/>
    <distribute>Y</distribute>
    <custom_distribution/>
    <copies>1</copies>
    <partitioning>
      <method>none</method>
      <schema_name/>
    </partitioning>
    <connection>DRABPRD</connection>
    <sql>SELECT 
  FPCOV.POLICY_ID,
  FPCOV.MONTH_ID,
  FPCOV.POLICYEFFECTIVEDATE_ID,
  FPCOV.POLICYEXPIRATIONDATE_ID,
  VDM.MON_STARTDATE,
  VDPX.POLEXP_DATE,
  VDPE.POLEFF_DATE,
DS.STAT_STATUS AS POLICY_STATUS,
FPCOV.COMPANY_ID,
FPCOV.PRODUCER_ID,
FPCOV.UNDERWRITER_ID,
FPCOV.POLICYNEWORRENEWAL
FROM VDIM_POLICYEFFECTIVEDATE VDPE
INNER JOIN FACT_POLICYSNAPSHOT FPCOV
ON VDPE.POLICYEFFECTIVEDATE_ID = FPCOV.POLICYEFFECTIVEDATE_ID
INNER JOIN VDIM_POLICYEXPIRATIONDATE VDPX
ON VDPX.POLICYEXPIRATIONDATE_ID = FPCOV.POLICYEXPIRATIONDATE_ID
INNER JOIN VDIM_MONTH VDM
ON FPCOV.MONTH_ID = VDM.MONTH_ID
LEFT JOIN DIM_STATUS DS
ON FPCOV.POLICYSTATUS_ID = DS.STATUS_ID</sql>
    <limit>0</limit>
    <lookup/>
    <execute_each_row>N</execute_each_row>
    <variables_active>N</variables_active>
    <lazy_conversion_active>N</lazy_conversion_active>
    <cluster_schema/>
    <remotesteps>
      <input>
      </input>
      <output>
      </output>
    </remotesteps>
    <GUI>
      <xloc>288</xloc>
      <yloc>32</yloc>
      <draw>Y</draw>
    </GUI>
  </step>
  <step>
    <name>FP_LEGALENTITY_COMPANY</name>
    <type>TableInput</type>
    <description/>
    <distribute>Y</distribute>
    <custom_distribution/>
    <copies>1</copies>
    <partitioning>
      <method>none</method>
      <schema_name/>
    </partitioning>
    <connection>DRABPRD</connection>
    <sql>SELECT  DISTINCT
FP.MONTH_ID,
FP.POLICY_ID,
FP.POLICYEFFECTIVEDATE_ID,
FP.POLICYEXPIRATIONDATE_ID,
FP.COMPANY_ID,
NVl(cle.MMLEnty_Formatted_Name,
          vd.Comp_Name1 || ' ' || vd.Comp_Name2)        AS Company,
VD.COMP_NUMBER

FROM FACT_POLICYSNAPSHOT FP, 
VDim_Company vd,
 Dim_LegalEntity cle
WHERE 1=1 AND 
fp.Company_ID               = vd.Company_ID AND 
fp.Company_ID               = cle.LegalEntity_ID
ORDER BY 
FP.MONTH_ID,
FP.POLICY_ID,
FP.POLICYEFFECTIVEDATE_ID,
FP.POLICYEXPIRATIONDATE_ID,
FP.COMPANY_ID</sql>
    <limit>0</limit>
    <lookup/>
    <execute_each_row>N</execute_each_row>
    <variables_active>N</variables_active>
    <lazy_conversion_active>N</lazy_conversion_active>
    <cluster_schema/>
    <remotesteps>
      <input>
      </input>
      <output>
      </output>
    </remotesteps>
    <GUI>
      <xloc>2384</xloc>
      <yloc>576</yloc>
      <draw>Y</draw>
    </GUI>
  </step>
  <step>
    <name>ILF_TERRITORY</name>
    <type>TableInput</type>
    <description/>
    <distribute>Y</distribute>
    <custom_distribution/>
    <copies>1</copies>
    <partitioning>
      <method>none</method>
      <schema_name/>
    </partitioning>
    <connection>magstage_DRABPRD</connection>
    <sql>  SELECT DISTINCT
         b.state_code
        ,b.territory_code
        ,b.county_code
        ,b.county_name
        ,ROUND (
             TO_NUMBER (
                 CASE
                     WHEN i.ilf_territory IS NULL THEN r.ilf_territory
                     ELSE i.ilf_territory
                 END),0)
             AS ilf_territory
    FROM vw_base_rating_territory b
         LEFT OUTER JOIN (SELECT DISTINCT state
                                         ,county
                                         ,baserate_territory
                                         ,ilf_territory
                            FROM stg_ilf_hpl_territories
                           WHERE county &lt;&gt; 'R.O.S.') i
             ON     b.state_code = i.state
                AND b.county_name LIKE ('%' || i.county || '%')
         LEFT OUTER JOIN (SELECT DISTINCT state
                                         ,county
                                         ,baserate_territory
                                         ,ilf_territory
                            FROM stg_ilf_hpl_territories
                           WHERE county = 'R.O.S.') r
             ON b.state_code = r.state
ORDER BY b.state_code
        ,b.territory_code
        ,b.county_code
        ,b.county_name</sql>
    <limit>0</limit>
    <lookup/>
    <execute_each_row>N</execute_each_row>
    <variables_active>N</variables_active>
    <lazy_conversion_active>N</lazy_conversion_active>
    <cluster_schema/>
    <remotesteps>
      <input>
      </input>
      <output>
      </output>
    </remotesteps>
    <GUI>
      <xloc>2352</xloc>
      <yloc>288</yloc>
      <draw>Y</draw>
    </GUI>
  </step>
  <step>
    <name>ILF_TERRITORY_LOOKUP</name>
    <type>StreamLookup</type>
    <description/>
    <distribute>Y</distribute>
    <custom_distribution/>
    <copies>1</copies>
    <partitioning>
      <method>none</method>
      <schema_name/>
    </partitioning>
    <from>ILF_TERRITORY</from>
    <input_sorted>N</input_sorted>
    <preserve_memory>Y</preserve_memory>
    <sorted_list>N</sorted_list>
    <integer_pair>N</integer_pair>
    <lookup>
      <key>
        <name>RISK_PRACTICE_STATE_CODE</name>
        <field>STATE_CODE</field>
      </key>
      <key>
        <name>RISK_COUNTY_CODE</name>
        <field>COUNTY_CODE</field>
      </key>
      <key>
        <name>BASE_TERR_CODE</name>
        <field>TERRITORY_CODE</field>
      </key>
      <value>
        <name>ILF_TERRITORY</name>
        <rename>ILF_TERRITORY</rename>
        <default/>
        <type>Integer</type>
      </value>
    </lookup>
    <cluster_schema/>
    <remotesteps>
      <input>
      </input>
      <output>
      </output>
    </remotesteps>
    <GUI>
      <xloc>2192</xloc>
      <yloc>288</yloc>
      <draw>Y</draw>
    </GUI>
  </step>
  <step>
    <name>INCEP DATE</name>
    <type>StreamLookup</type>
    <description/>
    <distribute>Y</distribute>
    <custom_distribution/>
    <copies>1</copies>
    <partitioning>
      <method>none</method>
      <schema_name/>
    </partitioning>
    <from>DIM_ENTITY</from>
    <input_sorted>N</input_sorted>
    <preserve_memory>Y</preserve_memory>
    <sorted_list>N</sorted_list>
    <integer_pair>N</integer_pair>
    <lookup>
      <key>
        <name>FIRSTINSURED_ID</name>
        <field>LEGALENTITY_ID</field>
      </key>
      <value>
        <name>POL_INCEP_DATE</name>
        <rename>POL_INCEP_DATE</rename>
        <default/>
        <type>Date</type>
      </value>
      <value>
        <name>LENTY_TYPE</name>
        <rename>LENTY_TYPE</rename>
        <default/>
        <type>String</type>
      </value>
      <value>
        <name>ENTITY_EXPIRATION_DATE</name>
        <rename>ENTITY_EXPIRATION_DATE</rename>
        <default/>
        <type>Date</type>
      </value>
      <value>
        <name>ENTITY_STATUS</name>
        <rename>ENTITY_STATUS</rename>
        <default/>
        <type>String</type>
      </value>
    </lookup>
    <cluster_schema/>
    <remotesteps>
      <input>
      </input>
      <output>
      </output>
    </remotesteps>
    <GUI>
      <xloc>944</xloc>
      <yloc>576</yloc>
      <draw>Y</draw>
    </GUI>
  </step>
  <step>
    <name>INSURED_LU</name>
    <type>StreamLookup</type>
    <description/>
    <distribute>Y</distribute>
    <custom_distribution/>
    <copies>1</copies>
    <partitioning>
      <method>none</method>
      <schema_name/>
    </partitioning>
    <from>VDIM_FIRSTINSURED</from>
    <input_sorted>N</input_sorted>
    <preserve_memory>Y</preserve_memory>
    <sorted_list>N</sorted_list>
    <integer_pair>N</integer_pair>
    <lookup>
      <key>
        <name>FI_ID</name>
        <field>FIRSTINSURED_ID</field>
      </key>
      <value>
        <name>FIRST_INSURED</name>
        <rename>FIRST_INSURED</rename>
        <default/>
        <type>String</type>
      </value>
      <value>
        <name>FIRSTINSURED_ID</name>
        <rename>FIRSTINSURED_ID</rename>
        <default/>
        <type>Integer</type>
      </value>
      <value>
        <name>FIRST_INSURED_V_LONG_NM</name>
        <rename>FIRST_INSURED_V_LONG_NM</rename>
        <default/>
        <type>String</type>
      </value>
    </lookup>
    <cluster_schema/>
    <remotesteps>
      <input>
      </input>
      <output>
      </output>
    </remotesteps>
    <GUI>
      <xloc>448</xloc>
      <yloc>144</yloc>
      <draw>Y</draw>
    </GUI>
  </step>
  <step>
    <name>LOB_LU</name>
    <type>StreamLookup</type>
    <description/>
    <distribute>Y</distribute>
    <custom_distribution/>
    <copies>1</copies>
    <partitioning>
      <method>none</method>
      <schema_name/>
    </partitioning>
    <from>LOB_MAPPING</from>
    <input_sorted>N</input_sorted>
    <preserve_memory>Y</preserve_memory>
    <sorted_list>N</sorted_list>
    <integer_pair>N</integer_pair>
    <lookup>
      <key>
        <name>COV_TYP</name>
        <field>COVERAGE_CODE</field>
      </key>
      <value>
        <name>LOB_CODE</name>
        <rename>LOB_CODE</rename>
        <default/>
        <type>String</type>
      </value>
      <value>
        <name>LOSSRUN_MAP_CODE</name>
        <rename>LOSSRUN_MAP_CODE</rename>
        <default/>
        <type>String</type>
      </value>
      <value>
        <name>CLAIM_MAP_CODE</name>
        <rename>CLAIM_MAP_CODE</rename>
        <default/>
        <type>String</type>
      </value>
    </lookup>
    <cluster_schema/>
    <remotesteps>
      <input>
      </input>
      <output>
      </output>
    </remotesteps>
    <GUI>
      <xloc>800</xloc>
      <yloc>576</yloc>
      <draw>Y</draw>
    </GUI>
  </step>
  <step>
    <name>LOB_MAPPING</name>
    <type>TableInput</type>
    <description/>
    <distribute>Y</distribute>
    <custom_distribution/>
    <copies>1</copies>
    <partitioning>
      <method>none</method>
      <schema_name/>
    </partitioning>
    <connection>DRABPRD</connection>
    <sql>SELECT C.COVERAGE_CODE,
  C.MAPPING_CODE AS LOB_CODE,
  C.LOSSRUN_MAP_CODE,
  C.CLAIM_MAP_CODE
FROM MAG_COVERAGE_MAPPING C
WHERE C.MAPPING_CATEGORY = 'LOB'</sql>
    <limit>0</limit>
    <lookup/>
    <execute_each_row>N</execute_each_row>
    <variables_active>N</variables_active>
    <lazy_conversion_active>N</lazy_conversion_active>
    <cluster_schema/>
    <remotesteps>
      <input>
      </input>
      <output>
      </output>
    </remotesteps>
    <GUI>
      <xloc>800</xloc>
      <yloc>688</yloc>
      <draw>Y</draw>
    </GUI>
  </step>
  <step>
    <name>LOOKUP_COMMISSION_AMOUNT</name>
    <type>StreamLookup</type>
    <description/>
    <distribute>Y</distribute>
    <custom_distribution/>
    <copies>1</copies>
    <partitioning>
      <method>none</method>
      <schema_name/>
    </partitioning>
    <from>COMMISSION_AMOUNT</from>
    <input_sorted>N</input_sorted>
    <preserve_memory>Y</preserve_memory>
    <sorted_list>N</sorted_list>
    <integer_pair>N</integer_pair>
    <lookup>
      <key>
        <name>MONTH_ID</name>
        <field>MONTH_ID</field>
      </key>
      <key>
        <name>POL_UNIQUEID</name>
        <field>POL_UNIQUEID</field>
      </key>
      <value>
        <name>COMMISSION_AMOUNT</name>
        <rename>COMMISSION_AMOUNT</rename>
        <default/>
        <type>Number</type>
      </value>
    </lookup>
    <cluster_schema/>
    <remotesteps>
      <input>
      </input>
      <output>
      </output>
    </remotesteps>
    <GUI>
      <xloc>400</xloc>
      <yloc>576</yloc>
      <draw>Y</draw>
    </GUI>
  </step>
  <step>
    <name>LOOKUP_SHARED_LIMIT_B</name>
    <type>StreamLookup</type>
    <description/>
    <distribute>N</distribute>
    <custom_distribution/>
    <copies>1</copies>
    <partitioning>
      <method>none</method>
      <schema_name/>
    </partitioning>
    <from>SHARED_LIMIT</from>
    <input_sorted>N</input_sorted>
    <preserve_memory>Y</preserve_memory>
    <sorted_list>N</sorted_list>
    <integer_pair>N</integer_pair>
    <lookup>
      <key>
        <name>POL_ID</name>
        <field>POLICY_ID</field>
      </key>
      <key>
        <name>MONTH_ID</name>
        <field>MONTH_ID</field>
      </key>
      <key>
        <name>POLEFFDT_ID</name>
        <field>POLICYEFFECTIVEDATE_ID</field>
      </key>
      <key>
        <name>POLEXPDT_ID</name>
        <field>POLICYEXPIRATIONDATE_ID</field>
      </key>
      <key>
        <name>COVG_ID</name>
        <field>COVERAGE_ID</field>
      </key>
      <key>
        <name>COVRSK_ID</name>
        <field>COVEREDRISK_ID</field>
      </key>
      <key>
        <name>COV_EXT_ID</name>
        <field>COVERAGEEXTENSION_ID</field>
      </key>
      <key>
        <name>FIRSTINSURED_ID</name>
        <field>FIRSTINSURED_ID</field>
      </key>
      <key>
        <name>COMP_ID</name>
        <field>COMPONENT_ID</field>
      </key>
      <value>
        <name>MMCOV_SHARED_LIMIT_B</name>
        <rename>MMCOV_SHARED_LIMIT_B</rename>
        <default/>
        <type>String</type>
      </value>
      <value>
        <name>SHARE_GROUP_DESC</name>
        <rename>SHARE_GROUP_DESC</rename>
        <default/>
        <type>String</type>
      </value>
      <value>
        <name>COV_LIMIT_OWNER</name>
        <rename>COV_LIMIT_OWNER</rename>
        <default/>
        <type>String</type>
      </value>
    </lookup>
    <cluster_schema/>
    <remotesteps>
      <input>
      </input>
      <output>
      </output>
    </remotesteps>
    <GUI>
      <xloc>624</xloc>
      <yloc>576</yloc>
      <draw>Y</draw>
    </GUI>
  </step>
  <step>
    <name>MASTER COMPANY 2</name>
    <type>StreamLookup</type>
    <description/>
    <distribute>N</distribute>
    <custom_distribution/>
    <copies>1</copies>
    <partitioning>
      <method>none</method>
      <schema_name/>
    </partitioning>
    <from>FP_LEGALENTITY_COMPANY</from>
    <input_sorted>N</input_sorted>
    <preserve_memory>Y</preserve_memory>
    <sorted_list>N</sorted_list>
    <integer_pair>N</integer_pair>
    <lookup>
      <key>
        <name>POL_ID</name>
        <field>POLICY_ID</field>
      </key>
      <key>
        <name>MONTH_ID</name>
        <field>MONTH_ID</field>
      </key>
      <key>
        <name>POLEFFDT_ID</name>
        <field>POLICYEFFECTIVEDATE_ID</field>
      </key>
      <key>
        <name>POLEXPDT_ID</name>
        <field>POLICYEXPIRATIONDATE_ID</field>
      </key>
      <key>
        <name>COMPANY_ID</name>
        <field>COMPANY_ID</field>
      </key>
      <value>
        <name>COMPANY</name>
        <rename>COMPANY</rename>
        <default/>
        <type>String</type>
      </value>
      <value>
        <name>COMP_NUMBER</name>
        <rename>COMP_NUMBER</rename>
        <default/>
        <type>Integer</type>
      </value>
    </lookup>
    <cluster_schema/>
    <remotesteps>
      <input>
      </input>
      <output>
      </output>
    </remotesteps>
    <GUI>
      <xloc>2192</xloc>
      <yloc>576</yloc>
      <draw>Y</draw>
    </GUI>
  </step>
  <step>
    <name>MINI_UNIQID HUL LU </name>
    <type>StreamLookup</type>
    <description/>
    <distribute>Y</distribute>
    <custom_distribution/>
    <copies>1</copies>
    <partitioning>
      <method>none</method>
      <schema_name/>
    </partitioning>
    <from>STG_MINI_PM_POLNO_XREF 2</from>
    <input_sorted>N</input_sorted>
    <preserve_memory>Y</preserve_memory>
    <sorted_list>N</sorted_list>
    <integer_pair>N</integer_pair>
    <lookup>
      <key>
        <name>POL_UNIQUEID</name>
        <field>NEW_UNIQID</field>
      </key>
      <value>
        <name>MINI_POL_UMB_XREF_UNQID</name>
        <rename>MINI_POL_UMB_XREF_UNQID</rename>
        <default/>
        <type>String</type>
      </value>
    </lookup>
    <cluster_schema/>
    <remotesteps>
      <input>
      </input>
      <output>
      </output>
    </remotesteps>
    <GUI>
      <xloc>2016</xloc>
      <yloc>576</yloc>
      <draw>Y</draw>
    </GUI>
  </step>
  <step>
    <name>MINI_UNIQID NON HUL LU</name>
    <type>StreamLookup</type>
    <description/>
    <distribute>Y</distribute>
    <custom_distribution/>
    <copies>1</copies>
    <partitioning>
      <method>none</method>
      <schema_name/>
    </partitioning>
    <from>STG_MINI_PM_POLNO_XREF</from>
    <input_sorted>N</input_sorted>
    <preserve_memory>Y</preserve_memory>
    <sorted_list>N</sorted_list>
    <integer_pair>N</integer_pair>
    <lookup>
      <key>
        <name>POL_UNIQUEID</name>
        <field>NEW_UNIQID</field>
      </key>
      <value>
        <name>MINI_POL_XREF_UNQID</name>
        <rename>MINI_POL_XREF_UNQID</rename>
        <default/>
        <type>String</type>
      </value>
    </lookup>
    <cluster_schema/>
    <remotesteps>
      <input>
      </input>
      <output>
      </output>
    </remotesteps>
    <GUI>
      <xloc>1808</xloc>
      <yloc>576</yloc>
      <draw>Y</draw>
    </GUI>
  </step>
  <step>
    <name>MONTHLY_TRANSACTION_LU</name>
    <type>StreamLookup</type>
    <description/>
    <distribute>N</distribute>
    <custom_distribution/>
    <copies>1</copies>
    <partitioning>
      <method>none</method>
      <schema_name/>
    </partitioning>
    <from>FACT_POLICYTRANSACTION</from>
    <input_sorted>N</input_sorted>
    <preserve_memory>Y</preserve_memory>
    <sorted_list>N</sorted_list>
    <integer_pair>N</integer_pair>
    <lookup>
      <key>
        <name>POL_ID</name>
        <field>POLICY_ID</field>
      </key>
      <key>
        <name>POLEFFDT_ID</name>
        <field>POLICYEFFECTIVEDATE_ID</field>
      </key>
      <key>
        <name>POLEXPDT_ID</name>
        <field>POLICYEXPIRATIONDATE_ID</field>
      </key>
      <key>
        <name>COVRSK_ID</name>
        <field>COVEREDRISK_ID</field>
      </key>
      <key>
        <name>COVG_ID</name>
        <field>COVERAGE_ID</field>
      </key>
      <key>
        <name>MONTH_ID</name>
        <field>JOIN_MONTH_ID</field>
      </key>
      <value>
        <name>TRANS_NAME</name>
        <rename>TRANS_NAME</rename>
        <default/>
        <type>String</type>
      </value>
      <value>
        <name>ACCT_DATE</name>
        <rename>ACCT_DATE</rename>
        <default/>
        <type>Integer</type>
      </value>
      <value>
        <name>TRANS_EFF_DATE</name>
        <rename>TRANS_EFF_DATE</rename>
        <default/>
        <type>Integer</type>
      </value>
      <value>
        <name>TRANS_CODE</name>
        <rename>TRANS_CODE</rename>
        <default/>
        <type>String</type>
      </value>
      <value>
        <name>TRAN_AMOUNT</name>
        <rename>TRAN_AMOUNT</rename>
        <default/>
        <type>Number</type>
      </value>
      <value>
        <name>TRANS_DATE</name>
        <rename>TRANS_DATE</rename>
        <default/>
        <type>Integer</type>
      </value>
      <value>
        <name>TRANS_DESC</name>
        <rename>TRANS_DESC</rename>
        <default/>
        <type>String</type>
      </value>
    </lookup>
    <cluster_schema/>
    <remotesteps>
      <input>
      </input>
      <output>
      </output>
    </remotesteps>
    <GUI>
      <xloc>1552</xloc>
      <yloc>576</yloc>
      <draw>Y</draw>
    </GUI>
  </step>
  <step>
    <name>POLICY CALIMS CON LU</name>
    <type>StreamLookup</type>
    <description/>
    <distribute>Y</distribute>
    <custom_distribution/>
    <copies>1</copies>
    <partitioning>
      <method>none</method>
      <schema_name/>
    </partitioning>
    <from>CLAIMS_CONSULTANT</from>
    <input_sorted>N</input_sorted>
    <preserve_memory>Y</preserve_memory>
    <sorted_list>N</sorted_list>
    <integer_pair>N</integer_pair>
    <lookup>
      <key>
        <name>POL_POLICYNUMBER</name>
        <field>POL_POLICYNUMBER</field>
      </key>
      <value>
        <name>CLAIMS_CONSULTANT</name>
        <rename>CLAIMS_CONSULTANT</rename>
        <default/>
        <type>String</type>
      </value>
    </lookup>
    <cluster_schema/>
    <remotesteps>
      <input>
      </input>
      <output>
      </output>
    </remotesteps>
    <GUI>
      <xloc>1360</xloc>
      <yloc>144</yloc>
      <draw>Y</draw>
    </GUI>
  </step>
  <step>
    <name>POLICY_LU</name>
    <type>StreamLookup</type>
    <description/>
    <distribute>Y</distribute>
    <custom_distribution/>
    <copies>1</copies>
    <partitioning>
      <method>none</method>
      <schema_name/>
    </partitioning>
    <from>DIM_POLICY</from>
    <input_sorted>N</input_sorted>
    <preserve_memory>Y</preserve_memory>
    <sorted_list>N</sorted_list>
    <integer_pair>N</integer_pair>
    <lookup>
      <key>
        <name>POL_ID</name>
        <field>POLICY_ID</field>
      </key>
      <value>
        <name>POL_POLICYNUMBER</name>
        <rename>POL_POLICYNUMBER</rename>
        <default/>
        <type>String</type>
      </value>
      <value>
        <name>POL_MASTERSTATE</name>
        <rename>POL_MASTERSTATE</rename>
        <default/>
        <type>String</type>
      </value>
      <value>
        <name>POL_UNIQUEID</name>
        <rename>POL_UNIQUEID</rename>
        <default/>
        <type>String</type>
      </value>
    </lookup>
    <cluster_schema/>
    <remotesteps>
      <input>
      </input>
      <output>
      </output>
    </remotesteps>
    <GUI>
      <xloc>1200</xloc>
      <yloc>144</yloc>
      <draw>Y</draw>
    </GUI>
  </step>
  <step>
    <name>POLICY_TYPE_LU</name>
    <type>StreamLookup</type>
    <description/>
    <distribute>Y</distribute>
    <custom_distribution/>
    <copies>1</copies>
    <partitioning>
      <method>none</method>
      <schema_name/>
    </partitioning>
    <from>DIM_POLICYEXTENSION</from>
    <input_sorted>N</input_sorted>
    <preserve_memory>Y</preserve_memory>
    <sorted_list>N</sorted_list>
    <integer_pair>N</integer_pair>
    <lookup>
      <key>
        <name>POLEXTN_ID</name>
        <field>POLICYEXTENSION_ID</field>
      </key>
      <value>
        <name>POLICY_TYPE_CODE</name>
        <rename>POLICY_TYPE_CODE</rename>
        <default/>
        <type>String</type>
      </value>
      <value>
        <name>POLICY_TYPE_DESC</name>
        <rename>POLICY_TYPE_DESC</rename>
        <default/>
        <type>String</type>
      </value>
      <value>
        <name>ORGANIZATION_TYPE</name>
        <rename>ORGANIZATION_TYPE</rename>
        <default/>
        <type>String</type>
      </value>
      <value>
        <name>POLICY_RENEWAL_INDICATOR_CODE</name>
        <rename>POLICY_RENEWAL_INDICATOR_CODE</rename>
        <default/>
        <type>String</type>
      </value>
      <value>
        <name>POLICY_RENEWAL_INDICATOR_DESC</name>
        <rename>POLICY_RENEWAL_INDICATOR_DESC</rename>
        <default/>
        <type>String</type>
      </value>
      <value>
        <name>POLICY_CANCEL_TYPE_CODE</name>
        <rename>POLICY_CANCEL_TYPE_CODE</rename>
        <default/>
        <type>String</type>
      </value>
      <value>
        <name>POLICY_CANCEL_TYPE_DESC</name>
        <rename>POLICY_CANCEL_TYPE_DESC</rename>
        <default/>
        <type>String</type>
      </value>
      <value>
        <name>POLICY_CANCEL_REASON_CODE</name>
        <rename>POLICY_CANCEL_REASON_CODE</rename>
        <default/>
        <type>String</type>
      </value>
      <value>
        <name>POLICY_CANCEL_REASON_DESC</name>
        <rename>POLICY_CANCEL_REASON_DESC</rename>
        <default/>
        <type>String</type>
      </value>
    </lookup>
    <cluster_schema/>
    <remotesteps>
      <input>
      </input>
      <output>
      </output>
    </remotesteps>
    <GUI>
      <xloc>2192</xloc>
      <yloc>144</yloc>
      <draw>Y</draw>
    </GUI>
  </step>
  <step>
    <name>PREMIUM_LU</name>
    <type>StreamLookup</type>
    <description/>
    <distribute>Y</distribute>
    <custom_distribution/>
    <copies>1</copies>
    <partitioning>
      <method>none</method>
      <schema_name/>
    </partitioning>
    <from>FACT_POLICYCOVERAGE_FOR_PREMIUM_AND_POL_STATUS</from>
    <input_sorted>N</input_sorted>
    <preserve_memory>Y</preserve_memory>
    <sorted_list>N</sorted_list>
    <integer_pair>N</integer_pair>
    <lookup>
      <key>
        <name>POL_ID</name>
        <field>POLICY_ID</field>
      </key>
      <key>
        <name>COVRSK_ID</name>
        <field>COVEREDRISK_ID</field>
      </key>
      <key>
        <name>MONTH_ID</name>
        <field>MONTH_ID</field>
      </key>
      <key>
        <name>POLEFFDT_ID</name>
        <field>POLICYEFFECTIVEDATE_ID</field>
      </key>
      <key>
        <name>POLEXPDT_ID</name>
        <field>POLICYEXPIRATIONDATE_ID</field>
      </key>
      <key>
        <name>COVG_ID</name>
        <field>COVERAGE_ID</field>
      </key>
      <key>
        <name>COMP_ID</name>
        <field>COMPONENT_ID</field>
      </key>
      <key>
        <name>FI_ID</name>
        <field>FIRSTINSURED_ID</field>
      </key>
      <key>
        <name>COV_EXT_ID</name>
        <field>COVERAGEEXTENSION_ID</field>
      </key>
      <key>
        <name>MMCOV_COVERAGE_STATUS</name>
        <field>MMCOV_COVERAGE_STATUS</field>
      </key>
      <key>
        <name>POLICY_STATUS</name>
        <field>POLICY_STATUS</field>
      </key>
      <value>
        <name>WRTN_PREM_AMT</name>
        <rename>WRTN_PREM_AMT</rename>
        <default/>
        <type>Number</type>
      </value>
      <value>
        <name>EARNED_PREM_AMT</name>
        <rename>EARNED_PREM_AMT</rename>
        <default/>
        <type>Number</type>
      </value>
      <value>
        <name>UNEARNED_PREM</name>
        <rename>UNEARNED_PREM</rename>
        <default/>
        <type>Number</type>
      </value>
      <value>
        <name>WRTN_PREM_AMT_YTD</name>
        <rename>WRTN_PREM_AMT_YTD</rename>
        <default/>
        <type>Number</type>
      </value>
      <value>
        <name>EARNED_PREM_AMT_YTD</name>
        <rename>EARNED_PREM_AMT_YTD</rename>
        <default/>
        <type>Number</type>
      </value>
      <value>
        <name>WRTN_PREM_AMT_ITD</name>
        <rename>WRTN_PREM_AMT_ITD</rename>
        <default/>
        <type>Number</type>
      </value>
      <value>
        <name>EARNED_PREM_AMT_ITD</name>
        <rename>EARNED_PREM_AMT_ITD</rename>
        <default/>
        <type>Number</type>
      </value>
      <value>
        <name>BASE_TERR_CODE</name>
        <rename>BASE_TERR_CODE</rename>
        <default/>
        <type>String</type>
      </value>
      <value>
        <name>BASE_TERR_NAME</name>
        <rename>BASE_TERR_NAME</rename>
        <default/>
        <type>String</type>
      </value>
    </lookup>
    <cluster_schema/>
    <remotesteps>
      <input>
      </input>
      <output>
      </output>
    </remotesteps>
    <GUI>
      <xloc>1840</xloc>
      <yloc>144</yloc>
      <draw>Y</draw>
    </GUI>
  </step>
  <step>
    <name>PRODUCER_NAME</name>
    <type>StreamLookup</type>
    <description/>
    <distribute>Y</distribute>
    <custom_distribution/>
    <copies>1</copies>
    <partitioning>
      <method>none</method>
      <schema_name/>
    </partitioning>
    <from>VDIM_PRODUCER</from>
    <input_sorted>N</input_sorted>
    <preserve_memory>Y</preserve_memory>
    <sorted_list>Y</sorted_list>
    <integer_pair>N</integer_pair>
    <lookup>
      <key>
        <name>PRODUCER_ID</name>
        <field>PRODUCER_ID</field>
      </key>
      <value>
        <name>PRODUCER_NAME</name>
        <rename>PRODUCER_NAME</rename>
        <default/>
        <type>String</type>
      </value>
      <value>
        <name>AGENCY_TYPE</name>
        <rename>AGENCY_TYPE</rename>
        <default/>
        <type>String</type>
      </value>
    </lookup>
    <cluster_schema/>
    <remotesteps>
      <input>
      </input>
      <output>
      </output>
    </remotesteps>
    <GUI>
      <xloc>2192</xloc>
      <yloc>416</yloc>
      <draw>Y</draw>
    </GUI>
  </step>
  <step>
    <name>RISK STATE ETC</name>
    <type>StreamLookup</type>
    <description/>
    <distribute>Y</distribute>
    <custom_distribution/>
    <copies>1</copies>
    <partitioning>
      <method>none</method>
      <schema_name/>
    </partitioning>
    <from>DIM_COVEREDRISKEXT</from>
    <input_sorted>N</input_sorted>
    <preserve_memory>Y</preserve_memory>
    <sorted_list>N</sorted_list>
    <integer_pair>N</integer_pair>
    <lookup>
      <key>
        <name>COVRSKEXTN_ID</name>
        <field>COVEREDRISKEXTENSION_ID</field>
      </key>
      <value>
        <name>RISK_SPECIALTY_CODE</name>
        <rename>RISK_SPECIALTY_CODE</rename>
        <default/>
        <type>String</type>
      </value>
      <value>
        <name>RISK_SPECIALTY_DESC</name>
        <rename>RISK_SPECIALTY_DESC</rename>
        <default/>
        <type>String</type>
      </value>
      <value>
        <name>RISK_COUNTY_CODE</name>
        <rename>RISK_COUNTY_CODE</rename>
        <default/>
        <type>String</type>
      </value>
      <value>
        <name>RISK_COUNTY_DESC</name>
        <rename>RISK_COUNTY_DESC</rename>
        <default/>
        <type>String</type>
      </value>
      <value>
        <name>RISK_CURRENT_STATUS</name>
        <rename>RISK_CURRENT_STATUS</rename>
        <default/>
        <type>String</type>
      </value>
      <value>
        <name>POLICY_PRIMARY_RISK</name>
        <rename>POLICY_PRIMARY_RISK</rename>
        <default/>
        <type>String</type>
      </value>
      <value>
        <name>RISK_CANCEL_REASON_CODE</name>
        <rename>RISK_CANCEL_REASON_CODE</rename>
        <default/>
        <type>String</type>
      </value>
      <value>
        <name>RISK_CANCEL_REASON_DESC</name>
        <rename>RISK_CANCEL_REASON_DESC</rename>
        <default/>
        <type>String</type>
      </value>
      <value>
        <name>SLOT_ID</name>
        <rename>SLOT_ID</rename>
        <default/>
        <type>Integer</type>
      </value>
      <value>
        <name>NUM_DOCS_ON_SLOT</name>
        <rename>NUM_DOCS_ON_SLOT</rename>
        <default/>
        <type>Integer</type>
      </value>
      <value>
        <name>NUM_OF_BEDS</name>
        <rename>NUM_OF_BEDS</rename>
        <default/>
        <type>Integer</type>
      </value>
      <value>
        <name>RISK_PRACTICE_STATE_CODE</name>
        <rename>RISK_PRACTICE_STATE_CODE</rename>
        <default/>
        <type>String</type>
      </value>
      <value>
        <name>FTE_FULL_TIME_HRS</name>
        <rename>FTE_FULL_TIME_HRS</rename>
        <default/>
        <type>Integer</type>
      </value>
      <value>
        <name>FTE_PART_TIME_HRS</name>
        <rename>FTE_PART_TIME_HRS</rename>
        <default/>
        <type>Integer</type>
      </value>
      <value>
        <name>POINT_MAG_ID</name>
        <rename>POINT_MAG_ID</rename>
        <default/>
        <type>String</type>
      </value>
      <value>
        <name>RISK_CITY_CODE</name>
        <rename>RISK_CITY_CODE</rename>
        <default/>
        <type>String</type>
      </value>
      <value>
        <name>RSK_EFFECTIVE_FROM_DATE</name>
        <rename>RSK_EFFECTIVE_FROM_DATE</rename>
        <default/>
        <type>Timestamp</type>
      </value>
      <value>
        <name>RSK_EFFECTIVE_TO_DATE</name>
        <rename>RSK_EFFECTIVE_TO_DATE</rename>
        <default/>
        <type>Timestamp</type>
      </value>
    </lookup>
    <cluster_schema/>
    <remotesteps>
      <input>
      </input>
      <output>
      </output>
    </remotesteps>
    <GUI>
      <xloc>1056</xloc>
      <yloc>144</yloc>
      <draw>Y</draw>
    </GUI>
  </step>
  <step>
    <name>SHARED_LIMIT</name>
    <type>TableInput</type>
    <description/>
    <distribute>Y</distribute>
    <custom_distribution/>
    <copies>1</copies>
    <partitioning>
      <method>none</method>
      <schema_name/>
    </partitioning>
    <connection>magstage_DRABPRD</connection>
    <sql>SELECT
POLICY_ID,MONTH_ID,POLICYEFFECTIVEDATE_ID,POLICYEXPIRATIONDATE_ID,
COVERAGE_ID,COVERAGEEXTENSION_ID,COVEREDRISK_ID,FIRSTINSURED_ID,COMPONENT_ID,MMCOV_SHARED_LIMIT_B,SHARE_GROUP_DESC, OWNER_B AS COV_LIMIT_OWNER
FROM STG_POL_SHR_GRP

UNION

SELECT
POLICY_ID,MONTH_ID,POLICYEFFECTIVEDATE_ID,POLICYEXPIRATIONDATE_ID,
COVERAGE_ID,COVERAGEEXTENSION_ID,COVEREDRISK_ID,FIRSTINSURED_ID,COMPONENT_ID,MMCOV_SHARED_LIMIT_B,NULL AS SHARE_GROUP_DESC, NULL AS COV_LIMIT_OWNER
FROM STG_POL_SEP_LIMIT
ORDER BY POLICY_ID,MONTH_ID,POLICYEFFECTIVEDATE_ID,POLICYEXPIRATIONDATE_ID,
COVERAGE_ID,COVERAGEEXTENSION_ID,COVEREDRISK_ID,FIRSTINSURED_ID,COMPONENT_ID</sql>
    <limit>0</limit>
    <lookup/>
    <execute_each_row>N</execute_each_row>
    <variables_active>Y</variables_active>
    <lazy_conversion_active>N</lazy_conversion_active>
    <cluster_schema/>
    <remotesteps>
      <input>
      </input>
      <output>
      </output>
    </remotesteps>
    <GUI>
      <xloc>624</xloc>
      <yloc>688</yloc>
      <draw>Y</draw>
    </GUI>
  </step>
  <step>
    <name>STG_DM_POLICY_PV</name>
    <type>TableInput</type>
    <description/>
    <distribute>Y</distribute>
    <custom_distribution/>
    <copies>1</copies>
    <partitioning>
      <method>none</method>
      <schema_name/>
    </partitioning>
    <connection>magstage_DRABPRD</connection>
    <sql>SELECT *
FROM STG_DM_POLICY_PV 
WHERE COV_TYP NOT IN
(
'CGL',
'EBL',
'HLP',
'HPL',
'HRF',
'HUL',
'PSL'
)
ORDER BY MONTH_ID, POL_ID, FI_ID, COVRSK_ID, COVG_ID, COV_EXT_ID,
  COV_CLAS_EXT_ID,
  COVEFFDT_ID,
  COVEXPDT_ID, COMP_ID</sql>
    <limit>0</limit>
    <lookup/>
    <execute_each_row>N</execute_each_row>
    <variables_active>N</variables_active>
    <lazy_conversion_active>N</lazy_conversion_active>
    <cluster_schema/>
    <remotesteps>
      <input>
      </input>
      <output>
      </output>
    </remotesteps>
    <GUI>
      <xloc>128</xloc>
      <yloc>144</yloc>
      <draw>Y</draw>
    </GUI>
  </step>
  <step>
    <name>STG_MINI_PM_POLNO_XREF</name>
    <type>TableInput</type>
    <description/>
    <distribute>Y</distribute>
    <custom_distribution/>
    <copies>1</copies>
    <partitioning>
      <method>none</method>
      <schema_name/>
    </partitioning>
    <connection>magstage_DRABPRD</connection>
    <sql>SELECT DISTINCT NEW_UNIQID,   MINI_UNIQID  AS MINI_POL_XREF_UNQID 
FROM STG_MINI_PM_POLNO_XREF
WHERE MINI_UNIQID NOT LIKE 'HUL%'
ORDER BY NEW_UNIQID</sql>
    <limit>0</limit>
    <lookup/>
    <execute_each_row>N</execute_each_row>
    <variables_active>N</variables_active>
    <lazy_conversion_active>N</lazy_conversion_active>
    <cluster_schema/>
    <remotesteps>
      <input>
      </input>
      <output>
      </output>
    </remotesteps>
    <GUI>
      <xloc>1808</xloc>
      <yloc>704</yloc>
      <draw>Y</draw>
    </GUI>
  </step>
  <step>
    <name>STG_MINI_PM_POLNO_XREF 2</name>
    <type>TableInput</type>
    <description/>
    <distribute>Y</distribute>
    <custom_distribution/>
    <copies>1</copies>
    <partitioning>
      <method>none</method>
      <schema_name/>
    </partitioning>
    <connection>magstage_DRABPRD</connection>
    <sql>SELECT DISTINCT NEW_UNIQID,   MINI_UNIQID  AS MINI_POL_UMB_XREF_UNQID
FROM STG_MINI_PM_POLNO_XREF
WHERE MINI_UNIQID LIKE 'HUL%'
ORDER BY NEW_UNIQID</sql>
    <limit>0</limit>
    <lookup/>
    <execute_each_row>N</execute_each_row>
    <variables_active>N</variables_active>
    <lazy_conversion_active>N</lazy_conversion_active>
    <cluster_schema/>
    <remotesteps>
      <input>
      </input>
      <output>
      </output>
    </remotesteps>
    <GUI>
      <xloc>2016</xloc>
      <yloc>704</yloc>
      <draw>Y</draw>
    </GUI>
  </step>
  <step>
    <name>UNDERWRITER_NAME</name>
    <type>StreamLookup</type>
    <description/>
    <distribute>N</distribute>
    <custom_distribution/>
    <copies>1</copies>
    <partitioning>
      <method>none</method>
      <schema_name/>
    </partitioning>
    <from>VDIM_UNDERWRITER </from>
    <input_sorted>N</input_sorted>
    <preserve_memory>Y</preserve_memory>
    <sorted_list>Y</sorted_list>
    <integer_pair>N</integer_pair>
    <lookup>
      <key>
        <name>UNDERWRITER_ID</name>
        <field>UNDERWRITER_ID</field>
      </key>
      <value>
        <name>UNDERWRITER_NAME</name>
        <rename>UNDERWRITER_NAME</rename>
        <default/>
        <type>String</type>
      </value>
    </lookup>
    <cluster_schema/>
    <remotesteps>
      <input>
      </input>
      <output>
      </output>
    </remotesteps>
    <GUI>
      <xloc>1120</xloc>
      <yloc>576</yloc>
      <draw>Y</draw>
    </GUI>
  </step>
  <step>
    <name>VDIM_FIRSTINSURED</name>
    <type>TableInput</type>
    <description/>
    <distribute>Y</distribute>
    <custom_distribution/>
    <copies>1</copies>
    <partitioning>
      <method>none</method>
      <schema_name/>
    </partitioning>
    <connection>DRABPRD</connection>
    <sql>SELECT DISTINCT  VDFI.FIRSTINSURED_ID, VDFI.FINSD_FORMATTED_NAME AS FIRST_INSURED, E.EN_VERY_LONG_NAME AS FIRST_INSURED_V_LONG_NM
FROM VDIM_FIRSTINSURED VDFI
INNER JOIN DIM_ENTITY E 
ON VDFI.FINSD_UNIQUEID = E.EN_CLIENT_ID
ORDER BY VDFI.FIRSTINSURED_ID</sql>
    <limit>0</limit>
    <lookup/>
    <execute_each_row>N</execute_each_row>
    <variables_active>N</variables_active>
    <lazy_conversion_active>N</lazy_conversion_active>
    <cluster_schema/>
    <remotesteps>
      <input>
      </input>
      <output>
      </output>
    </remotesteps>
    <GUI>
      <xloc>448</xloc>
      <yloc>32</yloc>
      <draw>Y</draw>
    </GUI>
  </step>
  <step>
    <name>VDIM_PRODUCER</name>
    <type>TableInput</type>
    <description/>
    <distribute>Y</distribute>
    <custom_distribution/>
    <copies>1</copies>
    <partitioning>
      <method>none</method>
      <schema_name/>
    </partitioning>
    <connection>DRABPRD</connection>
    <sql>SELECT   PRDR_FORMATTED_NAME AS PRODUCER_NAME,PRDR_SITUATION_CODE AS AGENCY_TYPE,
PRODUCER_ID
FROM VDIM_PRODUCER
</sql>
    <limit>0</limit>
    <lookup/>
    <execute_each_row>N</execute_each_row>
    <variables_active>N</variables_active>
    <lazy_conversion_active>N</lazy_conversion_active>
    <cluster_schema/>
    <remotesteps>
      <input>
      </input>
      <output>
      </output>
    </remotesteps>
    <GUI>
      <xloc>2368</xloc>
      <yloc>416</yloc>
      <draw>Y</draw>
    </GUI>
  </step>
  <step>
    <name>VDIM_UNDERWRITER </name>
    <type>TableInput</type>
    <description/>
    <distribute>Y</distribute>
    <custom_distribution/>
    <copies>1</copies>
    <partitioning>
      <method>none</method>
      <schema_name/>
    </partitioning>
    <connection>DRABPRD</connection>
    <sql>SELECT    UNDERWRITER_ID,
UW_NAME1 ||' '|| UW_NAME2 AS Underwriter_Name
FROM VDIM_UNDERWRITER
</sql>
    <limit>0</limit>
    <lookup/>
    <execute_each_row>N</execute_each_row>
    <variables_active>N</variables_active>
    <lazy_conversion_active>N</lazy_conversion_active>
    <cluster_schema/>
    <remotesteps>
      <input>
      </input>
      <output>
      </output>
    </remotesteps>
    <GUI>
      <xloc>1120</xloc>
      <yloc>688</yloc>
      <draw>Y</draw>
    </GUI>
  </step>
  <step_error_handling>
  </step_error_handling>
  <slave-step-copy-partition-distribution>
  </slave-step-copy-partition-distribution>
  <slave_transformation>N</slave_transformation>
</transformation>
