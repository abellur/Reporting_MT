<transformation>
  <info>
    <name>TF_CLAIMSUMMARY01</name>
    <description/>
    <extended_description/>
    <trans_version/>
    <trans_type>Normal</trans_type>
    <trans_status>0</trans_status>
    <directory>/public/Claim</directory>
    <parameters>
    </parameters>
    <log>
      <trans-log-table>
        <connection/>
        <schema/>
        <table/>
        <size_limit_lines/>
        <interval/>
        <timeout_days/>
        <field>
          <id>ID_BATCH</id>
          <enabled>Y</enabled>
          <name>ID_BATCH</name>
        </field>
        <field>
          <id>CHANNEL_ID</id>
          <enabled>Y</enabled>
          <name>CHANNEL_ID</name>
        </field>
        <field>
          <id>TRANSNAME</id>
          <enabled>Y</enabled>
          <name>TRANSNAME</name>
        </field>
        <field>
          <id>STATUS</id>
          <enabled>Y</enabled>
          <name>STATUS</name>
        </field>
        <field>
          <id>LINES_READ</id>
          <enabled>Y</enabled>
          <name>LINES_READ</name>
          <subject/>
        </field>
        <field>
          <id>LINES_WRITTEN</id>
          <enabled>Y</enabled>
          <name>LINES_WRITTEN</name>
          <subject/>
        </field>
        <field>
          <id>LINES_UPDATED</id>
          <enabled>Y</enabled>
          <name>LINES_UPDATED</name>
          <subject/>
        </field>
        <field>
          <id>LINES_INPUT</id>
          <enabled>Y</enabled>
          <name>LINES_INPUT</name>
          <subject/>
        </field>
        <field>
          <id>LINES_OUTPUT</id>
          <enabled>Y</enabled>
          <name>LINES_OUTPUT</name>
          <subject/>
        </field>
        <field>
          <id>LINES_REJECTED</id>
          <enabled>Y</enabled>
          <name>LINES_REJECTED</name>
          <subject/>
        </field>
        <field>
          <id>ERRORS</id>
          <enabled>Y</enabled>
          <name>ERRORS</name>
        </field>
        <field>
          <id>STARTDATE</id>
          <enabled>Y</enabled>
          <name>STARTDATE</name>
        </field>
        <field>
          <id>ENDDATE</id>
          <enabled>Y</enabled>
          <name>ENDDATE</name>
        </field>
        <field>
          <id>LOGDATE</id>
          <enabled>Y</enabled>
          <name>LOGDATE</name>
        </field>
        <field>
          <id>DEPDATE</id>
          <enabled>Y</enabled>
          <name>DEPDATE</name>
        </field>
        <field>
          <id>REPLAYDATE</id>
          <enabled>Y</enabled>
          <name>REPLAYDATE</name>
        </field>
        <field>
          <id>LOG_FIELD</id>
          <enabled>Y</enabled>
          <name>LOG_FIELD</name>
        </field>
        <field>
          <id>EXECUTING_SERVER</id>
          <enabled>N</enabled>
          <name>EXECUTING_SERVER</name>
        </field>
        <field>
          <id>EXECUTING_USER</id>
          <enabled>N</enabled>
          <name>EXECUTING_USER</name>
        </field>
        <field>
          <id>CLIENT</id>
          <enabled>N</enabled>
          <name>CLIENT</name>
        </field>
      </trans-log-table>
      <perf-log-table>
        <connection/>
        <schema/>
        <table/>
        <interval/>
        <timeout_days/>
        <field>
          <id>ID_BATCH</id>
          <enabled>Y</enabled>
          <name>ID_BATCH</name>
        </field>
        <field>
          <id>SEQ_NR</id>
          <enabled>Y</enabled>
          <name>SEQ_NR</name>
        </field>
        <field>
          <id>LOGDATE</id>
          <enabled>Y</enabled>
          <name>LOGDATE</name>
        </field>
        <field>
          <id>TRANSNAME</id>
          <enabled>Y</enabled>
          <name>TRANSNAME</name>
        </field>
        <field>
          <id>STEPNAME</id>
          <enabled>Y</enabled>
          <name>STEPNAME</name>
        </field>
        <field>
          <id>STEP_COPY</id>
          <enabled>Y</enabled>
          <name>STEP_COPY</name>
        </field>
        <field>
          <id>LINES_READ</id>
          <enabled>Y</enabled>
          <name>LINES_READ</name>
        </field>
        <field>
          <id>LINES_WRITTEN</id>
          <enabled>Y</enabled>
          <name>LINES_WRITTEN</name>
        </field>
        <field>
          <id>LINES_UPDATED</id>
          <enabled>Y</enabled>
          <name>LINES_UPDATED</name>
        </field>
        <field>
          <id>LINES_INPUT</id>
          <enabled>Y</enabled>
          <name>LINES_INPUT</name>
        </field>
        <field>
          <id>LINES_OUTPUT</id>
          <enabled>Y</enabled>
          <name>LINES_OUTPUT</name>
        </field>
        <field>
          <id>LINES_REJECTED</id>
          <enabled>Y</enabled>
          <name>LINES_REJECTED</name>
        </field>
        <field>
          <id>ERRORS</id>
          <enabled>Y</enabled>
          <name>ERRORS</name>
        </field>
        <field>
          <id>INPUT_BUFFER_ROWS</id>
          <enabled>Y</enabled>
          <name>INPUT_BUFFER_ROWS</name>
        </field>
        <field>
          <id>OUTPUT_BUFFER_ROWS</id>
          <enabled>Y</enabled>
          <name>OUTPUT_BUFFER_ROWS</name>
        </field>
      </perf-log-table>
      <channel-log-table>
        <connection/>
        <schema/>
        <table/>
        <timeout_days/>
        <field>
          <id>ID_BATCH</id>
          <enabled>Y</enabled>
          <name>ID_BATCH</name>
        </field>
        <field>
          <id>CHANNEL_ID</id>
          <enabled>Y</enabled>
          <name>CHANNEL_ID</name>
        </field>
        <field>
          <id>LOG_DATE</id>
          <enabled>Y</enabled>
          <name>LOG_DATE</name>
        </field>
        <field>
          <id>LOGGING_OBJECT_TYPE</id>
          <enabled>Y</enabled>
          <name>LOGGING_OBJECT_TYPE</name>
        </field>
        <field>
          <id>OBJECT_NAME</id>
          <enabled>Y</enabled>
          <name>OBJECT_NAME</name>
        </field>
        <field>
          <id>OBJECT_COPY</id>
          <enabled>Y</enabled>
          <name>OBJECT_COPY</name>
        </field>
        <field>
          <id>REPOSITORY_DIRECTORY</id>
          <enabled>Y</enabled>
          <name>REPOSITORY_DIRECTORY</name>
        </field>
        <field>
          <id>FILENAME</id>
          <enabled>Y</enabled>
          <name>FILENAME</name>
        </field>
        <field>
          <id>OBJECT_ID</id>
          <enabled>Y</enabled>
          <name>OBJECT_ID</name>
        </field>
        <field>
          <id>OBJECT_REVISION</id>
          <enabled>Y</enabled>
          <name>OBJECT_REVISION</name>
        </field>
        <field>
          <id>PARENT_CHANNEL_ID</id>
          <enabled>Y</enabled>
          <name>PARENT_CHANNEL_ID</name>
        </field>
        <field>
          <id>ROOT_CHANNEL_ID</id>
          <enabled>Y</enabled>
          <name>ROOT_CHANNEL_ID</name>
        </field>
      </channel-log-table>
      <step-log-table>
        <connection/>
        <schema/>
        <table/>
        <timeout_days/>
        <field>
          <id>ID_BATCH</id>
          <enabled>Y</enabled>
          <name>ID_BATCH</name>
        </field>
        <field>
          <id>CHANNEL_ID</id>
          <enabled>Y</enabled>
          <name>CHANNEL_ID</name>
        </field>
        <field>
          <id>LOG_DATE</id>
          <enabled>Y</enabled>
          <name>LOG_DATE</name>
        </field>
        <field>
          <id>TRANSNAME</id>
          <enabled>Y</enabled>
          <name>TRANSNAME</name>
        </field>
        <field>
          <id>STEPNAME</id>
          <enabled>Y</enabled>
          <name>STEPNAME</name>
        </field>
        <field>
          <id>STEP_COPY</id>
          <enabled>Y</enabled>
          <name>STEP_COPY</name>
        </field>
        <field>
          <id>LINES_READ</id>
          <enabled>Y</enabled>
          <name>LINES_READ</name>
        </field>
        <field>
          <id>LINES_WRITTEN</id>
          <enabled>Y</enabled>
          <name>LINES_WRITTEN</name>
        </field>
        <field>
          <id>LINES_UPDATED</id>
          <enabled>Y</enabled>
          <name>LINES_UPDATED</name>
        </field>
        <field>
          <id>LINES_INPUT</id>
          <enabled>Y</enabled>
          <name>LINES_INPUT</name>
        </field>
        <field>
          <id>LINES_OUTPUT</id>
          <enabled>Y</enabled>
          <name>LINES_OUTPUT</name>
        </field>
        <field>
          <id>LINES_REJECTED</id>
          <enabled>Y</enabled>
          <name>LINES_REJECTED</name>
        </field>
        <field>
          <id>ERRORS</id>
          <enabled>Y</enabled>
          <name>ERRORS</name>
        </field>
        <field>
          <id>LOG_FIELD</id>
          <enabled>N</enabled>
          <name>LOG_FIELD</name>
        </field>
      </step-log-table>
      <metrics-log-table>
        <connection/>
        <schema/>
        <table/>
        <timeout_days/>
        <field>
          <id>ID_BATCH</id>
          <enabled>Y</enabled>
          <name>ID_BATCH</name>
        </field>
        <field>
          <id>CHANNEL_ID</id>
          <enabled>Y</enabled>
          <name>CHANNEL_ID</name>
        </field>
        <field>
          <id>LOG_DATE</id>
          <enabled>Y</enabled>
          <name>LOG_DATE</name>
        </field>
        <field>
          <id>METRICS_DATE</id>
          <enabled>Y</enabled>
          <name>METRICS_DATE</name>
        </field>
        <field>
          <id>METRICS_CODE</id>
          <enabled>Y</enabled>
          <name>METRICS_CODE</name>
        </field>
        <field>
          <id>METRICS_DESCRIPTION</id>
          <enabled>Y</enabled>
          <name>METRICS_DESCRIPTION</name>
        </field>
        <field>
          <id>METRICS_SUBJECT</id>
          <enabled>Y</enabled>
          <name>METRICS_SUBJECT</name>
        </field>
        <field>
          <id>METRICS_TYPE</id>
          <enabled>Y</enabled>
          <name>METRICS_TYPE</name>
        </field>
        <field>
          <id>METRICS_VALUE</id>
          <enabled>Y</enabled>
          <name>METRICS_VALUE</name>
        </field>
      </metrics-log-table>
    </log>
    <maxdate>
      <connection/>
      <table/>
      <field/>
      <offset>0.0</offset>
      <maxdiff>0.0</maxdiff>
    </maxdate>
    <size_rowset>10000</size_rowset>
    <sleep_time_empty>50</sleep_time_empty>
    <sleep_time_full>50</sleep_time_full>
    <unique_connections>N</unique_connections>
    <feedback_shown>Y</feedback_shown>
    <feedback_size>50000</feedback_size>
    <using_thread_priorities>Y</using_thread_priorities>
    <shared_objects_file/>
    <capture_step_performance>N</capture_step_performance>
    <step_performance_capturing_delay>1000</step_performance_capturing_delay>
    <step_performance_capturing_size_limit>100</step_performance_capturing_size_limit>
    <dependencies>
    </dependencies>
    <partitionschemas>
    </partitionschemas>
    <slaveservers>
      <slaveserver>
        <name>4Sight BI - PDI Server</name>
        <hostname>10.0.0.21</hostname>
        <port>9080</port>
        <webAppName>pentaho-di</webAppName>
        <username>joe</username>
        <password>Encrypted 2be98afc86aa7f2e4bb18bd63c99dbdde</password>
        <proxy_hostname/>
        <proxy_port/>
        <non_proxy_hosts/>
        <master>Y</master>
        <sslMode>N</sslMode>
      </slaveserver>
      <slaveserver>
        <name>Carte 1</name>
        <hostname>localhost</hostname>
        <port>9081</port>
        <webAppName/>
        <username>cluster</username>
        <password>Encrypted 2be98afc86aa7f2e4cb1aa265cd86aac8</password>
        <proxy_hostname/>
        <proxy_port/>
        <non_proxy_hosts/>
        <master>N</master>
        <sslMode>N</sslMode>
      </slaveserver>
      <slaveserver>
        <name>DI Server</name>
        <hostname>localhost</hostname>
        <port>9080</port>
        <webAppName>pentaho-di</webAppName>
        <username>joe</username>
        <password>Encrypted 2be98afc86aa7f2e4bb18bd63c99dbdde</password>
        <proxy_hostname/>
        <proxy_port/>
        <non_proxy_hosts/>
        <master>Y</master>
        <sslMode>N</sslMode>
      </slaveserver>
      <slaveserver>
        <name>MM_ETL_DEV</name>
        <hostname>magspentaho</hostname>
        <port>9080</port>
        <webAppName>pentaho-di</webAppName>
        <username>shota</username>
        <password>Encrypted 2be98afc86aa7f2e4cb79ce63d69dbbdb</password>
        <proxy_hostname/>
        <proxy_port/>
        <non_proxy_hosts/>
        <master>Y</master>
        <sslMode>N</sslMode>
      </slaveserver>
      <slaveserver>
        <name>MM_ETL_SERVER</name>
        <hostname>http://magspentaho</hostname>
        <port>9080</port>
        <webAppName>pentaho-di</webAppName>
        <username>shota</username>
        <password>Encrypted 2be98afc86aa7f2e4cb79ce63d69dbbdb</password>
        <proxy_hostname/>
        <proxy_port/>
        <non_proxy_hosts/>
        <master>Y</master>
        <sslMode>N</sslMode>
      </slaveserver>
      <slaveserver>
        <name>MM_ETL_TEST</name>
        <hostname>magspentahotest</hostname>
        <port>9080</port>
        <webAppName>pentaho-di</webAppName>
        <username>admin</username>
        <password>Encrypted 2be98afc86aa7f2e4bb18bd63c99dbdde</password>
        <proxy_hostname/>
        <proxy_port/>
        <non_proxy_hosts/>
        <master>N</master>
        <sslMode>N</sslMode>
      </slaveserver>
      <slaveserver>
        <name>MM_PENTAHO</name>
        <hostname>magspentaho</hostname>
        <port>9080</port>
        <webAppName>pentaho-di</webAppName>
        <username>admin</username>
        <password>Encrypted 2be98afc86aa7f2e4bb18bd63c99dbdde</password>
        <proxy_hostname/>
        <proxy_port/>
        <non_proxy_hosts/>
        <master>N</master>
        <sslMode>N</sslMode>
      </slaveserver>
      <slaveserver>
        <name>MM_PENTAHO_BTS</name>
        <hostname>129.144.25.104</hostname>
        <port>9080</port>
        <webAppName>pentaho-di</webAppName>
        <username>admin</username>
        <password>Encrypted 2be98afc86aa7f2e4bb18bd63c99dbdde</password>
        <proxy_hostname/>
        <proxy_port/>
        <non_proxy_hosts/>
        <master>N</master>
        <sslMode>N</sslMode>
      </slaveserver>
      <slaveserver>
        <name>MM_PENTAHO_DEV</name>
        <hostname>magspentahodev</hostname>
        <port>9080</port>
        <webAppName>pentaho-di</webAppName>
        <username>admin</username>
        <password>Encrypted 2be98afc86aa7f2e4bb18bd63c99dbdde</password>
        <proxy_hostname/>
        <proxy_port/>
        <non_proxy_hosts/>
        <master>Y</master>
        <sslMode>N</sslMode>
      </slaveserver>
      <slaveserver>
        <name>Master</name>
        <hostname>localhost</hostname>
        <port>8081</port>
        <webAppName/>
        <username>cluster</username>
        <password>Encrypted 2be98afc86aa7f2e4cb1aa265cd86aac8</password>
        <proxy_hostname/>
        <proxy_port/>
        <non_proxy_hosts/>
        <master>Y</master>
        <sslMode>N</sslMode>
      </slaveserver>
      <slaveserver>
        <name>SERVER1</name>
        <hostname>LOCALHOST</hostname>
        <port>3306</port>
        <webAppName/>
        <username>root</username>
        <password>Encrypted 2be98afc86aa7f2e4bb18bd63c99dbdde</password>
        <proxy_hostname/>
        <proxy_port/>
        <non_proxy_hosts/>
        <master>Y</master>
        <sslMode>N</sslMode>
      </slaveserver>
      <slaveserver>
        <name>SLAVE ONE</name>
        <hostname>192.168.2.101</hostname>
        <port>3306</port>
        <webAppName/>
        <username>root</username>
        <password>Encrypted 2be98afc86aa7f2e4a418bd63c99dbdde</password>
        <proxy_hostname/>
        <proxy_port/>
        <non_proxy_hosts/>
        <master>Y</master>
        <sslMode>N</sslMode>
      </slaveserver>
      <slaveserver>
        <name>SLAVE TWO</name>
        <hostname>192.168.2.101</hostname>
        <port>3306</port>
        <webAppName/>
        <username>root</username>
        <password>Encrypted 2be98afc86aa7f2e4bb18bd63c99dbdde</password>
        <proxy_hostname/>
        <proxy_port/>
        <non_proxy_hosts/>
        <master>N</master>
        <sslMode>N</sslMode>
      </slaveserver>
      <slaveserver>
        <name>Slave1</name>
        <hostname>localhost</hostname>
        <port>8082</port>
        <webAppName/>
        <username>cluster</username>
        <password>Encrypted 2be98afc86aa7f2e4cb1aa265cd86aac8</password>
        <proxy_hostname/>
        <proxy_port/>
        <non_proxy_hosts/>
        <master>N</master>
        <sslMode>N</sslMode>
      </slaveserver>
      <slaveserver>
        <name>Slave2</name>
        <hostname>localhost</hostname>
        <port>8083</port>
        <webAppName/>
        <username>cluster</username>
        <password>Encrypted 2be98afc86aa7f2e4cb1aa265cd86aac8</password>
        <proxy_hostname/>
        <proxy_port/>
        <non_proxy_hosts/>
        <master>N</master>
        <sslMode>N</sslMode>
      </slaveserver>
      <slaveserver>
        <name>Slave3</name>
        <hostname>localhost</hostname>
        <port>8084</port>
        <webAppName/>
        <username>cluster</username>
        <password>Encrypted 2be98afc86aa7f2e4cb1aa265cd86aac8</password>
        <proxy_hostname/>
        <proxy_port/>
        <non_proxy_hosts/>
        <master>N</master>
        <sslMode>N</sslMode>
      </slaveserver>
      <slaveserver>
        <name>local DIS</name>
        <hostname>localhost</hostname>
        <port>9080</port>
        <webAppName>pentaho-di</webAppName>
        <username>admin</username>
        <password>Encrypted 2be98afc86aa7f2e4bb18bd63c99dbdde</password>
        <proxy_hostname/>
        <proxy_port/>
        <non_proxy_hosts/>
        <master>N</master>
        <sslMode>N</sslMode>
      </slaveserver>
      <slaveserver>
        <name>magspentahodev</name>
        <hostname>magspentahodev</hostname>
        <port>9080</port>
        <webAppName>pentaho-di</webAppName>
        <username>admin</username>
        <password>Encrypted 2be98afc86aa7f2e4bb18bd63c99dbdde</password>
        <proxy_hostname/>
        <proxy_port/>
        <non_proxy_hosts/>
        <master>Y</master>
        <sslMode>N</sslMode>
      </slaveserver>
    </slaveservers>
    <clusterschemas>
      <clusterschema>
        <name>4sbi_admin</name>
        <base_port>40000</base_port>
        <sockets_buffer_size>2000</sockets_buffer_size>
        <sockets_flush_interval>5000</sockets_flush_interval>
        <sockets_compressed>Y</sockets_compressed>
        <dynamic>N</dynamic>
        <slaveservers>
        </slaveservers>
      </clusterschema>
      <clusterschema>
        <name>ClusterSchema</name>
        <base_port>40000</base_port>
        <sockets_buffer_size>2000</sockets_buffer_size>
        <sockets_flush_interval>5000</sockets_flush_interval>
        <sockets_compressed>Y</sockets_compressed>
        <dynamic>N</dynamic>
        <slaveservers>
          <name>Slave3</name>
          <name>Slave2</name>
          <name>Slave1</name>
          <name>Master</name>
        </slaveservers>
      </clusterschema>
      <clusterschema>
        <name>cluster A</name>
        <base_port>40000</base_port>
        <sockets_buffer_size>2000</sockets_buffer_size>
        <sockets_flush_interval>5000</sockets_flush_interval>
        <sockets_compressed>Y</sockets_compressed>
        <dynamic>N</dynamic>
        <slaveservers>
          <name>Carte 1</name>
          <name>local DIS</name>
        </slaveservers>
      </clusterschema>
    </clusterschemas>
    <created_user>-</created_user>
    <created_date>2017/05/15 11:42:50.077</created_date>
    <modified_user>admin</modified_user>
    <modified_date>2018/11/04 01:50:43.804</modified_date>
    <key_for_session_key/>
    <is_key_private>N</is_key_private>
  </info>
  <notepads>
  </notepads>
  <order>
    <hop>
      <from>Select values 1</from>
      <to>Table output 1</to>
      <enabled>Y</enabled>
    </hop>
    <hop>
      <from>Merge Join 2</from>
      <to>Select values 1</to>
      <enabled>Y</enabled>
    </hop>
    <hop>
      <from>Calculator </from>
      <to>FR: Filter 1st of MTH</to>
      <enabled>Y</enabled>
    </hop>
    <hop>
      <from>Dummy  True</from>
      <to>Select values </to>
      <enabled>Y</enabled>
    </hop>
    <hop>
      <from>Get System Info 2</from>
      <to>Calculator </to>
      <enabled>Y</enabled>
    </hop>
    <hop>
      <from>FR: Filter 1st of MTH</from>
      <to>Dummy False</to>
      <enabled>Y</enabled>
    </hop>
    <hop>
      <from>FR: Filter 1st of MTH</from>
      <to>Dummy  True</to>
      <enabled>Y</enabled>
    </hop>
    <hop>
      <from>VFACT_CLAIM_OSR</from>
      <to>Merge Join 2</to>
      <enabled>Y</enabled>
    </hop>
    <hop>
      <from>Execute SQL script</from>
      <to>VFACT_CLAIM_OSR</to>
      <enabled>Y</enabled>
    </hop>
    <hop>
      <from>CLAIMs_mart</from>
      <to>Merge Join 2</to>
      <enabled>Y</enabled>
    </hop>
    <hop>
      <from>Select values </from>
      <to>Execute SQL script</to>
      <enabled>Y</enabled>
    </hop>
  </order>
  <step>
    <name>CLAIMs_mart</name>
    <type>TableInput</type>
    <description/>
    <distribute>Y</distribute>
    <custom_distribution/>
    <copies>1</copies>
    <partitioning>
      <method>none</method>
      <schema_name/>
    </partitioning>
    <connection>magstage_DRABPRD</connection>
    <sql>SELECT M.MONTH_ID,
       M.CLAIM_NO,
       max(M.COMP_NAME) AS ISSUE_COMPANY,
       max(M.LOB) AS CM_LOB_CODE,
       max(M.POL_MASTERSTATE) AS PRACTICE_STATE_CODE,
       max(M.ADJ_FORMATTED_NAME) AS EXAMINER,
       max(M.MMCLM_CLAIM_STATUS_DATE) AS CLAIM_STATUS_DATE,
       max(M.Mmclm_Claim_Type_Date) AS CLAIM_TYPE_DATE,
       max(M.ACCIDENT_STATE) AS ACCIDENT_STATE
FROM CLAIMS_DATA_MART M
--WHERE M.LOB IS NOT NULL
--WHERE YEAR IN('2016','2017')
--AND M.CLAIM_NO='51180'
GROUP BY M.MONTH_ID,M.CLAIM_NO
ORDER BY M.MONTH_ID,M.CLAIM_NO
</sql>
    <limit>0</limit>
    <lookup/>
    <execute_each_row>N</execute_each_row>
    <variables_active>N</variables_active>
    <lazy_conversion_active>N</lazy_conversion_active>
    <cluster_schema/>
    <remotesteps>
      <input>
      </input>
      <output>
      </output>
    </remotesteps>
    <GUI>
      <xloc>1152</xloc>
      <yloc>128</yloc>
      <draw>Y</draw>
    </GUI>
  </step>
  <step>
    <name>Calculator </name>
    <type>Calculator</type>
    <description/>
    <distribute>Y</distribute>
    <custom_distribution/>
    <copies>1</copies>
    <partitioning>
      <method>none</method>
      <schema_name/>
    </partitioning>
    <calculation>
      <field_name>currentYear</field_name>
      <calc_type>YEAR_OF_DATE</calc_type>
      <field_a>firstDayOfCurrentMonth</field_a>
      <field_b/>
      <field_c/>
      <value_type>String</value_type>
      <value_length>4</value_length>
      <value_precision>-1</value_precision>
      <remove>Y</remove>
      <conversion_mask>####</conversion_mask>
      <decimal_symbol/>
      <grouping_symbol/>
      <currency_symbol/>
    </calculation>
    <calculation>
      <field_name>currentMonth</field_name>
      <calc_type>MONTH_OF_DATE</calc_type>
      <field_a>firstDayOfCurrentMonth</field_a>
      <field_b/>
      <field_c/>
      <value_type>Integer</value_type>
      <value_length>2</value_length>
      <value_precision>-1</value_precision>
      <remove>Y</remove>
      <conversion_mask>00</conversion_mask>
      <decimal_symbol/>
      <grouping_symbol/>
      <currency_symbol/>
    </calculation>
    <calculation>
      <field_name>firstDay</field_name>
      <calc_type>CONSTANT</calc_type>
      <field_a>01</field_a>
      <field_b/>
      <field_c/>
      <value_type>String</value_type>
      <value_length>2</value_length>
      <value_precision>-1</value_precision>
      <remove>N</remove>
      <conversion_mask>##</conversion_mask>
      <decimal_symbol/>
      <grouping_symbol/>
      <currency_symbol/>
    </calculation>
    <calculation>
      <field_name>filterYearMonthCurrent</field_name>
      <calc_type>ADD</calc_type>
      <field_a>currentYear</field_a>
      <field_b>currentMonth</field_b>
      <field_c/>
      <value_type>String</value_type>
      <value_length>6</value_length>
      <value_precision>-1</value_precision>
      <remove>N</remove>
      <conversion_mask>########</conversion_mask>
      <decimal_symbol/>
      <grouping_symbol/>
      <currency_symbol/>
    </calculation>
    <calculation>
      <field_name>previousYear</field_name>
      <calc_type>YEAR_OF_DATE</calc_type>
      <field_a>firstDayOfLastMonth</field_a>
      <field_b/>
      <field_c/>
      <value_type>String</value_type>
      <value_length>4</value_length>
      <value_precision>-1</value_precision>
      <remove>Y</remove>
      <conversion_mask>####</conversion_mask>
      <decimal_symbol/>
      <grouping_symbol/>
      <currency_symbol/>
    </calculation>
    <calculation>
      <field_name>previousMonth</field_name>
      <calc_type>MONTH_OF_DATE</calc_type>
      <field_a>firstDayOfLastMonth</field_a>
      <field_b/>
      <field_c/>
      <value_type>Integer</value_type>
      <value_length>2</value_length>
      <value_precision>-1</value_precision>
      <remove>Y</remove>
      <conversion_mask>00</conversion_mask>
      <decimal_symbol/>
      <grouping_symbol/>
      <currency_symbol/>
    </calculation>
    <calculation>
      <field_name>filterYearMonthPrevious</field_name>
      <calc_type>ADD</calc_type>
      <field_a>previousYear</field_a>
      <field_b>previousMonth</field_b>
      <field_c/>
      <value_type>String</value_type>
      <value_length>6</value_length>
      <value_precision>-1</value_precision>
      <remove>N</remove>
      <conversion_mask>######</conversion_mask>
      <decimal_symbol/>
      <grouping_symbol/>
      <currency_symbol/>
    </calculation>
    <calculation>
      <field_name>currentDay</field_name>
      <calc_type>DAY_OF_MONTH</calc_type>
      <field_a>currentDate</field_a>
      <field_b/>
      <field_c/>
      <value_type>Integer</value_type>
      <value_length>-1</value_length>
      <value_precision>-1</value_precision>
      <remove>N</remove>
      <conversion_mask>#</conversion_mask>
      <decimal_symbol/>
      <grouping_symbol/>
      <currency_symbol/>
    </calculation>
    <cluster_schema/>
    <remotesteps>
      <input>
      </input>
      <output>
      </output>
    </remotesteps>
    <GUI>
      <xloc>240</xloc>
      <yloc>144</yloc>
      <draw>Y</draw>
    </GUI>
  </step>
  <step>
    <name>Dummy  True</name>
    <type>Dummy</type>
    <description/>
    <distribute>Y</distribute>
    <custom_distribution/>
    <copies>1</copies>
    <partitioning>
      <method>none</method>
      <schema_name/>
    </partitioning>
    <cluster_schema/>
    <remotesteps>
      <input>
      </input>
      <output>
      </output>
    </remotesteps>
    <GUI>
      <xloc>544</xloc>
      <yloc>160</yloc>
      <draw>Y</draw>
    </GUI>
  </step>
  <step>
    <name>Dummy False</name>
    <type>Dummy</type>
    <description/>
    <distribute>Y</distribute>
    <custom_distribution/>
    <copies>1</copies>
    <partitioning>
      <method>none</method>
      <schema_name/>
    </partitioning>
    <cluster_schema/>
    <remotesteps>
      <input>
      </input>
      <output>
      </output>
    </remotesteps>
    <GUI>
      <xloc>400</xloc>
      <yloc>384</yloc>
      <draw>Y</draw>
    </GUI>
  </step>
  <step>
    <name>Execute SQL script</name>
    <type>ExecSQL</type>
    <description/>
    <distribute>Y</distribute>
    <custom_distribution/>
    <copies>1</copies>
    <partitioning>
      <method>none</method>
      <schema_name/>
    </partitioning>
    <connection>magstage_DRABPRD</connection>
    <execute_each_row>Y</execute_each_row>
    <single_statement>N</single_statement>
    <replace_variables>Y</replace_variables>
    <quoteString>N</quoteString>
    <sql>DELETE CLAIMSUMMARY_WITH_PK WHERE AS_OF=?

</sql>
    <set_params>N</set_params>
    <insert_field/>
    <update_field/>
    <delete_field/>
    <read_field/>
    <arguments>
      <argument>
        <name>AsOf</name>
      </argument>
    </arguments>
    <cluster_schema/>
    <remotesteps>
      <input>
      </input>
      <output>
      </output>
    </remotesteps>
    <GUI>
      <xloc>816</xloc>
      <yloc>144</yloc>
      <draw>Y</draw>
    </GUI>
  </step>
  <step>
    <name>FR: Filter 1st of MTH</name>
    <type>FilterRows</type>
    <description/>
    <distribute>Y</distribute>
    <custom_distribution/>
    <copies>1</copies>
    <partitioning>
      <method>none</method>
      <schema_name/>
    </partitioning>
    <send_true_to>Dummy False</send_true_to>
    <send_false_to>Dummy  True</send_false_to>
    <compare>
      <condition>
        <negated>N</negated>
        <leftvalue>currentDay</leftvalue>
        <function>=</function>
        <rightvalue/>
        <value>
          <name>constant</name>
          <type>Integer</type>
          <text>1</text>
          <length>-1</length>
          <precision>0</precision>
          <isnull>N</isnull>
          <mask>#;-#</mask>
        </value>
      </condition>
    </compare>
    <cluster_schema/>
    <remotesteps>
      <input>
      </input>
      <output>
      </output>
    </remotesteps>
    <GUI>
      <xloc>400</xloc>
      <yloc>256</yloc>
      <draw>Y</draw>
    </GUI>
  </step>
  <step>
    <name>Get System Info 2</name>
    <type>SystemInfo</type>
    <description/>
    <distribute>N</distribute>
    <custom_distribution/>
    <copies>1</copies>
    <partitioning>
      <method>none</method>
      <schema_name/>
    </partitioning>
    <fields>
      <field>
        <name>firstDayOfCurrentMonth</name>
        <type>this month start</type>
      </field>
      <field>
        <name>firstDayOfLastMonth</name>
        <type>last month start</type>
      </field>
      <field>
        <name>currentDate</name>
        <type>system date (fixed)</type>
      </field>
    </fields>
    <cluster_schema/>
    <remotesteps>
      <input>
      </input>
      <output>
      </output>
    </remotesteps>
    <GUI>
      <xloc>80</xloc>
      <yloc>256</yloc>
      <draw>Y</draw>
    </GUI>
  </step>
  <step>
    <name>Merge Join 2</name>
    <type>MergeJoin</type>
    <description/>
    <distribute>Y</distribute>
    <custom_distribution/>
    <copies>1</copies>
    <partitioning>
      <method>none</method>
      <schema_name/>
    </partitioning>
    <join_type>INNER</join_type>
    <step1>CLAIMs_mart</step1>
    <step2>VFACT_CLAIM_OSR</step2>
    <keys_1>
      <key>MONTH_ID</key>
      <key>CLAIM_NO</key>
    </keys_1>
    <keys_2>
      <key>MONTH_ID</key>
      <key>CLAIM_NO</key>
    </keys_2>
    <cluster_schema/>
    <remotesteps>
      <input>
      </input>
      <output>
      </output>
    </remotesteps>
    <GUI>
      <xloc>1152</xloc>
      <yloc>256</yloc>
      <draw>Y</draw>
    </GUI>
  </step>
  <step>
    <name>Select values </name>
    <type>SelectValues</type>
    <description/>
    <distribute>Y</distribute>
    <custom_distribution/>
    <copies>1</copies>
    <partitioning>
      <method>none</method>
      <schema_name/>
    </partitioning>
    <fields>
      <field>
        <name>filterYearMonthCurrent</name>
        <rename>AsOf</rename>
      </field>
      <select_unspecified>N</select_unspecified>
    </fields>
    <cluster_schema/>
    <remotesteps>
      <input>
      </input>
      <output>
      </output>
    </remotesteps>
    <GUI>
      <xloc>672</xloc>
      <yloc>256</yloc>
      <draw>Y</draw>
    </GUI>
  </step>
  <step>
    <name>Select values 1</name>
    <type>SelectValues</type>
    <description/>
    <distribute>Y</distribute>
    <custom_distribution/>
    <copies>1</copies>
    <partitioning>
      <method>none</method>
      <schema_name/>
    </partitioning>
    <fields>
      <field>
        <name>AS_OF</name>
      </field>
      <field>
        <name>CM_LOB_CODE</name>
      </field>
      <field>
        <name>PRACTICE_STATE_CODE</name>
      </field>
      <field>
        <name>EXAMINER</name>
      </field>
      <field>
        <name>ISSUE_COMPANY</name>
      </field>
      <field>
        <name>MULTILOSS_NO</name>
      </field>
      <field>
        <name>INDEMNITY_RESERVE</name>
      </field>
      <field>
        <name>INDEMNITY_PAID</name>
      </field>
      <field>
        <name>INDEMNITY_RECOVERY</name>
      </field>
      <field>
        <name>EXPENSE_RESERVE</name>
      </field>
      <field>
        <name>EXPENSE_PAID</name>
      </field>
      <field>
        <name>EXPENSE_RECOVERY</name>
      </field>
      <field>
        <name>INDEMNITY_RESERVE_YTD</name>
      </field>
      <field>
        <name>INDEMNITY_PAID_YTD</name>
      </field>
      <field>
        <name>INDEMNITY_RECOVERY_YTD</name>
      </field>
      <field>
        <name>EXPENSE_RESERVE_YTD</name>
      </field>
      <field>
        <name>EXPENSE_PAID_YTD</name>
      </field>
      <field>
        <name>EXPENSE_RECOVERY_YTD</name>
      </field>
      <field>
        <name>INDEMNITY_RESERVE_1M</name>
      </field>
      <field>
        <name>INDEMNITY_PAID_1M</name>
      </field>
      <field>
        <name>INDEMNITY_RECOVERY_1M</name>
      </field>
      <field>
        <name>EXPENSE_RESERVE_1M</name>
      </field>
      <field>
        <name>EXPENSE_PAID_1M</name>
      </field>
      <field>
        <name>EXPENSE_RECOVERY_1M</name>
      </field>
      <field>
        <name>COUNT_IND_ONLY</name>
      </field>
      <field>
        <name>COUNT_IND_ONLY_YTD</name>
      </field>
      <field>
        <name>COUNT_IND_ONLY_ITD</name>
      </field>
      <field>
        <name>COUNT_CLOSED_IND_LAE</name>
      </field>
      <field>
        <name>COUNT_CLOSED_IND_LAE_YTD</name>
      </field>
      <field>
        <name>COUNT_CLOSED_IND_LAE_ITD</name>
      </field>
      <field>
        <name>COUNT_CLOSED_LAE_ONLY</name>
      </field>
      <field>
        <name>COUNT_CLOSED_LAE_ONLY_YTD</name>
      </field>
      <field>
        <name>COUNT_CLOSED_LAE_ONLY_ITD</name>
      </field>
      <field>
        <name>COUNT_CLOSED_NO_PMT</name>
      </field>
      <field>
        <name>COUNT_CLOSED_NO_PMT_YTD</name>
      </field>
      <field>
        <name>COUNT_CLOSED_NO_PMT_ITD</name>
      </field>
      <field>
        <name>OPEN_SUSPENSE_MTD</name>
      </field>
      <field>
        <name>OPEN_SUSPENSE_YTD</name>
      </field>
      <field>
        <name>OPEN_SUSPENSE_ITD</name>
      </field>
      <field>
        <name>OPEN_CLAIMS_MTD</name>
      </field>
      <field>
        <name>OPEN_CLAIMS_YTD</name>
      </field>
      <field>
        <name>OPEN_CLAIMS_ITD</name>
      </field>
      <field>
        <name>REOPEN_CLAIMS_MTD</name>
      </field>
      <field>
        <name>REOPEN_CLAIMS_YTD</name>
      </field>
      <field>
        <name>REOPEN_CLAIMS_ITD</name>
      </field>
      <field>
        <name>OPEN_LAW_SUITS_MTD</name>
      </field>
      <field>
        <name>OPEN_LAW_SUITS_YTD</name>
      </field>
      <field>
        <name>OPEN_LAW_SUITS_ITD</name>
      </field>
      <field>
        <name>PENDING_LAW_SUITS_MTD</name>
      </field>
      <field>
        <name>PENDING_LAW_SUITS_YTD</name>
      </field>
      <field>
        <name>PENDING_LAW_SUITS_ITD</name>
      </field>
      <field>
        <name>CLAIM_PK_COUNT_MTD</name>
      </field>
      <field>
        <name>CLAIM_PK_COUNT_YTD</name>
      </field>
      <field>
        <name>TOTAL_CLOSED_MTD</name>
      </field>
      <field>
        <name>TOTAL_CLOSED_YTD</name>
      </field>
      <field>
        <name>TOTAL_CLOSED_ITD</name>
      </field>
      <field>
        <name>TOTAL_CASES_MTD</name>
      </field>
      <field>
        <name>TOTAL_CASES_YTD</name>
      </field>
      <field>
        <name>TOTAL_CASED_ITD</name>
      </field>
      <field>
        <name>TRANSFERS_OUT_MTD</name>
      </field>
      <field>
        <name>TRANSFERS_OUT_YTD</name>
      </field>
      <field>
        <name>TRANSFERS_OUT_ITD</name>
      </field>
      <field>
        <name>TRANSFERS_IN_MTD</name>
      </field>
      <field>
        <name>TRANSFERS_IN_YTD</name>
      </field>
      <field>
        <name>TRANSFERS_IN_ITD</name>
      </field>
      <field>
        <name>ADMIN_REOPENS_MTD</name>
      </field>
      <field>
        <name>ADMIN_REOPENS_YTD</name>
      </field>
      <field>
        <name>ADMIN_REOPENS_ITD</name>
      </field>
      <field>
        <name>CLAIM_STATUS_CODE</name>
      </field>
      <field>
        <name>CLAIM_TYPE_CODE</name>
      </field>
      <field>
        <name>CLAIM_PK</name>
      </field>
      <field>
        <name>MULTILOSS_COUNT</name>
      </field>
      <field>
        <name>CLAIM_NO</name>
      </field>
      <field>
        <name>CLAIM_CLOSED_FLAG</name>
      </field>
      <field>
        <name>CLAIM_NO_PMT_FLAG</name>
      </field>
      <field>
        <name>CLAIM_WITH_IND_FLAG</name>
      </field>
      <field>
        <name>CLAIM_PK_COUNT_ITD</name>
      </field>
      <field>
        <name>MULTILOSS_COUNT_YTD</name>
      </field>
      <field>
        <name>MULTILOSS_COUNT_ITD</name>
      </field>
      <field>
        <name>PAID_INDEMNITY_ON_CLOSED</name>
      </field>
      <field>
        <name>DEDUCTIBLE_LOSS_RECOVERY</name>
      </field>
      <field>
        <name>DEDUCTIBLE_EXPENSE</name>
      </field>
      <field>
        <name>PAID_EXPENSE_ON_CLOSED</name>
      </field>
      <field>
        <name>OPEN_ERROR_MTD</name>
      </field>
      <field>
        <name>OPEN_ERROR_YTD</name>
      </field>
      <field>
        <name>OPEN_ERROR_ITD</name>
      </field>
      <field>
        <name>OPEN_NOI_MTD</name>
      </field>
      <field>
        <name>OPEN_NOI_YTD</name>
      </field>
      <field>
        <name>OPEN_NOI_ITD</name>
      </field>
      <field>
        <name>PENDING_NOI_MTD</name>
      </field>
      <field>
        <name>PENDING_NOI_YTD</name>
      </field>
      <field>
        <name>PENDING_NOI_ITD</name>
      </field>
      <field>
        <name>OPENDATE_ID</name>
      </field>
      <field>
        <name>OPENDATE_ID_YEAR</name>
      </field>
      <field>
        <name>OPENDATE_ID_MNTH</name>
      </field>
      <field>
        <name>CLOSEDDATE_ID</name>
      </field>
      <field>
        <name>CLOSEDDATE_ID_YEAR</name>
      </field>
      <field>
        <name>CLOSEDDATE_ID_MNTH</name>
      </field>
      <field>
        <name>CLAIM_STATUS_DATE</name>
      </field>
      <field>
        <name>CLAIM_TYPE_DATE</name>
      </field>
      <field>
        <name>MAG_CLOSE_DATE</name>
      </field>
      <field>
        <name>MAG_OPEN_DATE</name>
      </field>
      <field>
        <name>MULTILOSS_COUNT_MTD</name>
      </field>
      <field>
        <name>ACCIDENT_STATE</name>
      </field>
      <select_unspecified>N</select_unspecified>
    </fields>
    <cluster_schema/>
    <remotesteps>
      <input>
      </input>
      <output>
      </output>
    </remotesteps>
    <GUI>
      <xloc>1344</xloc>
      <yloc>256</yloc>
      <draw>Y</draw>
    </GUI>
  </step>
  <step>
    <name>Table output 1</name>
    <type>TableOutput</type>
    <description/>
    <distribute>N</distribute>
    <custom_distribution/>
    <copies>1</copies>
    <partitioning>
      <method>none</method>
      <schema_name/>
    </partitioning>
    <connection>magstage_DRABPRD</connection>
    <schema>magstage</schema>
    <table>ClaimSummary_With_Pk</table>
    <commit>10000</commit>
    <truncate>N</truncate>
    <ignore_errors>N</ignore_errors>
    <use_batch>Y</use_batch>
    <specify_fields>Y</specify_fields>
    <partitioning_enabled>N</partitioning_enabled>
    <partitioning_field/>
    <partitioning_daily>N</partitioning_daily>
    <partitioning_monthly>Y</partitioning_monthly>
    <tablename_in_field>N</tablename_in_field>
    <tablename_field/>
    <tablename_in_table>Y</tablename_in_table>
    <return_keys>N</return_keys>
    <return_field/>
    <fields>
      <field>
        <column_name>AS_OF</column_name>
        <stream_name>AS_OF</stream_name>
      </field>
      <field>
        <column_name>CM_LOB_CODE</column_name>
        <stream_name>CM_LOB_CODE</stream_name>
      </field>
      <field>
        <column_name>PRACTICE_STATE_CODE</column_name>
        <stream_name>PRACTICE_STATE_CODE</stream_name>
      </field>
      <field>
        <column_name>EXAMINER</column_name>
        <stream_name>EXAMINER</stream_name>
      </field>
      <field>
        <column_name>ISSUE_COMPANY</column_name>
        <stream_name>ISSUE_COMPANY</stream_name>
      </field>
      <field>
        <column_name>MULTILOSS_NO</column_name>
        <stream_name>MULTILOSS_NO</stream_name>
      </field>
      <field>
        <column_name>INDEMNITY_RESERVE</column_name>
        <stream_name>INDEMNITY_RESERVE</stream_name>
      </field>
      <field>
        <column_name>INDEMNITY_PAID</column_name>
        <stream_name>INDEMNITY_PAID</stream_name>
      </field>
      <field>
        <column_name>INDEMNITY_RECOVERY</column_name>
        <stream_name>INDEMNITY_RECOVERY</stream_name>
      </field>
      <field>
        <column_name>EXPENSE_RESERVE</column_name>
        <stream_name>EXPENSE_RESERVE</stream_name>
      </field>
      <field>
        <column_name>EXPENSE_PAID</column_name>
        <stream_name>EXPENSE_PAID</stream_name>
      </field>
      <field>
        <column_name>EXPENSE_RECOVERY</column_name>
        <stream_name>EXPENSE_RECOVERY</stream_name>
      </field>
      <field>
        <column_name>INDEMNITY_RESERVE_YTD</column_name>
        <stream_name>INDEMNITY_RESERVE_YTD</stream_name>
      </field>
      <field>
        <column_name>INDEMNITY_PAID_YTD</column_name>
        <stream_name>INDEMNITY_PAID_YTD</stream_name>
      </field>
      <field>
        <column_name>INDEMNITY_RECOVERY_YTD</column_name>
        <stream_name>INDEMNITY_RECOVERY_YTD</stream_name>
      </field>
      <field>
        <column_name>EXPENSE_RESERVE_YTD</column_name>
        <stream_name>EXPENSE_RESERVE_YTD</stream_name>
      </field>
      <field>
        <column_name>EXPENSE_PAID_YTD</column_name>
        <stream_name>EXPENSE_PAID_YTD</stream_name>
      </field>
      <field>
        <column_name>EXPENSE_RECOVERY_YTD</column_name>
        <stream_name>EXPENSE_RECOVERY_YTD</stream_name>
      </field>
      <field>
        <column_name>INDEMNITY_RESERVE_1M</column_name>
        <stream_name>INDEMNITY_RESERVE_1M</stream_name>
      </field>
      <field>
        <column_name>INDEMNITY_PAID_1M</column_name>
        <stream_name>INDEMNITY_PAID_1M</stream_name>
      </field>
      <field>
        <column_name>INDEMNITY_RECOVERY_1M</column_name>
        <stream_name>INDEMNITY_RECOVERY_1M</stream_name>
      </field>
      <field>
        <column_name>EXPENSE_RESERVE_1M</column_name>
        <stream_name>EXPENSE_RESERVE_1M</stream_name>
      </field>
      <field>
        <column_name>EXPENSE_PAID_1M</column_name>
        <stream_name>EXPENSE_PAID_1M</stream_name>
      </field>
      <field>
        <column_name>EXPENSE_RECOVERY_1M</column_name>
        <stream_name>EXPENSE_RECOVERY_1M</stream_name>
      </field>
      <field>
        <column_name>COUNT_IND_ONLY</column_name>
        <stream_name>COUNT_IND_ONLY</stream_name>
      </field>
      <field>
        <column_name>COUNT_IND_ONLY_YTD</column_name>
        <stream_name>COUNT_IND_ONLY_YTD</stream_name>
      </field>
      <field>
        <column_name>COUNT_IND_ONLY_ITD</column_name>
        <stream_name>COUNT_IND_ONLY_ITD</stream_name>
      </field>
      <field>
        <column_name>COUNT_CLOSED_IND_LAE</column_name>
        <stream_name>COUNT_CLOSED_IND_LAE</stream_name>
      </field>
      <field>
        <column_name>COUNT_CLOSED_IND_LAE_YTD</column_name>
        <stream_name>COUNT_CLOSED_IND_LAE_YTD</stream_name>
      </field>
      <field>
        <column_name>COUNT_CLOSED_IND_LAE_ITD</column_name>
        <stream_name>COUNT_CLOSED_IND_LAE_ITD</stream_name>
      </field>
      <field>
        <column_name>COUNT_CLOSED_LAE_ONLY</column_name>
        <stream_name>COUNT_CLOSED_LAE_ONLY</stream_name>
      </field>
      <field>
        <column_name>COUNT_CLOSED_LAE_ONLY_YTD</column_name>
        <stream_name>COUNT_CLOSED_LAE_ONLY_YTD</stream_name>
      </field>
      <field>
        <column_name>COUNT_CLOSED_LAE_ONLY_ITD</column_name>
        <stream_name>COUNT_CLOSED_LAE_ONLY_ITD</stream_name>
      </field>
      <field>
        <column_name>COUNT_CLOSED_NO_PMT</column_name>
        <stream_name>COUNT_CLOSED_NO_PMT</stream_name>
      </field>
      <field>
        <column_name>COUNT_CLOSED_NO_PMT_YTD</column_name>
        <stream_name>COUNT_CLOSED_NO_PMT_YTD</stream_name>
      </field>
      <field>
        <column_name>COUNT_CLOSED_NO_PMT_ITD</column_name>
        <stream_name>COUNT_CLOSED_NO_PMT_ITD</stream_name>
      </field>
      <field>
        <column_name>OPEN_SUSPENSE_MTD</column_name>
        <stream_name>OPEN_SUSPENSE_MTD</stream_name>
      </field>
      <field>
        <column_name>OPEN_SUSPENSE_YTD</column_name>
        <stream_name>OPEN_SUSPENSE_YTD</stream_name>
      </field>
      <field>
        <column_name>OPEN_SUSPENSE_ITD</column_name>
        <stream_name>OPEN_SUSPENSE_ITD</stream_name>
      </field>
      <field>
        <column_name>OPEN_CLAIMS_MTD</column_name>
        <stream_name>OPEN_CLAIMS_MTD</stream_name>
      </field>
      <field>
        <column_name>OPEN_CLAIMS_YTD</column_name>
        <stream_name>OPEN_CLAIMS_YTD</stream_name>
      </field>
      <field>
        <column_name>OPEN_CLAIMS_ITD</column_name>
        <stream_name>OPEN_CLAIMS_ITD</stream_name>
      </field>
      <field>
        <column_name>REOPEN_CLAIMS_MTD</column_name>
        <stream_name>REOPEN_CLAIMS_MTD</stream_name>
      </field>
      <field>
        <column_name>REOPEN_CLAIMS_YTD</column_name>
        <stream_name>REOPEN_CLAIMS_YTD</stream_name>
      </field>
      <field>
        <column_name>REOPEN_CLAIMS_ITD</column_name>
        <stream_name>REOPEN_CLAIMS_ITD</stream_name>
      </field>
      <field>
        <column_name>OPEN_LAW_SUITS_MTD</column_name>
        <stream_name>OPEN_LAW_SUITS_MTD</stream_name>
      </field>
      <field>
        <column_name>OPEN_LAW_SUITS_YTD</column_name>
        <stream_name>OPEN_LAW_SUITS_YTD</stream_name>
      </field>
      <field>
        <column_name>OPEN_LAW_SUITS_ITD</column_name>
        <stream_name>OPEN_LAW_SUITS_ITD</stream_name>
      </field>
      <field>
        <column_name>PENDING_LAW_SUITS_MTD</column_name>
        <stream_name>PENDING_LAW_SUITS_MTD</stream_name>
      </field>
      <field>
        <column_name>PENDING_LAW_SUITS_YTD</column_name>
        <stream_name>PENDING_LAW_SUITS_YTD</stream_name>
      </field>
      <field>
        <column_name>PENDING_LAW_SUITS_ITD</column_name>
        <stream_name>PENDING_LAW_SUITS_ITD</stream_name>
      </field>
      <field>
        <column_name>CLAIM_PK_COUNT_MTD</column_name>
        <stream_name>CLAIM_PK_COUNT_MTD</stream_name>
      </field>
      <field>
        <column_name>CLAIM_PK_COUNT_YTD</column_name>
        <stream_name>CLAIM_PK_COUNT_YTD</stream_name>
      </field>
      <field>
        <column_name>TOTAL_CLOSED_MTD</column_name>
        <stream_name>TOTAL_CLOSED_MTD</stream_name>
      </field>
      <field>
        <column_name>TOTAL_CLOSED_YTD</column_name>
        <stream_name>TOTAL_CLOSED_YTD</stream_name>
      </field>
      <field>
        <column_name>TOTAL_CLOSED_ITD</column_name>
        <stream_name>TOTAL_CLOSED_ITD</stream_name>
      </field>
      <field>
        <column_name>TOTAL_CASES_MTD</column_name>
        <stream_name>TOTAL_CASES_MTD</stream_name>
      </field>
      <field>
        <column_name>TOTAL_CASES_YTD</column_name>
        <stream_name>TOTAL_CASES_YTD</stream_name>
      </field>
      <field>
        <column_name>TOTAL_CASED_ITD</column_name>
        <stream_name>TOTAL_CASED_ITD</stream_name>
      </field>
      <field>
        <column_name>TRANSFERS_OUT_MTD</column_name>
        <stream_name>TRANSFERS_OUT_MTD</stream_name>
      </field>
      <field>
        <column_name>TRANSFERS_OUT_YTD</column_name>
        <stream_name>TRANSFERS_OUT_YTD</stream_name>
      </field>
      <field>
        <column_name>TRANSFERS_OUT_ITD</column_name>
        <stream_name>TRANSFERS_OUT_ITD</stream_name>
      </field>
      <field>
        <column_name>TRANSFERS_IN_MTD</column_name>
        <stream_name>TRANSFERS_IN_MTD</stream_name>
      </field>
      <field>
        <column_name>TRANSFERS_IN_YTD</column_name>
        <stream_name>TRANSFERS_IN_YTD</stream_name>
      </field>
      <field>
        <column_name>TRANSFERS_IN_ITD</column_name>
        <stream_name>TRANSFERS_IN_ITD</stream_name>
      </field>
      <field>
        <column_name>ADMIN_REOPENS_MTD</column_name>
        <stream_name>ADMIN_REOPENS_MTD</stream_name>
      </field>
      <field>
        <column_name>ADMIN_REOPENS_YTD</column_name>
        <stream_name>ADMIN_REOPENS_YTD</stream_name>
      </field>
      <field>
        <column_name>ADMIN_REOPENS_ITD</column_name>
        <stream_name>ADMIN_REOPENS_ITD</stream_name>
      </field>
      <field>
        <column_name>CLAIM_STATUS_CODE</column_name>
        <stream_name>CLAIM_STATUS_CODE</stream_name>
      </field>
      <field>
        <column_name>CLAIM_TYPE_CODE</column_name>
        <stream_name>CLAIM_TYPE_CODE</stream_name>
      </field>
      <field>
        <column_name>CLAIM_PK</column_name>
        <stream_name>CLAIM_PK</stream_name>
      </field>
      <field>
        <column_name>MULTILOSS_COUNT</column_name>
        <stream_name>MULTILOSS_COUNT</stream_name>
      </field>
      <field>
        <column_name>CLAIM_NO</column_name>
        <stream_name>CLAIM_NO</stream_name>
      </field>
      <field>
        <column_name>CLAIM_CLOSED_FLAG</column_name>
        <stream_name>CLAIM_CLOSED_FLAG</stream_name>
      </field>
      <field>
        <column_name>CLAIM_NO_PMT_FLAG</column_name>
        <stream_name>CLAIM_NO_PMT_FLAG</stream_name>
      </field>
      <field>
        <column_name>CLAIM_WITH_IND_FLAG</column_name>
        <stream_name>CLAIM_WITH_IND_FLAG</stream_name>
      </field>
      <field>
        <column_name>CLAIM_PK_COUNT_ITD</column_name>
        <stream_name>CLAIM_PK_COUNT_ITD</stream_name>
      </field>
      <field>
        <column_name>MULTILOSS_COUNT_YTD</column_name>
        <stream_name>MULTILOSS_COUNT_YTD</stream_name>
      </field>
      <field>
        <column_name>MULTILOSS_COUNT_ITD</column_name>
        <stream_name>MULTILOSS_COUNT_ITD</stream_name>
      </field>
      <field>
        <column_name>PAID_INDEMNITY_ON_CLOSED</column_name>
        <stream_name>PAID_INDEMNITY_ON_CLOSED</stream_name>
      </field>
      <field>
        <column_name>DEDUCTIBLE_LOSS_RECOVERY</column_name>
        <stream_name>DEDUCTIBLE_LOSS_RECOVERY</stream_name>
      </field>
      <field>
        <column_name>DEDUCTIBLE_EXPENSE</column_name>
        <stream_name>DEDUCTIBLE_EXPENSE</stream_name>
      </field>
      <field>
        <column_name>PAID_EXPENSE_ON_CLOSED</column_name>
        <stream_name>PAID_EXPENSE_ON_CLOSED</stream_name>
      </field>
      <field>
        <column_name>OPEN_ERROR_MTD</column_name>
        <stream_name>OPEN_ERROR_MTD</stream_name>
      </field>
      <field>
        <column_name>OPEN_ERROR_YTD</column_name>
        <stream_name>OPEN_ERROR_YTD</stream_name>
      </field>
      <field>
        <column_name>OPEN_ERROR_ITD</column_name>
        <stream_name>OPEN_ERROR_ITD</stream_name>
      </field>
      <field>
        <column_name>OPEN_NOI_MTD</column_name>
        <stream_name>OPEN_NOI_MTD</stream_name>
      </field>
      <field>
        <column_name>OPEN_NOI_YTD</column_name>
        <stream_name>OPEN_NOI_YTD</stream_name>
      </field>
      <field>
        <column_name>OPEN_NOI_ITD</column_name>
        <stream_name>OPEN_NOI_ITD</stream_name>
      </field>
      <field>
        <column_name>PENDING_NOI_MTD</column_name>
        <stream_name>PENDING_NOI_MTD</stream_name>
      </field>
      <field>
        <column_name>PENDING_NOI_YTD</column_name>
        <stream_name>PENDING_NOI_YTD</stream_name>
      </field>
      <field>
        <column_name>PENDING_NOI_ITD</column_name>
        <stream_name>PENDING_NOI_ITD</stream_name>
      </field>
      <field>
        <column_name>OPENDATE_ID</column_name>
        <stream_name>OPENDATE_ID</stream_name>
      </field>
      <field>
        <column_name>OPENDATE_ID_YEAR</column_name>
        <stream_name>OPENDATE_ID_YEAR</stream_name>
      </field>
      <field>
        <column_name>OPENDATE_ID_MNTH</column_name>
        <stream_name>OPENDATE_ID_MNTH</stream_name>
      </field>
      <field>
        <column_name>CLOSEDDATE_ID</column_name>
        <stream_name>CLOSEDDATE_ID</stream_name>
      </field>
      <field>
        <column_name>CLOSEDDATE_ID_YEAR</column_name>
        <stream_name>CLOSEDDATE_ID_YEAR</stream_name>
      </field>
      <field>
        <column_name>CLOSEDDATE_ID_MNTH</column_name>
        <stream_name>CLOSEDDATE_ID_MNTH</stream_name>
      </field>
      <field>
        <column_name>CLAIM_STATUS_DATE</column_name>
        <stream_name>CLAIM_STATUS_DATE</stream_name>
      </field>
      <field>
        <column_name>CLAIM_TYPE_DATE</column_name>
        <stream_name>CLAIM_TYPE_DATE</stream_name>
      </field>
      <field>
        <column_name>MAG_CLOSE_DATE</column_name>
        <stream_name>MAG_CLOSE_DATE</stream_name>
      </field>
      <field>
        <column_name>MAG_OPEN_DATE</column_name>
        <stream_name>MAG_OPEN_DATE</stream_name>
      </field>
      <field>
        <column_name>MULTILOSS_COUNT_MTD</column_name>
        <stream_name>MULTILOSS_COUNT_MTD</stream_name>
      </field>
      <field>
        <column_name>ACCIDENT_STATE</column_name>
        <stream_name>ACCIDENT_STATE</stream_name>
      </field>
    </fields>
    <cluster_schema/>
    <remotesteps>
      <input>
      </input>
      <output>
      </output>
    </remotesteps>
    <GUI>
      <xloc>1344</xloc>
      <yloc>480</yloc>
      <draw>Y</draw>
    </GUI>
  </step>
  <step>
    <name>VFACT_CLAIM_OSR</name>
    <type>TableInput</type>
    <description/>
    <distribute>Y</distribute>
    <custom_distribution/>
    <copies>1</copies>
    <partitioning>
      <method>none</method>
      <schema_name/>
    </partitioning>
    <connection>DRABPRD</connection>
    <sql>
Select
  TO_NUMBER(SUBSTR(VF.MONTH_ID,1,6)) AS AS_OF
, SUBSTR(TO_CHAR(VF.MONTH_ID),1,4) AS YEAR
, SUBSTR(TO_CHAR(VF.MONTH_ID),5,2) AS MONTH
, MONTH_ID
--, DPO.POL_MASTERSTATE AS PRACTICE_STATE_CODE
, VDS.CLMST_STATUSCD
, VF.CLOSEDDATE_ID
, VF.CLAIM_NUMBER AS CLAIM_NO
, VDC.CLM_GROUPNUMBER AS MULTILOSS_NO
--, VDC.COMP_NAME AS ISSUE_COMPANY
, VF.USR_DEF_SUM8 AS EXPENSE_RECOVERY_1M
, VF.USR_DEF_SUM14 AS INDEMNITY_RECOVERY_1M
, VF.USR_DEF_SUM8_YTD AS EXPENSE_RECOVERY_YTD
, VF.USR_DEF_SUM14_YTD AS INDEMNITY_RECOVERY_YTD
, VF.USR_DEF_SUM8_ITD  AS EXPENSE_RECOVERY
, VF.USR_DEF_SUM14_ITD AS INDEMNITY_RECOVERY 
, VF.net_indemnity_paid_mtd  AS INDEMNITY_PAID_1M
, VF.net_indemnity_paid_ytd  AS INDEMNITY_PAID_YTD
, VF.net_indemnity_paid_itd AS INDEMNITY_PAID
, VF.net_expense_paid_mtd   AS EXPENSE_PAID_1M 
, VF.net_expense_paid_ytd    AS EXPENSE_PAID_YTD
, VF.net_expense_paid_itd   AS EXPENSE_PAID
--, MMCLM_CLAIM_STATUS_DATE AS CLAIM_STATUS_DATE
--, ACCIDENT_STATE
--, ACCIDENT_COUNTY
--, CLAIM_NUMBER
, VF.LOSS_OSD_RSRV_CHNG_AMT AS INDEMNITY_RESERVE_1M
, VF.LOSS_OSD_RSRV_CHNG_YTD AS INDEMNITY_RESERVE_YTD 
, VF.LOSS_OSD_RSRV_CHNG_ITD AS INDEMNITY_RESERVE
, VF.EXP_OSD_RSRV_CHNG_AMT  AS EXPENSE_RESERVE_1M
, VF.EXP_OSD_RSRV_CHNG_YTD  AS EXPENSE_RESERVE_YTD
, VF.EXP_OSD_RSRV_CHNG_ITD  AS EXPENSE_RESERVE 
--, ADJ.ADJ_FORMATTED_NAME AS EXAMINER
--Closed Indemnity Only
,CASE WHEN VF.NET_INDEMNITY_PAID_ITD > 0 AND VF.NET_EXPENSE_PAID_ITD = 0 AND to_char(VF.MAG_CLOSE_DATE,'YYYY') =SUBSTR(TO_CHAR(VF.MONTH_ID),1,4)AND to_char(VF.MAG_CLOSE_DATE,'MM') =SUBSTR(TO_CHAR(VF.MONTH_ID),5,2) AND VDS.CLMST_STATUSCD NOT IN('OPENERROR')
THEN 1 ELSE 0 END AS COUNT_IND_ONLY
,CASE WHEN VF.NET_INDEMNITY_PAID_ITD > 0 AND VF.NET_EXPENSE_PAID_ITD = 0 AND to_char(VF.MAG_CLOSE_DATE,'YYYY') =SUBSTR(TO_CHAR(VF.MONTH_ID),1,4) AND VDS.CLMST_STATUSCD NOT IN('OPENERROR')
THEN 1 ELSE 0 END AS COUNT_IND_ONLY_YTD
,CASE WHEN VF.NET_INDEMNITY_PAID_ITD > 0 AND VF.NET_EXPENSE_PAID_ITD = 0 AND to_char(VF.MAG_CLOSE_DATE,'MM/DD/YYYY') &lt;&gt; '01/01/1900' AND VDS.CLMST_STATUSCD NOT IN('OPENERROR')
THEN 1 ELSE 0 END AS COUNT_IND_ONLY_ITD

--Close Indemnity/LAE
,CASE WHEN VF.NET_INDEMNITY_PAID_ITD > 0 AND VF.NET_EXPENSE_PAID_MTD > 0  AND to_char(VF.MAG_CLOSE_DATE,'YYYY') =SUBSTR(TO_CHAR(VF.MONTH_ID),1,4)AND to_char(VF.MAG_CLOSE_DATE,'MM') =SUBSTR(TO_CHAR(VF.MONTH_ID),5,2) AND VDS.CLMST_STATUSCD NOT IN('OPENERROR')
THEN 1 ELSE 0 END AS COUNT_CLOSED_IND_LAE
,CASE WHEN VF.NET_INDEMNITY_PAID_ITD > 0 AND VF.NET_EXPENSE_PAID_YTD > 0 AND to_char(VF.MAG_CLOSE_DATE,'YYYY') =SUBSTR(TO_CHAR(VF.MONTH_ID),1,4) AND VDS.CLMST_STATUSCD NOT IN('OPENERROR')
THEN 1 ELSE 0 END AS COUNT_CLOSED_IND_LAE_YTD
,CASE WHEN VF.NET_INDEMNITY_PAID_ITD > 0 AND VF.NET_EXPENSE_PAID_ITD > 0 AND to_char(VF.MAG_CLOSE_DATE,'MM/DD/YYYY') &lt;&gt; '01/01/1900' AND VDS.CLMST_STATUSCD NOT IN('OPENERROR')
THEN 1 ELSE 0 END AS COUNT_CLOSED_IND_LAE_ITD

--Closed LAE Only
,CASE WHEN to_char(VF.MAG_CLOSE_DATE,'YYYY')=SUBSTR(TO_CHAR(VF.MONTH_ID),1,4) AND to_char(VF.MAG_CLOSE_DATE,'MM')=SUBSTR(TO_CHAR(VF.MONTH_ID),5,2) AND CLAIM_CLOSED_WITH_EXPONLY_FLAG='1'AND VDS.CLMST_STATUSCD NOT IN('OPENERROR')
THEN 1 ELSE 0 END AS COUNT_CLOSED_LAE_ONLY
,CASE WHEN to_char(VF.MAG_CLOSE_DATE,'YYYY')=SUBSTR(TO_CHAR(VF.MONTH_ID),1,4) AND CLAIM_CLOSED_WITH_EXPONLY_FLAG='1' AND VDS.CLMST_STATUSCD NOT IN('OPENERROR')
THEN 1 ELSE 0 END AS COUNT_CLOSED_LAE_ONLY_YTD
,CASE WHEN to_char(VF.MAG_CLOSE_DATE,'MM/DD/YYYY') &lt;&gt; '01/01/1900' AND CLAIM_CLOSED_WITH_EXPONLY_FLAG='1' AND VDS.CLMST_STATUSCD NOT IN('OPENERROR')
THEN 1 ELSE 0 END AS COUNT_CLOSED_LAE_ONLY_ITD

--Closed No Payment

,CASE WHEN VF.NET_EXPENSE_PAID_ITD = 0 AND VF.NET_INDEMNITY_PAID_ITD = 0 AND to_char(VF.MAG_CLOSE_DATE,'YYYY') =SUBSTR(TO_CHAR(VF.MONTH_ID),1,4)AND to_char(VF.MAG_CLOSE_DATE,'MM') =SUBSTR(TO_CHAR(VF.MONTH_ID),5,2) AND VDS.CLMST_STATUSCD NOT IN('OPENERROR')
THEN 1 ELSE 0 END AS COUNT_CLOSED_NO_PMT
,CASE WHEN VF.NET_EXPENSE_PAID_ITD = 0 AND VF.NET_INDEMNITY_PAID_ITD = 0 AND to_char(VF.MAG_CLOSE_DATE,'YYYY') =SUBSTR(TO_CHAR(VF.MONTH_ID),1,4) AND VDS.CLMST_STATUSCD NOT IN('OPENERROR')
THEN 1 ELSE 0 END AS COUNT_CLOSED_NO_PMT_YTD
,CASE WHEN VF.NET_EXPENSE_PAID_ITD = 0 AND VF.NET_INDEMNITY_PAID_ITD = 0 AND to_char(VF.MAG_CLOSE_DATE,'YYYY/MM/DD') &lt;&gt; '1900/01/01' AND VDS.CLMST_STATUSCD NOT IN('OPENERROR')
THEN 1 ELSE 0 END AS COUNT_CLOSED_NO_PMT_ITD

--Open Suspense

,CASE WHEN  VDS.CLMST_STATUSCD NOT IN('OPENERROR') AND DCT.CTYP_CODE IN('SUSPENSE')  AND to_char(VF.MAG_SUSPENSE_DATE,'YYYY') =SUBSTR(TO_CHAR(VF.MONTH_ID),1,4)AND to_char(VF.MAG_SUSPENSE_DATE,'MM') =SUBSTR(TO_CHAR(VF.MONTH_ID),5,2)
--and to_char(VF.MAG_SUSPENSE_DATE,'YYYYMM') &lt;&gt; to_char(VF.MAG_OPEN_DATE,'YYYYMM')  
THEN 1 ELSE 0 END AS OPEN_SUSPENSE_MTD
,CASE WHEN  VDS.CLMST_STATUSCD NOT IN('OPENERROR') AND DCT.CTYP_CODE IN('SUSPENSE') AND to_char(VF.MAG_SUSPENSE_DATE,'YYYY') =SUBSTR(TO_CHAR(VF.MONTH_ID),1,4)
--and to_char(VF.MAG_SUSPENSE_DATE,'YYYYMM') &lt;&gt; to_char(VF.MAG_OPEN_DATE,'YYYYMM')  
THEN 1 ELSE 0 END AS OPEN_SUSPENSE_YTD
,CASE WHEN  VDS.CLMST_STATUSCD NOT IN('OPENERROR') AND DCT.CTYP_CODE IN('SUSPENSE') AND to_char(VF.MAG_SUSPENSE_DATE,'YYYY/MM/DD') &lt;&gt; '1900/01/01'
--and to_char(VF.MAG_SUSPENSE_DATE,'YYYYMM') &lt;&gt; to_char(VF.MAG_OPEN_DATE,'YYYYMM')  
THEN 1 ELSE 0 END AS OPEN_SUSPENSE_ITD

--Open Claims

,CASE WHEN  VDS.CLMST_STATUSCD NOT IN('OPENERROR') AND DCT.CTYP_CODE NOT IN ('SUSPENSE') AND to_char(VF.MAG_OPEN_DATE,'YYYY') =SUBSTR(TO_CHAR(VF.MONTH_ID),1,4)AND to_char(VF.MAG_OPEN_DATE,'MM') =SUBSTR(TO_CHAR(VF.MONTH_ID),5,2)
THEN 1 ELSE 0 END AS OPEN_CLAIMS_MTD
,CASE WHEN  VDS.CLMST_STATUSCD NOT IN('OPENERROR') AND DCT.CTYP_CODE NOT IN ('SUSPENSE') AND to_char(VF.MAG_OPEN_DATE,'YYYY') =SUBSTR(TO_CHAR(VF.MONTH_ID),1,4)
THEN 1 ELSE 0 END AS OPEN_CLAIMS_YTD
,CASE WHEN  VDS.CLMST_STATUSCD  NOT IN('OPENERROR') AND DCT.CTYP_CODE NOT IN ('SUSPENSE') AND to_char(VF.MAG_OPEN_DATE,'YYYY/MM/DD') &lt;&gt; '1900/01/01'
THEN 1 ELSE 0 END AS OPEN_CLAIMS_ITD

--Reopen Claims

,CASE WHEN  VDS.CLMST_STATUSCD IN('REOPEN') AND to_char(VF.MAG_REOPEN_DATE,'YYYY') =SUBSTR(TO_CHAR(VF.MONTH_ID),1,4) AND to_char(VF.MAG_REOPEN_DATE,'MM') =SUBSTR(TO_CHAR(VF.MONTH_ID),5,2)
THEN 1 ELSE 0 END AS REOPEN_CLAIMS_MTD
,CASE WHEN  VDS.CLMST_STATUSCD IN('REOPEN') AND to_char(VF.MAG_REOPEN_DATE,'YYYY') =SUBSTR(TO_CHAR(VF.MONTH_ID),1,4)
THEN 1 ELSE 0 END AS REOPEN_CLAIMS_YTD
,CASE WHEN  VDS.CLMST_STATUSCD IN('REOPEN') AND to_char(VF.MAG_REOPEN_DATE,'YYYY/MM/DD') &lt;&gt; '1900/01/01'
THEN 1 ELSE 0 END AS REOPEN_CLAIMS_ITD

--Open Law Suits

,CASE WHEN  to_char(VF.MAG_SUIT_DATE,'YYYY') =SUBSTR(TO_CHAR(VF.MONTH_ID),1,4)AND to_char(VF.MAG_SUIT_DATE,'MM') =SUBSTR(TO_CHAR(VF.MONTH_ID),5,2) AND VDS.CLMST_STATUSCD NOT IN('OPENERROR')
THEN 1 ELSE 0 END AS OPEN_LAW_SUITS_MTD
,CASE WHEN   to_char(VF.MAG_SUIT_DATE,'YYYY') =SUBSTR(TO_CHAR(VF.MONTH_ID),1,4)  AND VDS.CLMST_STATUSCD NOT IN('OPENERROR')
THEN 1 ELSE 0 END AS OPEN_LAW_SUITS_YTD
,CASE WHEN  to_char(VF.MAG_SUIT_DATE,'MM/DD/YYYY') &lt;&gt; '01/01/1900' AND VDS.CLMST_STATUSCD NOT IN('OPENERROR')
THEN 1 ELSE 0 END AS OPEN_LAW_SUITS_ITD

--Pendind Law Suits

,CASE WHEN   VDS.CLMST_STATUSCD IN('OPEN','REOPEN') AND to_char(VF.MAG_SUIT_DATE,'YYYY') =SUBSTR(TO_CHAR(VF.MONTH_ID),1,4)AND to_char(VF.MAG_SUIT_DATE,'MM') =SUBSTR(TO_CHAR(VF.MONTH_ID),5,2) AND DCT.CTYP_CODE IN('SUIT')
THEN 1 ELSE 0 END AS PENDING_LAW_SUITS_MTD
,CASE WHEN   VDS.CLMST_STATUSCD IN('OPEN','REOPEN') AND to_char(VF.MAG_SUIT_DATE,'YYYY') =SUBSTR(TO_CHAR(VF.MONTH_ID),1,4) AND DCT.CTYP_CODE IN('SUIT')
THEN 1 ELSE 0 END AS PENDING_LAW_SUITS_YTD
,CASE WHEN   VDS.CLMST_STATUSCD IN('OPEN','REOPEN')  AND to_char(VF.MAG_SUIT_DATE,'MM/DD/YYYY') &lt;&gt; '01/01/1900' AND DCT.CTYP_CODE IN('SUIT')
THEN 1 ELSE 0 END AS PENDING_LAW_SUITS_ITD

--Claim_PK_Count

,CASE WHEN  DCT.CTYP_CODE NOT IN('SUSPENSE') AND VDS.CLMST_STATUSCD IN('OPEN','REOPEN') AND to_char(VF.MAG_OPEN_DATE,'YYYY') =SUBSTR(TO_CHAR(VF.MONTH_ID),1,4)AND to_char(VF.MAG_OPEN_DATE,'MM') =SUBSTR(TO_CHAR(VF.MONTH_ID),5,2)
THEN 1 ELSE 0 END AS CLAIM_PK_COUNT_MTD
,CASE WHEN  DCT.CTYP_CODE NOT IN('SUSPENSE') AND VDS.CLMST_STATUSCD IN('OPEN','REOPEN') AND to_char(VF.MAG_OPEN_DATE,'YYYY') =SUBSTR(TO_CHAR(VF.MONTH_ID),1,4)
THEN 1 ELSE 0 END AS CLAIM_PK_COUNT_YTD
,CASE WHEN  DCT.CTYP_CODE NOT IN('SUSPENSE') AND VDS.CLMST_STATUSCD IN('OPEN','REOPEN')  AND to_char(VF.MAG_OPEN_DATE,'YYYY/MM/DD') &lt;&gt; '1900/01/01'
THEN 1 ELSE 0 END AS CLAIM_PK_COUNT_ITD

--Total Closed

,CASE WHEN to_char(VF.MAG_CLOSE_DATE,'YYYY') =SUBSTR(TO_CHAR(VF.MONTH_ID),1,4)AND to_char(VF.MAG_CLOSE_DATE,'MM') =SUBSTR(TO_CHAR(VF.MONTH_ID),5,2)
THEN 1 ELSE 0 END AS TOTAL_CLOSED_MTD
,CASE WHEN to_char(VF.MAG_CLOSE_DATE,'YYYY') =SUBSTR(TO_CHAR(VF.MONTH_ID),1,4)
THEN 1 ELSE 0 END AS TOTAL_CLOSED_YTD
,CASE WHEN to_char(VF.MAG_CLOSE_DATE,'YYYY/MM/DD') &lt;&gt; '1900/01/01'
THEN 1 ELSE 0 END AS TOTAL_CLOSED_ITD

--Total Cases

,0 AS TOTAL_CASES_MTD
,0 AS TOTAL_CASES_YTD
,0 AS TOTAL_CASED_ITD
--Transfers IN
,0 AS TRANSFERS_IN_MTD
,0 AS TRANSFERS_IN_YTD
,0 AS TRANSFERS_IN_ITD
--Transfers OUT
,0 AS TRANSFERS_OUT_MTD
,0 AS TRANSFERS_OUT_YTD
,0 AS TRANSFERS_OUT_ITD
--Admin Reopen
,0 AS ADMIN_REOPENS_MTD
,0 AS ADMIN_REOPENS_YTD
,0 AS ADMIN_REOPENS_ITD 
,VDS.CLMST_STATUSCD AS CLAIM_STATUS_CODE
,DCT.CTYP_CODE AS CLAIM_TYPE_CODE
,VF.CLAIM_ID AS CLAIM_PK
,CASE WHEN CLM_GROUPNUMBER IS NOT NULL 
THEN 1 ELSE 0 END AS MULTILOSS_COUNT

--,CLAIM_NO

,CASE WHEN VF.MAG_CLOSE_DATE IS NOT NULL
THEN 1 ELSE 0 END AS CLAIM_CLOSED_FLAG
,CASE WHEN VF.NET_EXPENSE_PAID_ITD = 0 AND VF.NET_INDEMNITY_PAID_MTD = 0  
THEN 1 ELSE 0 END AS CLAIM_NO_PMT_FLAG
,CASE WHEN VF.NET_INDEMNITY_PAID_MTD > 0  
THEN 1 ELSE 0 END AS CLAIM_WITH_IND_FLAG

--Multi Loss

,CASE WHEN CLM_GROUPNUMBER IS NOT NULL AND to_char(VF.MAG_OPEN_DATE,'YYYY') =SUBSTR(TO_CHAR(VF.MONTH_ID),1,4)AND to_char(VF.MAG_OPEN_DATE,'MM') =SUBSTR(TO_CHAR(VF.MONTH_ID),5,2) AND VDC.PRIMARY_CLAIM_B='Y'
THEN MAG_MULTILOSS_OPEN_FLAG ELSE 0 END AS MULTILOSS_COUNT_MTD 
,CASE WHEN CLM_GROUPNUMBER IS NOT NULL AND to_char(VF.MAG_OPEN_DATE,'YYYY') =SUBSTR(TO_CHAR(VF.MONTH_ID),1,4) AND VDC.PRIMARY_CLAIM_B='Y'
THEN MAG_MULTILOSS_OPEN_FLAG ELSE 0 END AS MULTILOSS_COUNT_YTD 
,CASE WHEN CLM_GROUPNUMBER IS NOT NULL AND VDC.PRIMARY_CLAIM_B='Y'
THEN MAG_MULTILOSS_OPEN_FLAG ELSE 0 END AS MULTILOSS_COUNT_ITD

--Pending Cases

,CASE WHEN CLM_GROUPNUMBER IS NULL AND to_char(VF.MAG_OPEN_DATE,'YYYY') =SUBSTR(TO_CHAR(VF.MONTH_ID),1,4)AND to_char(VF.MAG_OPEN_DATE,'MM') =SUBSTR(TO_CHAR(VF.MONTH_ID),5,2) 
THEN 1 ELSE 0 END AS MULTILOSS_COUNT_MTD 
,CASE WHEN CLM_GROUPNUMBER IS NULL AND to_char(VF.MAG_OPEN_DATE,'YYYY') =SUBSTR(TO_CHAR(VF.MONTH_ID),1,4) 
THEN 1 ELSE 0 END AS MULTILOSS_COUNT_YTD 
,CASE WHEN CLM_GROUPNUMBER IS NULL 
THEN 1 ELSE 0 END AS MULTILOSS_COUNT_ITD

--Paid Indemnity on Closed

,CASE WHEN VF.NET_INDEMNITY_PAID_ITD > 0 AND VDS.CLMST_STATUSCD IN('CLOSED','OPENERROR') 
THEN 1 ELSE 0 END AS PAID_INDEMNITY_ON_CLOSED
,VF.USR_DEF_SUM14_ITD AS DEDUCTIBLE_LOSS_RECOVERY
,VF.USR_DEF_SUM8_ITD AS DEDUCTIBLE_EXPENSE

--Paid Expenses on Closed

,CASE WHEN VF.NET_EXPENSE_PAID_ITD > 0 AND VDS.CLMST_STATUSCD IN('CLOSED','OPENERROR') 
THEN 1 ELSE 0 END AS PAID_EXPENSE_ON_CLOSED

--OpenError

,CASE WHEN VDS.CLMST_STATUSCD IN('OPENERROR') AND to_char(VF.MAG_OPENERROR_DATE,'YYYY') =SUBSTR(TO_CHAR(VF.MONTH_ID),1,4)AND to_char(VF.MAG_OPENERROR_DATE,'MM') =SUBSTR(TO_CHAR(VF.MONTH_ID),5,2)
THEN 1 ELSE 0 END AS OPEN_ERROR_MTD
,CASE WHEN VDS.CLMST_STATUSCD IN('OPENERROR') AND to_char(VF.MAG_OPENERROR_DATE,'YYYY') =SUBSTR(TO_CHAR(VF.MONTH_ID),1,4)
THEN 1 ELSE 0 END AS OPEN_ERROR_YTD
,CASE WHEN VDS.CLMST_STATUSCD IN('OPENERROR') AND to_char(VF.MAG_OPENERROR_DATE,'YYYY/MM/DD') &lt;&gt; '1900/01/01'
THEN 1 ELSE 0 END AS OPEN_ERROR_ITD

--Open NOI

,CASE WHEN  to_char(VF.MAG_NOI_DATE,'YYYY') =SUBSTR(TO_CHAR(VF.MONTH_ID),1,4)AND to_char(VF.MAG_NOI_DATE,'MM') =SUBSTR(TO_CHAR(VF.MONTH_ID),5,2) AND VDS.CLMST_STATUSCD NOT IN('OPENERROR')
THEN 1 ELSE 0 END AS OPEN_NOI_MTD
,CASE WHEN   to_char(VF.MAG_NOI_DATE,'YYYY') =SUBSTR(TO_CHAR(VF.MONTH_ID),1,4) AND VDS.CLMST_STATUSCD NOT IN('OPENERROR')
THEN 1 ELSE 0 END AS OPEN_NOI_YTD
,CASE WHEN  to_char(VF.MAG_NOI_DATE,'mm/dd/yyyy') &lt;&gt; '01/01/1900' AND VDS.CLMST_STATUSCD NOT IN('OPENERROR')
THEN 1 ELSE 0 END AS OPEN_NOI_ITD

--Pending NOI

,CASE WHEN  VDS.CLMST_STATUSCD IN('OPEN','REOPEN') AND to_char(VF.MAG_NOI_DATE,'YYYY') =SUBSTR(TO_CHAR(VF.MONTH_ID),1,4)AND to_char(VF.MAG_NOI_DATE,'MM') =SUBSTR(TO_CHAR(VF.MONTH_ID),5,2) 
THEN 1 ELSE 0 END AS PENDING_NOI_MTD
,CASE WHEN  VDS.CLMST_STATUSCD IN('OPEN','REOPEN') AND to_char(VF.MAG_NOI_DATE,'YYYY') =SUBSTR(TO_CHAR(VF.MONTH_ID),1,4) 
THEN 1 ELSE 0 END AS PENDING_NOI_YTD
,CASE WHEN  VDS.CLMST_STATUSCD IN('OPEN','REOPEN') AND to_char(VF.MAG_NOI_DATE,'mm/dd/yyyy') &lt;&gt; '01/01/1900' 
THEN 1 ELSE 0 END AS PENDING_NOI_ITD
,OPENDATE_ID
,VF.MAG_OPEN_DATE
,VF.MAG_CLOSE_DATE
,CLOSEDDATE_ID
,TO_NUMBER(SUBSTR(OPENDATE_ID,1,4)) AS OPENDATE_ID_YEAR
,TO_NUMBER(SUBSTR(OPENDATE_ID,5,2)) AS OPENDATE_ID_MNTH
,CLOSEDDATE_ID
,TO_NUMBER(SUBSTR(CLOSEDDATE_ID,1,4)) AS CLOSEDDATE_ID_YEAR
,TO_NUMBER(SUBSTR(CLOSEDDATE_ID,5,2)) AS CLOSEDDATE_ID_MNTH

FROM VFACT_CLAIM_OSR VF

left outer join vdim_claimstatus vds ON VF.CLAIMSTATUS_ID=VDS.CLAIMSTATUS_ID

LEFT OUTER JOIN VDIM_CLAIM VDC ON VF.CLAIM_ID=VDC.CLAIM_ID

LEFT OUTER JOIN DIM_CLAIMTYPE DCT ON VF.CLAIMTYPE_ID=DCT.CLAIMTYPE_ID

---WHERE VF.MONTH_ID='20171001'
WHERE SUBSTR(to_char(VF.MONTH_ID),1,6) = ?
ORDER BY VF.MONTH_ID, CLAIM_NUMBER


    

</sql>
    <limit>0</limit>
    <lookup>Execute SQL script</lookup>
    <execute_each_row>Y</execute_each_row>
    <variables_active>Y</variables_active>
    <lazy_conversion_active>N</lazy_conversion_active>
    <cluster_schema/>
    <remotesteps>
      <input>
      </input>
      <output>
      </output>
    </remotesteps>
    <GUI>
      <xloc>928</xloc>
      <yloc>256</yloc>
      <draw>Y</draw>
    </GUI>
  </step>
  <step_error_handling>
  </step_error_handling>
  <slave-step-copy-partition-distribution>
  </slave-step-copy-partition-distribution>
  <slave_transformation>N</slave_transformation>
  <attributes>
    <group>
      <name>explorerState</name>
    </group>
  </attributes>
</transformation>
