<job>
  <name>JB_FACT_POLICY</name>
  <description>New logic to populate data to FACT_POLICY table.</description>
  <extended_description/>
  <job_version/>
  <job_status>0</job_status>
  <directory>/public/ETL/Facts</directory>
  <created_user>-</created_user>
  <created_date>2014/09/10 14:46:11.317</created_date>
  <modified_user>admin</modified_user>
  <modified_date>2018/11/14 17:41:17.962</modified_date>
  <parameters>
    </parameters>
  <connection>
    <name>4SBI_DataWarehouse</name>
    <server>${G_DW_DB_HOST}</server>
    <type>ORACLE</type>
    <access>Native</access>
    <database>${G_DW_DB_NAME}</database>
    <port>${G_DW_DB_PORT}</port>
    <username>${G_DW_DB_USERNAME}</username>
    <password>${G_DW_DB_PWD}</password>
    <servername/>
    <data_tablespace>${G_DW_DB_DATA}</data_tablespace>
    <index_tablespace>${G_DW_DB_INDEX}</index_tablespace>
    <attributes>
      <attribute>
        <code>FORCE_IDENTIFIERS_TO_LOWERCASE</code>
        <attribute>N</attribute>
      </attribute>
      <attribute>
        <code>FORCE_IDENTIFIERS_TO_UPPERCASE</code>
        <attribute>N</attribute>
      </attribute>
      <attribute>
        <code>IS_CLUSTERED</code>
        <attribute>N</attribute>
      </attribute>
      <attribute>
        <code>PORT_NUMBER</code>
        <attribute>${G_DW_DB_PORT}</attribute>
      </attribute>
      <attribute>
        <code>QUOTE_ALL_FIELDS</code>
        <attribute>N</attribute>
      </attribute>
      <attribute>
        <code>SUPPORTS_BOOLEAN_DATA_TYPE</code>
        <attribute>N</attribute>
      </attribute>
      <attribute>
        <code>USE_POOLING</code>
        <attribute>N</attribute>
      </attribute>
    </attributes>
  </connection>
  <connection>
    <name>4SBI_Staging</name>
    <server>${G_STAGING_DB_HOST}</server>
    <type>ORACLE</type>
    <access>Native</access>
    <database>${G_STAGING_DB_NAME}</database>
    <port>${G_STAGING_DB_PORT}</port>
    <username>${G_STAGING_DB_USERNAME}</username>
    <password>${G_STAGING_DB_PWD}</password>
    <servername/>
    <data_tablespace>${G_STAGING_DB_DATA}</data_tablespace>
    <index_tablespace>${G_STAGING_DB_INDEX}</index_tablespace>
    <attributes>
      <attribute>
        <code>FORCE_IDENTIFIERS_TO_LOWERCASE</code>
        <attribute>N</attribute>
      </attribute>
      <attribute>
        <code>FORCE_IDENTIFIERS_TO_UPPERCASE</code>
        <attribute>N</attribute>
      </attribute>
      <attribute>
        <code>IS_CLUSTERED</code>
        <attribute>N</attribute>
      </attribute>
      <attribute>
        <code>PORT_NUMBER</code>
        <attribute>${G_STAGING_DB_PORT}</attribute>
      </attribute>
      <attribute>
        <code>QUOTE_ALL_FIELDS</code>
        <attribute>N</attribute>
      </attribute>
      <attribute>
        <code>SUPPORTS_BOOLEAN_DATA_TYPE</code>
        <attribute>N</attribute>
      </attribute>
      <attribute>
        <code>USE_POOLING</code>
        <attribute>N</attribute>
      </attribute>
    </attributes>
  </connection>
  <connection>
    <name>DW_Log_Link</name>
    <server>${G_LOG_DB_HOST}</server>
    <type>ORACLE</type>
    <access>Native</access>
    <database>${G_LOG_DB_NAME}</database>
    <port>${G_LOG_DB_PORT}</port>
    <username>${G_LOG_DB_USERNAME}</username>
    <password>${G_LOG_DB_PWD}</password>
    <servername/>
    <data_tablespace>${G_LOG_DB_DATA}</data_tablespace>
    <index_tablespace>${G_LOG_DB_INDEX}</index_tablespace>
    <attributes>
      <attribute>
        <code>FORCE_IDENTIFIERS_TO_LOWERCASE</code>
        <attribute>N</attribute>
      </attribute>
      <attribute>
        <code>FORCE_IDENTIFIERS_TO_UPPERCASE</code>
        <attribute>N</attribute>
      </attribute>
      <attribute>
        <code>IS_CLUSTERED</code>
        <attribute>N</attribute>
      </attribute>
      <attribute>
        <code>PORT_NUMBER</code>
        <attribute>${G_LOG_DB_PORT}</attribute>
      </attribute>
      <attribute>
        <code>QUOTE_ALL_FIELDS</code>
        <attribute>N</attribute>
      </attribute>
      <attribute>
        <code>SUPPORTS_BOOLEAN_DATA_TYPE</code>
        <attribute>N</attribute>
      </attribute>
      <attribute>
        <code>USE_POOLING</code>
        <attribute>N</attribute>
      </attribute>
    </attributes>
  </connection>
  <slaveservers>
    <slaveserver>
      <name>4Sight BI - PDI Server</name>
      <hostname>10.0.0.21</hostname>
      <port>9080</port>
      <webAppName>pentaho-di</webAppName>
      <username>joe</username>
      <password>Encrypted 2be98afc86aa7f2e4bb18bd63c99dbdde</password>
      <proxy_hostname/>
      <proxy_port/>
      <non_proxy_hosts/>
      <master>Y</master>
      <sslMode>N</sslMode>
    </slaveserver>
    <slaveserver>
      <name>Carte 1</name>
      <hostname>localhost</hostname>
      <port>9081</port>
      <webAppName/>
      <username>cluster</username>
      <password>Encrypted 2be98afc86aa7f2e4cb1aa265cd86aac8</password>
      <proxy_hostname/>
      <proxy_port/>
      <non_proxy_hosts/>
      <master>N</master>
      <sslMode>N</sslMode>
    </slaveserver>
    <slaveserver>
      <name>DI Server</name>
      <hostname>localhost</hostname>
      <port>9080</port>
      <webAppName>pentaho-di</webAppName>
      <username>joe</username>
      <password>Encrypted 2be98afc86aa7f2e4bb18bd63c99dbdde</password>
      <proxy_hostname/>
      <proxy_port/>
      <non_proxy_hosts/>
      <master>Y</master>
      <sslMode>N</sslMode>
    </slaveserver>
    <slaveserver>
      <name>MM_ETL_DEV</name>
      <hostname>magspentaho</hostname>
      <port>9080</port>
      <webAppName>pentaho-di</webAppName>
      <username>shota</username>
      <password>Encrypted 2be98afc86aa7f2e4cb79ce63d69dbbdb</password>
      <proxy_hostname/>
      <proxy_port/>
      <non_proxy_hosts/>
      <master>Y</master>
      <sslMode>N</sslMode>
    </slaveserver>
    <slaveserver>
      <name>MM_ETL_SERVER</name>
      <hostname>http://magspentaho</hostname>
      <port>9080</port>
      <webAppName>pentaho-di</webAppName>
      <username>shota</username>
      <password>Encrypted 2be98afc86aa7f2e4cb79ce63d69dbbdb</password>
      <proxy_hostname/>
      <proxy_port/>
      <non_proxy_hosts/>
      <master>Y</master>
      <sslMode>N</sslMode>
    </slaveserver>
    <slaveserver>
      <name>MM_ETL_TEST</name>
      <hostname>magspentahotest</hostname>
      <port>9080</port>
      <webAppName>pentaho-di</webAppName>
      <username>admin</username>
      <password>Encrypted 2be98afc86aa7f2e4bb18bd63c99dbdde</password>
      <proxy_hostname/>
      <proxy_port/>
      <non_proxy_hosts/>
      <master>N</master>
      <sslMode>N</sslMode>
    </slaveserver>
    <slaveserver>
      <name>MM_PENTAHO</name>
      <hostname>magspentaho</hostname>
      <port>9080</port>
      <webAppName>pentaho-di</webAppName>
      <username>admin</username>
      <password>Encrypted 2be98afc86aa7f2e4bb18bd63c99dbdde</password>
      <proxy_hostname/>
      <proxy_port/>
      <non_proxy_hosts/>
      <master>N</master>
      <sslMode>N</sslMode>
    </slaveserver>
    <slaveserver>
      <name>MM_PENTAHO_BTS</name>
      <hostname>129.144.25.104</hostname>
      <port>9080</port>
      <webAppName>pentaho-di</webAppName>
      <username>admin</username>
      <password>Encrypted 2be98afc86aa7f2e4bb18bd63c99dbdde</password>
      <proxy_hostname/>
      <proxy_port/>
      <non_proxy_hosts/>
      <master>N</master>
      <sslMode>N</sslMode>
    </slaveserver>
    <slaveserver>
      <name>MM_PENTAHO_DEV</name>
      <hostname>magspentahodev</hostname>
      <port>9080</port>
      <webAppName>pentaho-di</webAppName>
      <username>admin</username>
      <password>Encrypted 2be98afc86aa7f2e4bb18bd63c99dbdde</password>
      <proxy_hostname/>
      <proxy_port/>
      <non_proxy_hosts/>
      <master>Y</master>
      <sslMode>N</sslMode>
    </slaveserver>
    <slaveserver>
      <name>Master</name>
      <hostname>localhost</hostname>
      <port>8081</port>
      <webAppName/>
      <username>cluster</username>
      <password>Encrypted 2be98afc86aa7f2e4cb1aa265cd86aac8</password>
      <proxy_hostname/>
      <proxy_port/>
      <non_proxy_hosts/>
      <master>Y</master>
      <sslMode>N</sslMode>
    </slaveserver>
    <slaveserver>
      <name>SERVER1</name>
      <hostname>LOCALHOST</hostname>
      <port>3306</port>
      <webAppName/>
      <username>root</username>
      <password>Encrypted 2be98afc86aa7f2e4bb18bd63c99dbdde</password>
      <proxy_hostname/>
      <proxy_port/>
      <non_proxy_hosts/>
      <master>Y</master>
      <sslMode>N</sslMode>
    </slaveserver>
    <slaveserver>
      <name>SLAVE ONE</name>
      <hostname>192.168.2.101</hostname>
      <port>3306</port>
      <webAppName/>
      <username>root</username>
      <password>Encrypted 2be98afc86aa7f2e4a418bd63c99dbdde</password>
      <proxy_hostname/>
      <proxy_port/>
      <non_proxy_hosts/>
      <master>Y</master>
      <sslMode>N</sslMode>
    </slaveserver>
    <slaveserver>
      <name>SLAVE TWO</name>
      <hostname>192.168.2.101</hostname>
      <port>3306</port>
      <webAppName/>
      <username>root</username>
      <password>Encrypted 2be98afc86aa7f2e4bb18bd63c99dbdde</password>
      <proxy_hostname/>
      <proxy_port/>
      <non_proxy_hosts/>
      <master>N</master>
      <sslMode>N</sslMode>
    </slaveserver>
    <slaveserver>
      <name>Slave1</name>
      <hostname>localhost</hostname>
      <port>8082</port>
      <webAppName/>
      <username>cluster</username>
      <password>Encrypted 2be98afc86aa7f2e4cb1aa265cd86aac8</password>
      <proxy_hostname/>
      <proxy_port/>
      <non_proxy_hosts/>
      <master>N</master>
      <sslMode>N</sslMode>
    </slaveserver>
    <slaveserver>
      <name>Slave2</name>
      <hostname>localhost</hostname>
      <port>8083</port>
      <webAppName/>
      <username>cluster</username>
      <password>Encrypted 2be98afc86aa7f2e4cb1aa265cd86aac8</password>
      <proxy_hostname/>
      <proxy_port/>
      <non_proxy_hosts/>
      <master>N</master>
      <sslMode>N</sslMode>
    </slaveserver>
    <slaveserver>
      <name>Slave3</name>
      <hostname>localhost</hostname>
      <port>8084</port>
      <webAppName/>
      <username>cluster</username>
      <password>Encrypted 2be98afc86aa7f2e4cb1aa265cd86aac8</password>
      <proxy_hostname/>
      <proxy_port/>
      <non_proxy_hosts/>
      <master>N</master>
      <sslMode>N</sslMode>
    </slaveserver>
    <slaveserver>
      <name>local DIS</name>
      <hostname>localhost</hostname>
      <port>9080</port>
      <webAppName>pentaho-di</webAppName>
      <username>admin</username>
      <password>Encrypted 2be98afc86aa7f2e4bb18bd63c99dbdde</password>
      <proxy_hostname/>
      <proxy_port/>
      <non_proxy_hosts/>
      <master>N</master>
      <sslMode>N</sslMode>
    </slaveserver>
    <slaveserver>
      <name>magspentahodev</name>
      <hostname>magspentahodev</hostname>
      <port>9080</port>
      <webAppName>pentaho-di</webAppName>
      <username>admin</username>
      <password>Encrypted 2be98afc86aa7f2e4bb18bd63c99dbdde</password>
      <proxy_hostname/>
      <proxy_port/>
      <non_proxy_hosts/>
      <master>Y</master>
      <sslMode>N</sslMode>
    </slaveserver>
  </slaveservers>
  <job-log-table>
    <connection>DW_Log_Link</connection>
    <schema/>
    <table>${G_DB_JOB_LOG_TABLE}</table>
    <size_limit_lines/>
    <interval/>
    <timeout_days/>
    <field>
      <id>ID_JOB</id>
      <enabled>Y</enabled>
      <name>ID_JOB</name>
    </field>
    <field>
      <id>CHANNEL_ID</id>
      <enabled>Y</enabled>
      <name>CHANNEL_ID</name>
    </field>
    <field>
      <id>JOBNAME</id>
      <enabled>Y</enabled>
      <name>JOBNAME</name>
    </field>
    <field>
      <id>STATUS</id>
      <enabled>Y</enabled>
      <name>STATUS</name>
    </field>
    <field>
      <id>LINES_READ</id>
      <enabled>Y</enabled>
      <name>LINES_READ</name>
    </field>
    <field>
      <id>LINES_WRITTEN</id>
      <enabled>Y</enabled>
      <name>LINES_WRITTEN</name>
    </field>
    <field>
      <id>LINES_UPDATED</id>
      <enabled>Y</enabled>
      <name>LINES_UPDATED</name>
    </field>
    <field>
      <id>LINES_INPUT</id>
      <enabled>Y</enabled>
      <name>LINES_INPUT</name>
    </field>
    <field>
      <id>LINES_OUTPUT</id>
      <enabled>Y</enabled>
      <name>LINES_OUTPUT</name>
    </field>
    <field>
      <id>LINES_REJECTED</id>
      <enabled>Y</enabled>
      <name>LINES_REJECTED</name>
    </field>
    <field>
      <id>ERRORS</id>
      <enabled>Y</enabled>
      <name>ERRORS</name>
    </field>
    <field>
      <id>STARTDATE</id>
      <enabled>Y</enabled>
      <name>STARTDATE</name>
    </field>
    <field>
      <id>ENDDATE</id>
      <enabled>Y</enabled>
      <name>ENDDATE</name>
    </field>
    <field>
      <id>LOGDATE</id>
      <enabled>Y</enabled>
      <name>LOGDATE</name>
    </field>
    <field>
      <id>DEPDATE</id>
      <enabled>Y</enabled>
      <name>DEPDATE</name>
    </field>
    <field>
      <id>REPLAYDATE</id>
      <enabled>Y</enabled>
      <name>REPLAYDATE</name>
    </field>
    <field>
      <id>LOG_FIELD</id>
      <enabled>Y</enabled>
      <name>LOG_FIELD</name>
    </field>
    <field>
      <id>EXECUTING_SERVER</id>
      <enabled>N</enabled>
      <name>EXECUTING_SERVER</name>
    </field>
    <field>
      <id>EXECUTING_USER</id>
      <enabled>N</enabled>
      <name>EXECUTING_USER</name>
    </field>
    <field>
      <id>START_JOB_ENTRY</id>
      <enabled>N</enabled>
      <name>START_JOB_ENTRY</name>
    </field>
    <field>
      <id>CLIENT</id>
      <enabled>N</enabled>
      <name>CLIENT</name>
    </field>
  </job-log-table>
  <jobentry-log-table>
    <connection/>
    <schema/>
    <table/>
    <timeout_days/>
    <field>
      <id>ID_BATCH</id>
      <enabled>Y</enabled>
      <name>ID_BATCH</name>
    </field>
    <field>
      <id>CHANNEL_ID</id>
      <enabled>Y</enabled>
      <name>CHANNEL_ID</name>
    </field>
    <field>
      <id>LOG_DATE</id>
      <enabled>Y</enabled>
      <name>LOG_DATE</name>
    </field>
    <field>
      <id>JOBNAME</id>
      <enabled>Y</enabled>
      <name>TRANSNAME</name>
    </field>
    <field>
      <id>JOBENTRYNAME</id>
      <enabled>Y</enabled>
      <name>STEPNAME</name>
    </field>
    <field>
      <id>LINES_READ</id>
      <enabled>Y</enabled>
      <name>LINES_READ</name>
    </field>
    <field>
      <id>LINES_WRITTEN</id>
      <enabled>Y</enabled>
      <name>LINES_WRITTEN</name>
    </field>
    <field>
      <id>LINES_UPDATED</id>
      <enabled>Y</enabled>
      <name>LINES_UPDATED</name>
    </field>
    <field>
      <id>LINES_INPUT</id>
      <enabled>Y</enabled>
      <name>LINES_INPUT</name>
    </field>
    <field>
      <id>LINES_OUTPUT</id>
      <enabled>Y</enabled>
      <name>LINES_OUTPUT</name>
    </field>
    <field>
      <id>LINES_REJECTED</id>
      <enabled>Y</enabled>
      <name>LINES_REJECTED</name>
    </field>
    <field>
      <id>ERRORS</id>
      <enabled>Y</enabled>
      <name>ERRORS</name>
    </field>
    <field>
      <id>RESULT</id>
      <enabled>Y</enabled>
      <name>RESULT</name>
    </field>
    <field>
      <id>NR_RESULT_ROWS</id>
      <enabled>Y</enabled>
      <name>NR_RESULT_ROWS</name>
    </field>
    <field>
      <id>NR_RESULT_FILES</id>
      <enabled>Y</enabled>
      <name>NR_RESULT_FILES</name>
    </field>
    <field>
      <id>LOG_FIELD</id>
      <enabled>N</enabled>
      <name>LOG_FIELD</name>
    </field>
    <field>
      <id>COPY_NR</id>
      <enabled>N</enabled>
      <name>COPY_NR</name>
    </field>
  </jobentry-log-table>
  <channel-log-table>
    <connection/>
    <schema/>
    <table/>
    <timeout_days/>
    <field>
      <id>ID_BATCH</id>
      <enabled>Y</enabled>
      <name>ID_BATCH</name>
    </field>
    <field>
      <id>CHANNEL_ID</id>
      <enabled>Y</enabled>
      <name>CHANNEL_ID</name>
    </field>
    <field>
      <id>LOG_DATE</id>
      <enabled>Y</enabled>
      <name>LOG_DATE</name>
    </field>
    <field>
      <id>LOGGING_OBJECT_TYPE</id>
      <enabled>Y</enabled>
      <name>LOGGING_OBJECT_TYPE</name>
    </field>
    <field>
      <id>OBJECT_NAME</id>
      <enabled>Y</enabled>
      <name>OBJECT_NAME</name>
    </field>
    <field>
      <id>OBJECT_COPY</id>
      <enabled>Y</enabled>
      <name>OBJECT_COPY</name>
    </field>
    <field>
      <id>REPOSITORY_DIRECTORY</id>
      <enabled>Y</enabled>
      <name>REPOSITORY_DIRECTORY</name>
    </field>
    <field>
      <id>FILENAME</id>
      <enabled>Y</enabled>
      <name>FILENAME</name>
    </field>
    <field>
      <id>OBJECT_ID</id>
      <enabled>Y</enabled>
      <name>OBJECT_ID</name>
    </field>
    <field>
      <id>OBJECT_REVISION</id>
      <enabled>Y</enabled>
      <name>OBJECT_REVISION</name>
    </field>
    <field>
      <id>PARENT_CHANNEL_ID</id>
      <enabled>Y</enabled>
      <name>PARENT_CHANNEL_ID</name>
    </field>
    <field>
      <id>ROOT_CHANNEL_ID</id>
      <enabled>Y</enabled>
      <name>ROOT_CHANNEL_ID</name>
    </field>
  </channel-log-table>
  <checkpoint-log-table>
    <connection/>
    <schema/>
    <table/>
    <timeout_days/>
    <max_nr_retries/>
    <run_retry_period/>
    <namespace_parameter/>
    <save_parameters/>
    <save_result_rows/>
    <save_result_files/>
    <field>
      <id>ID_JOB_RUN</id>
      <enabled>Y</enabled>
      <name>ID_JOB_RUN</name>
    </field>
    <field>
      <id>ID_JOB</id>
      <enabled>Y</enabled>
      <name>ID_JOB</name>
    </field>
    <field>
      <id>JOBNAME</id>
      <enabled>Y</enabled>
      <name>JOBNAME</name>
    </field>
    <field>
      <id>NAMESPACE</id>
      <enabled>Y</enabled>
      <name>NAMESPACE</name>
    </field>
    <field>
      <id>CHECKPOINT_NAME</id>
      <enabled>Y</enabled>
      <name>CHECKPOINT_NAME</name>
    </field>
    <field>
      <id>CHECKPOINT_COPYNR</id>
      <enabled>Y</enabled>
      <name>CHECKPOINT_COPYNR</name>
    </field>
    <field>
      <id>ATTEMPT_NR</id>
      <enabled>Y</enabled>
      <name>ATTEMPT_NR</name>
    </field>
    <field>
      <id>JOB_RUN_START_DATE</id>
      <enabled>Y</enabled>
      <name>JOB_RUN_START_DATE</name>
    </field>
    <field>
      <id>LOGDATE</id>
      <enabled>Y</enabled>
      <name>LOGDATE</name>
    </field>
    <field>
      <id>RESULT_XML</id>
      <enabled>Y</enabled>
      <name>RESULT_XML</name>
    </field>
    <field>
      <id>PARAMETER_XML</id>
      <enabled>Y</enabled>
      <name>PARAMETER_XML</name>
    </field>
  </checkpoint-log-table>
  <pass_batchid>N</pass_batchid>
  <shared_objects_file/>
  <entries>
    <entry>
      <name>TR_SET_ID_KEY_VARIABLES</name>
      <description/>
      <type>TRANS</type>
      <specification_method>rep_name</specification_method>
      <trans_object_id/>
      <filename/>
      <transname>TR_SET_ID_KEY_VARIABLES</transname>
      <directory>/public/ETL/Facts/Transformations</directory>
      <arg_from_previous>N</arg_from_previous>
      <params_from_previous>N</params_from_previous>
      <exec_per_row>N</exec_per_row>
      <clear_rows>N</clear_rows>
      <clear_files>N</clear_files>
      <set_logfile>N</set_logfile>
      <logfile/>
      <logext/>
      <add_date>N</add_date>
      <add_time>N</add_time>
      <loglevel>Basic</loglevel>
      <cluster>N</cluster>
      <slave_server_name/>
      <set_append_logfile>N</set_append_logfile>
      <wait_until_finished>Y</wait_until_finished>
      <follow_abort_remote>N</follow_abort_remote>
      <create_parent_folder>N</create_parent_folder>
      <logging_remote_work>N</logging_remote_work>
      <run_configuration/>
      <parameters>
        <pass_all_parameters>Y</pass_all_parameters>
      </parameters>
      <parallel>N</parallel>
      <draw>Y</draw>
      <nr>0</nr>
      <xloc>403</xloc>
      <yloc>117</yloc>
    </entry>
    <entry>
      <name>START</name>
      <description/>
      <type>SPECIAL</type>
      <start>Y</start>
      <dummy>N</dummy>
      <repeat>N</repeat>
      <schedulerType>0</schedulerType>
      <intervalSeconds>0</intervalSeconds>
      <intervalMinutes>60</intervalMinutes>
      <hour>12</hour>
      <minutes>0</minutes>
      <weekDay>1</weekDay>
      <DayOfMonth>1</DayOfMonth>
      <parallel>N</parallel>
      <draw>Y</draw>
      <nr>0</nr>
      <xloc>38</xloc>
      <yloc>117</yloc>
    </entry>
    <entry>
      <name>TR_Drop_TMP_FACT_POLICY_Tables</name>
      <description/>
      <type>TRANS</type>
      <specification_method>rep_name</specification_method>
      <trans_object_id/>
      <filename/>
      <transname>TR_Drop_TMP_FACT_POLICY_Tables</transname>
      <directory>/public/ETL/Facts/Transformations</directory>
      <arg_from_previous>N</arg_from_previous>
      <params_from_previous>N</params_from_previous>
      <exec_per_row>N</exec_per_row>
      <clear_rows>N</clear_rows>
      <clear_files>N</clear_files>
      <set_logfile>N</set_logfile>
      <logfile/>
      <logext/>
      <add_date>N</add_date>
      <add_time>N</add_time>
      <loglevel>Basic</loglevel>
      <cluster>N</cluster>
      <slave_server_name/>
      <set_append_logfile>N</set_append_logfile>
      <wait_until_finished>Y</wait_until_finished>
      <follow_abort_remote>N</follow_abort_remote>
      <create_parent_folder>N</create_parent_folder>
      <logging_remote_work>N</logging_remote_work>
      <run_configuration/>
      <parameters>
        <pass_all_parameters>Y</pass_all_parameters>
      </parameters>
      <parallel>N</parallel>
      <draw>Y</draw>
      <nr>0</nr>
      <xloc>190</xloc>
      <yloc>117</yloc>
    </entry>
    <entry>
      <name>Create tmp_fpc_PTRANS_dates </name>
      <description/>
      <type>SQL</type>
      <sql>create table tmp_fpc_ptrans_dates 
nologging tablespace ${G_STAGING_DB_DATA}
as
SELECT 
	MIN(PT_ACCOUNTINGDATE) AS POLICYSTARTDATE,
	MAX(PT_ACCOUNTINGDATE) AS POLICYENDDATE
FROM STG_POLICYTRANSACTION
WHERE LOADDATE = ${sql_loadDate}
;
</sql>
      <useVariableSubstitution>T</useVariableSubstitution>
      <sqlfromfile>F</sqlfromfile>
      <sqlfilename/>
      <sendOneStatement>F</sendOneStatement>
      <connection>4SBI_Staging</connection>
      <parallel>N</parallel>
      <draw>Y</draw>
      <nr>0</nr>
      <xloc>524</xloc>
      <yloc>22</yloc>
    </entry>
    <entry>
      <name>Create tmp_fpc_CTRANS_dates</name>
      <description/>
      <type>SQL</type>
      <sql>create table tmp_fpc_ctrans_dates 
nologging tablespace ${G_STAGING_DB_DATA}
as
select
	MIN(decode(nvl(ct_transactionflag,'I'),'D',ct_changeeffectivedate,CT_TRANSACTIONDATE)) AS CLAIMSTARTDATE,
	MAX(decode(nvl(ct_transactionflag,'I'),'D',ct_changeeffectivedate,CT_TRANSACTIONDATE)) AS CLAIMENDDATE
FROM STG_CLAIMTRANSACTION 
WHERE LOADDATE = ${sql_loadDate}
;
</sql>
      <useVariableSubstitution>T</useVariableSubstitution>
      <sqlfromfile>F</sqlfromfile>
      <sqlfilename/>
      <sendOneStatement>F</sendOneStatement>
      <connection>4SBI_Staging</connection>
      <parallel>N</parallel>
      <draw>Y</draw>
      <nr>0</nr>
      <xloc>620</xloc>
      <yloc>117</yloc>
    </entry>
    <entry>
      <name>Create tmp_fpc_acct_period</name>
      <description/>
      <type>SQL</type>
      <sql>create table tmp_fpc_acct_period nologging 
tablespace ${G_STAGING_DB_DATA}
 as
	SELECT NVL(POLICYDATES.POLICYSTARTDATE, sysdate) POLICYSTARTDATE, 
	       NVL(Greatest(POLICYDATES.POLICYENDDATE, Sysdate), sysdate) POLICYENDDATE, 
	       NVL(CLAIMDATES.CLAIMSTARTDATE, sysdate) CLAIMSTARTDATE, 
	       NVL(Greatest(CLAIMDATES.CLAIMENDDATE, Sysdate), sysdate) CLAIMENDDATE
	FROM tmp_fpc_ptrans_dates POLICYDATES,tmp_fpc_ctrans_dates CLAIMDATES
;</sql>
      <useVariableSubstitution>T</useVariableSubstitution>
      <sqlfromfile>F</sqlfromfile>
      <sqlfilename/>
      <sendOneStatement>F</sendOneStatement>
      <connection>4SBI_Staging</connection>
      <parallel>N</parallel>
      <draw>Y</draw>
      <nr>0</nr>
      <xloc>726</xloc>
      <yloc>22</yloc>
    </entry>
    <entry>
      <name>Create tmp_fpc_period</name>
      <description/>
      <type>SQL</type>
      <sql>create table tmp_fpc_period nologging tablespace ${G_STAGING_DB_DATA}
as
select
	d.POLICYSTARTDATE,
	d.POLICYENDDATE,
	d.CLAIMSTARTDATE,
	d.CLAIMENDDATE,
	d.dbstartdate,
	d.dbenddate,
	to_number(to_char(trunc(d.dbstartdate,'MON'),'YYYYMMDD')) sk_startMonth,
	to_number(to_char(trunc(d.dbenddate,'MON'),'YYYYMMDD')) sk_endMonth,
	trunc(d.dbstartdate,'MON') startDate,
	to_number(to_char(d.dbstartdate,'MM')) startMonth,
	to_number(to_char(d.dbstartdate,'YYYY')) startYear,
	last_day(d.dbenddate) endMonth,
	to_number(to_char(d.dbenddate,'YYYY')) endYear,
	add_months(d.dbenddate,1) endDate,
  	trunc(months_between(d.dbstartdate,d.dbenddate))+1 ora_months,
	(select count(1) from dim_month m where m.mon_startdate between trunc(d.dbstartdate,'MON') and trunc(d.dbenddate,'MON')) numberMonths
from
(
	select
		d.POLICYSTARTDATE,
		d.POLICYENDDATE,
		d.CLAIMSTARTDATE,
		d.CLAIMENDDATE,
		least(nvl(d.POLICYSTARTDATE,d.CLAIMSTARTDATE),d.CLAIMSTARTDATE) dbstartdate,
		greatest(nvl(d.POLICYENDDATE,d.CLAIMENDDATE),d.CLAIMENDDATE) dbenddate
	from tmp_fpc_acct_period d
) d
;

</sql>
      <useVariableSubstitution>T</useVariableSubstitution>
      <sqlfromfile>F</sqlfromfile>
      <sqlfilename/>
      <sendOneStatement>F</sendOneStatement>
      <connection>4SBI_Staging</connection>
      <parallel>N</parallel>
      <draw>Y</draw>
      <nr>0</nr>
      <xloc>800</xloc>
      <yloc>117</yloc>
    </entry>
    <entry>
      <name>Create tmp_fpc_genmonths</name>
      <description/>
      <type>SQL</type>
      <sql>create table tmp_fpc_genmonths nologging tablespace ${G_STAGING_DB_DATA}
as
select 
row_number() over (order by m.mon_startdate) 			sk_period,
to_number(to_char(m.mon_enddate,'YYYYMMDD')) 			sql_periodEndDate_id,
m.mon_enddate 							sql_periodEndDate,
m.mon_enddate 							periodEndDate,
p.policystartdate 						startdate,
row_number() over (order by m.month_id)-1 			addMonths,
m.mon_startdate 						periodStartDate,
to_number(to_char(m.mon_startdate,'YYYYMMDD')) 			sql_periodStartDate_id,
to_number(to_char(trunc(m.mon_startdate,'YYYY'),'YYYYMMDD')) 	sql_periodStartYear,
m.mon_startdate 						sql_periodStartDate,
m.MON_MONTHINYEAR 						periodMonth,
m.MON_YEAR 							periodYear,
trunc(add_months(m.mon_startdate,-1),'MON') 			priorPeriodStartDate,
m.month_id							month_id,
to_number(to_char(
	trunc(add_months(
		m.mon_startdate,-1),'MON'),'YYYYMMDD')) 	priorMonth_id
from 
  tmp_fpc_period p,
  dim_month m
where 
  m.month_id between p.sk_startMonth and p.sk_endMonth
order by m.month_id
;


create index tmp_fpc_genmonths_ix1 on tmp_fpc_genmonths (sql_periodStartDate_id) nologging tablespace ${G_STAGING_DB_INDEX};
</sql>
      <useVariableSubstitution>T</useVariableSubstitution>
      <sqlfromfile>F</sqlfromfile>
      <sqlfilename/>
      <sendOneStatement>F</sendOneStatement>
      <connection>4SBI_Staging</connection>
      <parallel>N</parallel>
      <draw>Y</draw>
      <nr>0</nr>
      <xloc>921</xloc>
      <yloc>22</yloc>
    </entry>
    <entry>
      <name>Create TMP_FACT_POLICY_INPUT</name>
      <description/>
      <type>SQL</type>
      <sql>create table TMP_FACT_POLICY_INPUT
nologging tablespace ${G_STAGING_DB_DATA}
as
SELECT fpc.month_id,
       underwriter_id,
       producer_id,
       product_id,
       company_id,
       firstinsured_id,
       secondinsured_id,
       thirdinsured_id,
       firstotherinterest_id,
       secondotherinterest_id,
       fpc.policy_id,
       policyextension_id,
       policyeffectivedate_id,
       policyexpirationdate_id,
       policystatus_id,
       -- Do not group data by territory
       0 territory_id,
       policyneworrenewal,
       dp.pol_uniqueid,
       -- Jma 02/09/2017 Add following fields for VL merge
       OFFERINGCOMPANY_ID,
       AGENT_ID,
       STATE_ID,
       'OASIS' SOURCE_SYSTEM,
       -- End update
       SUM(alc_exp_pd_amt) AS alc_exp_pd_amt,
       SUM(alc_exp_pd_amt_itd) AS alc_exp_pd_amt_itd,
       SUM(alc_exp_pd_amt_ytd) AS alc_exp_pd_amt_ytd,
       SUM(alc_exp_rsrv_chng_amt) AS alc_exp_rsrv_chng_amt,
       SUM(alc_exp_rsrv_chng_amt_itd) AS alc_exp_rsrv_chng_amt_itd,
       SUM(alc_exp_rsrv_chng_amt_ytd) AS alc_exp_rsrv_chng_amt_ytd,
       SUM(audit_prem_amt) AS audit_prem_amt,
       SUM(audit_prem_amt_itd) AS audit_prem_amt_itd,
       SUM(audit_prem_amt_ytd) AS audit_prem_amt_ytd,
       SUM(cncl_prem_amt) AS cncl_prem_amt,
       SUM(cncl_prem_amt_itd) AS cncl_prem_amt_itd,
       SUM(cncl_prem_amt_ytd) AS cncl_prem_amt_ytd,
       SUM(comm_amt) AS comm_amt,
       SUM(comm_amt_itd) AS comm_amt_itd,
       SUM(comm_amt_ytd) AS comm_amt_ytd,
       SUM(earned_prem_amt) AS earned_prem_amt,
       SUM(earned_prem_amt_itd) AS earned_prem_amt_itd,
       SUM(earned_prem_amt_ytd) AS earned_prem_amt_ytd,
       SUM(endorse_prem_amt) AS endorse_prem_amt,
       SUM(endorse_prem_amt_itd) AS endorse_prem_amt_itd,
       SUM(endorse_prem_amt_ytd) AS endorse_prem_amt_ytd,
       SUM(fees_amt) AS fees_amt,
       SUM(fees_amt_itd) AS fees_amt_itd,
       SUM(fees_amt_ytd) AS fees_amt_ytd,
       SUM(loss_pd_amt) AS loss_pd_amt,
       SUM(loss_pd_amt_itd) AS loss_pd_amt_itd,
       SUM(loss_pd_amt_ytd) AS loss_pd_amt_ytd,
       SUM(loss_rsrv_chng_amt) AS loss_rsrv_chng_amt,
       SUM(loss_rsrv_chng_amt_itd) AS loss_rsrv_chng_amt_itd,
       SUM(loss_rsrv_chng_amt_ytd) AS loss_rsrv_chng_amt_ytd,
       SUM(man_wrtn_prem_amt) AS man_wrtn_prem_amt,
       SUM(man_wrtn_prem_amt_itd) AS man_wrtn_prem_amt_itd,
       SUM(man_wrtn_prem_amt_ytd) AS man_wrtn_prem_amt_ytd,
       SUM(orig_wrtn_prem_amt) AS orig_wrtn_prem_amt,
       SUM(orig_wrtn_prem_amt_itd) AS orig_wrtn_prem_amt_itd,
       SUM(orig_wrtn_prem_amt_ytd) AS orig_wrtn_prem_amt_ytd,
       SUM(rein_prem_amt) AS rein_prem_amt,
       SUM(rein_prem_amt_itd) AS rein_prem_amt_itd,
       SUM(rein_prem_amt_ytd) AS rein_prem_amt_ytd,
       SUM(salvage_chng_amt) AS salvage_chng_amt,
       SUM(salvage_chng_amt_itd) AS salvage_chng_amt_itd,
       SUM(salvage_chng_amt_ytd) AS salvage_chng_amt_ytd,
       SUM(subro_chng_amt) AS subro_chng_amt,
       SUM(subro_chng_amt_itd) AS subro_chng_amt_itd,
       SUM(subro_chng_amt_ytd) AS subro_chng_amt_ytd,
       SUM(taxes_amt) AS taxes_amt,
       SUM(taxes_amt_itd) AS taxes_amt_itd,
       SUM(taxes_amt_ytd) AS taxes_amt_ytd,
       SUM(term_prem_amt) AS term_prem_amt,
       SUM(term_prem_amt_itd) AS term_prem_amt_itd,
       SUM(term_prem_amt_ytd) AS term_prem_amt_ytd,
       SUM(ualc_exp_pd_amt) AS ualc_exp_pd_amt,
       SUM(ualc_exp_pd_amt_itd) AS ualc_exp_pd_amt_itd,
       SUM(ualc_exp_pd_amt_ytd) AS ualc_exp_pd_amt_ytd,
       SUM(ualc_exp_rsrv_chng_amt) AS ualc_exp_rsrv_chng_amt,
       SUM(ualc_exp_rsrv_chng_amt_itd) AS ualc_exp_rsrv_chng_amt_itd,
       SUM(ualc_exp_rsrv_chng_amt_ytd) AS ualc_exp_rsrv_chng_amt_ytd,
       SUM(unearned_prem) AS unearned_prem,
       SUM(wrtn_prem_amt) AS wrtn_prem_amt,
       SUM(wrtn_prem_amt_itd) AS wrtn_prem_amt_itd,
       SUM(wrtn_prem_amt_ytd) AS wrtn_prem_amt_ytd,
       NVL(SUM(fpc.usr_def_amt1),0) AS usr_def_amt1,
       NVL(SUM(fpc.usr_def_amt_ytd1),0) AS usr_def_amt_ytd1,
       NVL(SUM(fpc.usr_def_amt_itd1),0) AS usr_def_amt_itd1,
       NVL(SUM(fpc.usr_def_amt2),0) AS usr_def_amt2,
       NVL(SUM(fpc.usr_def_amt_ytd2),0) AS usr_def_amt_ytd2,
       NVL(SUM(fpc.usr_def_amt_itd2),0) AS usr_def_amt_itd2,
       NVL(SUM(fpc.usr_def_amt3),0) AS usr_def_amt3,
       NVL(SUM(fpc.usr_def_amt_ytd3),0) AS usr_def_amt_ytd3,
       NVL(SUM(fpc.usr_def_amt_itd3),0) AS usr_def_amt_itd3,
       NVL(SUM(fpc.usr_def_amt4),0) AS usr_def_amt4,
       NVL(SUM(fpc.usr_def_amt_ytd4),0) AS usr_def_amt_ytd4,
       NVL(SUM(fpc.usr_def_amt_itd4),0) AS usr_def_amt_itd4,
       NVL(SUM(fpc.usr_def_amt5),0) AS usr_def_amt5,
       NVL(SUM(fpc.usr_def_amt_ytd5),0) AS usr_def_amt_ytd5,
       NVL(SUM(fpc.usr_def_amt_itd5),0) AS usr_def_amt_itd5,
       NVL(SUM(fpe.usr_def_amt1),0) AS fpc_usr_def_amt1,
       NVL(SUM(fpe.usr_def_amt_ytd1),0) AS FPC_USR_DEF_AMT_YTD1,
       NVL(SUM(fpe.usr_def_amt_itd1),0) AS FPC_USR_DEF_AMT_ITD1,
       NVL(SUM(fpe.usr_def_amt2),0) AS fpc_usr_def_amt2,
       NVL(SUM(fpe.usr_def_amt_ytd2),0) AS FPC_USR_DEF_AMT_YTD2,
       NVL(SUM(fpe.usr_def_amt_itd2),0) AS FPC_USR_DEF_AMT_ITD2,
       NVL(SUM(fpe.usr_def_amt3),0) AS fpc_usr_def_amt3,
       NVL(SUM(fpe.usr_def_amt_ytd3),0) AS FPC_USR_DEF_AMT_YTD3,
       NVL(SUM(fpe.usr_def_amt_itd3),0) AS FPC_USR_DEF_AMT_ITD3,
       NVL(SUM(fpe.usr_def_amt4),0) AS fpc_usr_def_amt4,
       NVL(SUM(fpe.usr_def_amt_ytd4),0) AS FPC_USR_DEF_AMT_YTD4,
       NVL(SUM(fpe.usr_def_amt_itd4),0) AS FPC_USR_DEF_AMT_ITD4,
       NVL(SUM(fpe.usr_def_amt5),0) AS fpc_usr_def_amt5,
       NVL(SUM(fpe.usr_def_amt_ytd5),0) AS FPC_USR_DEF_AMT_YTD5,
       NVL(SUM(fpe.usr_def_amt_itd5),0) AS FPC_USR_DEF_AMT_ITD5,
       NVL(SUM(fpe.usr_def_amt6),0) AS fpc_usr_def_amt6,
       NVL(SUM(fpe.usr_def_amt_ytd6),0) AS FPC_USR_DEF_AMT_YTD6,
       NVL(SUM(fpe.usr_def_amt_itd6),0) AS FPC_USR_DEF_AMT_ITD6,
       NVL(SUM(fpe.usr_def_amt7),0) AS fpc_usr_def_amt7,
       NVL(SUM(fpe.usr_def_amt_ytd7),0) AS FPC_USR_DEF_AMT_YTD7,
       NVL(SUM(fpe.usr_def_amt_itd7),0) AS FPC_USR_DEF_AMT_ITD7,
       NVL(SUM(fpe.usr_def_amt8),0) AS fpc_usr_def_amt8,
       NVL(SUM(fpe.usr_def_amt_ytd8),0) AS FPC_USR_DEF_AMT_YTD8,
       NVL(SUM(fpe.usr_def_amt_itd8),0) AS FPC_USR_DEF_AMT_ITD8,
       NVL(SUM(fpe.usr_def_amt9),0) AS fpc_usr_def_amt9,
       NVL(SUM(fpe.usr_def_amt_ytd9),0) AS FPC_USR_DEF_AMT_YTD9,
       NVL(SUM(fpe.usr_def_amt_itd9),0) AS FPC_USR_DEF_AMT_ITD9,
       NVL(SUM(fpe.usr_def_amt10),0) AS FPC_USR_def_amt10,
       NVL(SUM(fpe.usr_def_amt_ytd10),0) AS FPC_USR_DEF_AMT_YTD10,
       NVL(SUM(fpe.usr_def_amt_itd10),0) AS FPC_USR_DEF_AMT_ITD10,
       NVL(SUM(fpe.usr_def_amt11),0) AS FPC_USR_def_amt11,
       NVL(SUM(fpe.usr_def_amt_ytd11),0) AS FPC_USR_DEF_AMT_YTD11,
       NVL(SUM(fpe.usr_def_amt_itd11),0) AS FPC_USR_DEF_AMT_ITD11,
       NVL(SUM(fpe.usr_def_amt12),0) AS FPC_USR_def_amt12,
       NVL(SUM(fpe.usr_def_amt_ytd12),0) AS FPC_USR_DEF_AMT_YTD12,
       NVL(SUM(fpe.usr_def_amt_itd12),0) AS FPC_USR_DEF_AMT_ITD12,
       NVL(SUM(fpe.usr_def_amt13),0) AS FPC_USR_def_amt13,
       NVL(SUM(fpe.usr_def_amt_ytd13),0) AS FPC_USR_DEF_AMT_YTD13,
       NVL(SUM(fpe.usr_def_amt_itd13),0) AS FPC_USR_DEF_AMT_ITD13,
       NVL(SUM(fpe.usr_def_amt14),0) AS FPC_USR_def_amt14,
       NVL(SUM(fpe.usr_def_amt_ytd14),0) AS FPC_USR_DEF_AMT_YTD14,
       NVL(SUM(fpe.usr_def_amt_itd14),0) AS FPC_USR_DEF_AMT_ITD14,
       NVL(SUM(fpe.usr_def_amt15),0) AS FPC_USR_def_amt15,
       NVL(SUM(fpe.usr_def_amt_ytd15),0) AS FPC_USR_DEF_AMT_YTD15,
       NVL(SUM(fpe.usr_def_amt_itd15),0) AS FPC_USR_DEF_AMT_ITD15,
       NVL(SUM(fpe.usr_def_amt16),0) AS FPC_USR_def_amt16,
       NVL(SUM(fpe.usr_def_amt_ytd16),0) AS FPC_USR_DEF_AMT_YTD16,
       NVL(SUM(fpe.usr_def_amt_itd16),0) AS FPC_USR_DEF_AMT_ITD16,
       NVL(SUM(fpe.usr_def_amt17),0) AS FPC_USR_def_amt17,
       NVL(SUM(fpe.usr_def_amt_ytd17),0) AS FPC_USR_DEF_AMT_YTD17,
       NVL(SUM(fpe.usr_def_amt_itd17),0) AS FPC_USR_DEF_AMT_ITD17,
       NVL(SUM(fpe.usr_def_amt18),0) AS FPC_USR_def_amt18,
       NVL(SUM(fpe.usr_def_amt_ytd18),0) AS FPC_USR_DEF_AMT_YTD18,
       NVL(SUM(fpe.usr_def_amt_itd18),0) AS FPC_USR_DEF_AMT_ITD18,
       NVL(SUM(fpe.usr_def_amt19),0) AS FPC_USR_def_amt19,
       NVL(SUM(fpe.usr_def_amt_ytd19),0) AS FPC_USR_DEF_AMT_YTD19,
       NVL(SUM(fpe.usr_def_amt_itd19),0) AS FPC_USR_DEF_AMT_ITD19,
       NVL(SUM(fpe.usr_def_amt20),0) AS FPC_USR_def_amt20,
       NVL(SUM(fpe.usr_def_amt_ytd20),0) AS FPC_USR_DEF_AMT_YTD20,
       NVL(SUM(fpe.usr_def_amt_itd20),0) AS FPC_USR_DEF_AMT_ITD20,
       NVL(SUM(fpe.usr_def_amt21),0) AS FPC_USR_def_amt21,
       NVL(SUM(fpe.usr_def_amt_ytd21),0) AS FPC_USR_DEF_AMT_YTD21,
       NVL(SUM(fpe.usr_def_amt_itd21),0) AS FPC_USR_DEF_AMT_ITD21,
       NVL(SUM(fpe.usr_def_amt22),0) AS FPC_USR_def_amt22,
       NVL(SUM(fpe.usr_def_amt_ytd22),0) AS FPC_USR_DEF_AMT_YTD22,
       NVL(SUM(fpe.usr_def_amt_itd22),0) AS FPC_USR_DEF_AMT_ITD22,
       NVL(SUM(fpe.usr_def_amt23),0) AS FPC_USR_def_amt23,
       NVL(SUM(fpe.usr_def_amt_ytd23),0) AS FPC_USR_DEF_AMT_YTD23,
       NVL(SUM(fpe.usr_def_amt_itd23),0) AS FPC_USR_DEF_AMT_ITD23,
       NVL(SUM(fpe.usr_def_amt24),0) AS FPC_USR_def_amt24,
       NVL(SUM(fpe.usr_def_amt_ytd24),0) AS FPC_USR_DEF_AMT_YTD24,
       NVL(SUM(fpe.usr_def_amt_itd24),0) AS FPC_USR_DEF_AMT_ITD24,
       NVL(SUM(fpe.usr_def_amt25),0) AS FPC_USR_def_amt25,
       NVL(SUM(fpe.usr_def_amt_ytd25),0) AS FPC_USR_DEF_AMT_YTD25,
       NVL(SUM(fpe.usr_def_amt_itd25),0) AS FPC_USR_DEF_AMT_ITD25,
       NVL(SUM(fpe.usr_def_amt26),0) AS fpc_usr_def_amt26,
       NVL(SUM(fpe.usr_def_amt_ytd26),0) AS FPC_USR_DEF_AMT_YTD26,
       NVL(SUM(fpe.usr_def_amt_itd26),0) AS FPC_USR_DEF_AMT_ITD26,
       NVL(SUM(fpe.usr_def_amt27),0) AS fpc_usr_def_amt27,
       NVL(SUM(fpe.usr_def_amt_ytd27),0) AS FPC_USR_DEF_AMT_YTD27,
       NVL(SUM(fpe.usr_def_amt_itd27),0) AS FPC_USR_DEF_AMT_ITD27,
       NVL(SUM(fpe.usr_def_amt28),0) AS fpc_usr_def_amt28,
       NVL(SUM(fpe.usr_def_amt_ytd28),0) AS FPC_USR_DEF_AMT_YTD28,
       NVL(SUM(fpe.usr_def_amt_itd28),0) AS FPC_USR_DEF_AMT_ITD28,
       NVL(SUM(fpe.usr_def_amt29),0) AS fpc_usr_def_amt29,
       NVL(SUM(fpe.usr_def_amt_ytd29),0) AS FPC_USR_DEF_AMT_YTD29,
       NVL(SUM(fpe.usr_def_amt_itd29),0) AS FPC_USR_DEF_AMT_ITD29,
       NVL(SUM(fpe.usr_def_amt30),0) AS fpc_usr_def_amt30,
       NVL(SUM(fpe.usr_def_amt_ytd30),0) AS FPC_USR_DEF_AMT_YTD30,
       NVL(SUM(fpe.usr_def_amt_itd30),0) AS FPC_USR_DEF_AMT_ITD30
FROM   fact_policycoverage fpc, 
       dim_policy dp, 
       tmp_fpc_genmonths g,
       -- Issue 164413
       fact_policycoverage_ext fpe 
WHERE  1 = 1 
AND    dp.policy_id = fpc.policy_id 
AND    fpc.month_id = g.month_id
       -- Issue 164413
AND    fpc.factpolicycoverage_id = fpe.factpolicycoverageext_id(+)
GROUP  BY fpc.month_id, 
       underwriter_id, 
       producer_id, 
       product_id, 
       company_id, 
       firstinsured_id, 
       secondinsured_id, 
       thirdinsured_id, 
       firstotherinterest_id, 
       secondotherinterest_id, 
       fpc.policy_id, 
       policyextension_id, 
       policyeffectivedate_id, 
       policyexpirationdate_id, 
       policystatus_id, 
       -- Do not group data by territory
       0, 
       policyneworrenewal, 
       dp.pol_uniqueid,
       -- Jma 02/09/2017 Add following fields for VL merge
       OFFERINGCOMPANY_ID,
       AGENT_ID,
       STATE_ID,
       'OASIS'
ORDER  BY month_id, dp.pol_uniqueid;

</sql>
      <useVariableSubstitution>T</useVariableSubstitution>
      <sqlfromfile>F</sqlfromfile>
      <sqlfilename/>
      <sendOneStatement>F</sendOneStatement>
      <connection>4SBI_Staging</connection>
      <parallel>N</parallel>
      <draw>Y</draw>
      <nr>0</nr>
      <xloc>972</xloc>
      <yloc>117</yloc>
    </entry>
    <entry>
      <name>Delete FACT_POLICY</name>
      <description/>
      <type>SQL</type>
      <sql>declare
v_ret pls_integer :=0;
begin

  for i in (select month_id from tmp_fpc_genmonths order by month_id)
  loop
 	delete from fact_policy where month_id= i.month_id and SOURCE_SYSTEM = 'OASIS';
 	commit;
  end loop;
end;

</sql>
      <useVariableSubstitution>F</useVariableSubstitution>
      <sqlfromfile>F</sqlfromfile>
      <sqlfilename/>
      <sendOneStatement>T</sendOneStatement>
      <connection>4SBI_DataWarehouse</connection>
      <parallel>N</parallel>
      <draw>Y</draw>
      <nr>0</nr>
      <xloc>461</xloc>
      <yloc>283</yloc>
    </entry>
    <entry>
      <name>TR_POPULATE_FACT_POLICY</name>
      <description/>
      <type>TRANS</type>
      <specification_method>rep_name</specification_method>
      <trans_object_id/>
      <filename/>
      <transname>TR_POPULATE_FACT_POLICY</transname>
      <directory>/public/ETL/Facts/Transformations</directory>
      <arg_from_previous>N</arg_from_previous>
      <params_from_previous>N</params_from_previous>
      <exec_per_row>N</exec_per_row>
      <clear_rows>N</clear_rows>
      <clear_files>N</clear_files>
      <set_logfile>N</set_logfile>
      <logfile/>
      <logext/>
      <add_date>N</add_date>
      <add_time>N</add_time>
      <loglevel>Basic</loglevel>
      <cluster>N</cluster>
      <slave_server_name/>
      <set_append_logfile>N</set_append_logfile>
      <wait_until_finished>Y</wait_until_finished>
      <follow_abort_remote>N</follow_abort_remote>
      <create_parent_folder>N</create_parent_folder>
      <logging_remote_work>N</logging_remote_work>
      <run_configuration/>
      <parameters>
        <pass_all_parameters>Y</pass_all_parameters>
      </parameters>
      <parallel>N</parallel>
      <draw>Y</draw>
      <nr>0</nr>
      <xloc>346</xloc>
      <yloc>201</yloc>
    </entry>
    <entry>
      <name>Create TMP_FACT_POL_MAXPOLICY_ID</name>
      <description/>
      <type>SQL</type>
      <sql>create table TMP_FACT_POL_MAXPOLICY_ID
nologging tablespace ${G_STAGING_DB_DATA}
as
SELECT fpc1.month_id,
       dp1.pol_uniqueid, 
       MAX(fpc1.policy_id) MAX_POL_ID
  FROM fact_policycoverage fpc1, 
       dim_policy dp1,
       tmp_fpc_genmonths G
 WHERE 1 = 1
   AND fpc1.month_id = g.month_id
   AND fpc1.policy_id = dp1.policy_id
group  by fpc1.month_id, dp1.pol_uniqueid;
</sql>
      <useVariableSubstitution>T</useVariableSubstitution>
      <sqlfromfile>F</sqlfromfile>
      <sqlfilename/>
      <sendOneStatement>F</sendOneStatement>
      <connection>4SBI_DataWarehouse</connection>
      <parallel>N</parallel>
      <draw>Y</draw>
      <nr>0</nr>
      <xloc>978</xloc>
      <yloc>283</yloc>
    </entry>
    <entry>
      <name>Create TMP_FACT_POL_NEWPOLICY_ID</name>
      <description/>
      <type>SQL</type>
      <sql>create table TMP_FACT_POL_NEWPOLICY_ID
nologging tablespace ${G_STAGING_DB_DATA}
as
SELECT x.month_id,
       x.policy_id,
       x.New_Policyextension_ID,
       x.New_Policyeffdate_ID,
       x.New_Policyexpdate_ID,
       x.New_Policystatus_ID
FROM (       
SELECT fpc1.month_id,
       fpc1.policy_id, 
       fpc1.policyextension_id New_Policyextension_ID, 
       fpc1.policyeffectivedate_id New_Policyeffdate_ID, 
       fpc1.policyexpirationdate_id New_Policyexpdate_ID, 
       fpc1.policystatus_id New_Policystatus_ID,
       row_number() OVER (PARTITION BY fpc1.month_id, fpc1.policy_id ORDER BY fpc1.coverageexpirationdate_id DESC) pick
FROM   fact_policycoverage fpc1,
       tmp_fpc_genmonths G
WHERE  fpc1.month_id = g.month_id) x
WHERE  x.pick = 1;
</sql>
      <useVariableSubstitution>T</useVariableSubstitution>
      <sqlfromfile>F</sqlfromfile>
      <sqlfilename/>
      <sendOneStatement>F</sendOneStatement>
      <connection>4SBI_DataWarehouse</connection>
      <parallel>N</parallel>
      <draw>Y</draw>
      <nr>0</nr>
      <xloc>844</xloc>
      <yloc>201</yloc>
    </entry>
    <entry>
      <name>Create TMP_FACT_POLICY_INPUT2</name>
      <description/>
      <type>SQL</type>
      <sql>create table TMP_FACT_POLICY_INPUT2
nologging tablespace ${G_STAGING_DB_DATA}
as
SELECT p1.*,
       m.MAX_POL_ID
FROM   TMP_FACT_POLICY_INPUT p1,
       TMP_FACT_POL_MAXPOLICY_ID m
WHERE  p1.month_id = m.month_id
AND    p1.pol_uniqueid = m.pol_uniqueid;
</sql>
      <useVariableSubstitution>T</useVariableSubstitution>
      <sqlfromfile>F</sqlfromfile>
      <sqlfilename/>
      <sendOneStatement>F</sendOneStatement>
      <connection>4SBI_Staging</connection>
      <parallel>N</parallel>
      <draw>Y</draw>
      <nr>0</nr>
      <xloc>713</xloc>
      <yloc>283</yloc>
    </entry>
    <entry>
      <name>Create TMP_FACT_POLICY_INPUT3</name>
      <description/>
      <type>SQL</type>
      <sql>create table TMP_FACT_POLICY_INPUT3
nologging tablespace ${G_STAGING_DB_DATA}
as
SELECT p2.month_id,
       p2.UNDERWRITER_ID,
       p2.producer_id,
       p2.product_id,
       p2.company_id,
       p2.firstinsured_id,
       p2.secondinsured_id,
       p2.thirdinsured_id,
       p2.firstotherinterest_id,
       p2.secondotherinterest_id,
       n.policy_id NEW_POLICY_ID,
       n.new_policyextension_id,
       n.new_policyeffdate_id,
       n.new_policyexpdate_id,
       n.new_policystatus_id,
       p2.territory_id,
       p2.policyneworrenewal,
       -- Jma 02/09/2017 Add following fields for VL merge
       OFFERINGCOMPANY_ID,
       AGENT_ID,
       STATE_ID,
       SOURCE_SYSTEM,
       -- End update
       Sum(ALC_EXP_PD_AMT) ALC_EXP_PD_AMT,
       Sum(ALC_EXP_PD_AMT_ITD) ALC_EXP_PD_AMT_ITD,
       Sum(ALC_EXP_PD_AMT_YTD) ALC_EXP_PD_AMT_YTD,
       Sum(ALC_EXP_RSRV_CHNG_AMT) ALC_EXP_RSRV_CHNG_AMT,
       Sum(ALC_EXP_RSRV_CHNG_AMT_ITD) ALC_EXP_RSRV_CHNG_AMT_ITD,
       Sum(ALC_EXP_RSRV_CHNG_AMT_YTD) ALC_EXP_RSRV_CHNG_AMT_YTD,
       Sum(AUDIT_PREM_AMT) AUDIT_PREM_AMT,
       Sum(AUDIT_PREM_AMT_ITD) AUDIT_PREM_AMT_ITD,
       Sum(AUDIT_PREM_AMT_YTD) AUDIT_PREM_AMT_YTD,
       Sum(CNCL_PREM_AMT) CNCL_PREM_AMT,
       Sum(CNCL_PREM_AMT_ITD) CNCL_PREM_AMT_ITD,
       Sum(CNCL_PREM_AMT_YTD) CNCL_PREM_AMT_YTD,
       Sum(COMM_AMT) COMM_AMT,
       Sum(COMM_AMT_ITD) COMM_AMT_ITD,
       Sum(COMM_AMT_YTD) COMM_AMT_YTD,
       Sum(EARNED_PREM_AMT) EARNED_PREM_AMT,
       Sum(EARNED_PREM_AMT_ITD) EARNED_PREM_AMT_ITD,
       Sum(EARNED_PREM_AMT_YTD) EARNED_PREM_AMT_YTD,
       Sum(ENDORSE_PREM_AMT) ENDORSE_PREM_AMT,
       Sum(ENDORSE_PREM_AMT_ITD) ENDORSE_PREM_AMT_ITD,
       Sum(ENDORSE_PREM_AMT_YTD) ENDORSE_PREM_AMT_YTD,
       Sum(FEES_AMT) FEES_AMT,
       Sum(FEES_AMT_ITD) FEES_AMT_ITD,
       Sum(FEES_AMT_YTD) FEES_AMT_YTD,
       Sum(LOSS_PD_AMT) LOSS_PD_AMT,
       Sum(LOSS_PD_AMT_ITD) LOSS_PD_AMT_ITD,
       Sum(LOSS_PD_AMT_YTD) LOSS_PD_AMT_YTD,
       Sum(LOSS_RSRV_CHNG_AMT) LOSS_RSRV_CHNG_AMT,
       Sum(LOSS_RSRV_CHNG_AMT_ITD) LOSS_RSRV_CHNG_AMT_ITD,
       Sum(LOSS_RSRV_CHNG_AMT_YTD) LOSS_RSRV_CHNG_AMT_YTD,
       Sum(MAN_WRTN_PREM_AMT) MAN_WRTN_PREM_AMT,
       Sum(MAN_WRTN_PREM_AMT_ITD) MAN_WRTN_PREM_AMT_ITD,
       Sum(MAN_WRTN_PREM_AMT_YTD) MAN_WRTN_PREM_AMT_YTD,
       Sum(ORIG_WRTN_PREM_AMT) ORIG_WRTN_PREM_AMT,
       Sum(ORIG_WRTN_PREM_AMT_ITD) ORIG_WRTN_PREM_AMT_ITD,
       Sum(ORIG_WRTN_PREM_AMT_YTD) ORIG_WRTN_PREM_AMT_YTD,
       Sum(REIN_PREM_AMT) REIN_PREM_AMT,
       Sum(REIN_PREM_AMT_ITD) REIN_PREM_AMT_ITD,
       Sum(REIN_PREM_AMT_YTD) REIN_PREM_AMT_YTD,
       Sum(SALVAGE_CHNG_AMT) SALVAGE_CHNG_AMT,
       Sum(SALVAGE_CHNG_AMT_ITD) SALVAGE_CHNG_AMT_ITD,
       Sum(SALVAGE_CHNG_AMT_YTD) SALVAGE_CHNG_AMT_YTD,
       Sum(SUBRO_CHNG_AMT) SUBRO_CHNG_AMT,
       Sum(SUBRO_CHNG_AMT_ITD) SUBRO_CHNG_AMT_ITD,
       Sum(SUBRO_CHNG_AMT_YTD) SUBRO_CHNG_AMT_YTD,
       Sum(TAXES_AMT) TAXES_AMT,
       Sum(TAXES_AMT_ITD) TAXES_AMT_ITD,
       Sum(TAXES_AMT_YTD) TAXES_AMT_YTD,
       Sum(TERM_PREM_AMT) TERM_PREM_AMT,
       Sum(TERM_PREM_AMT_ITD) TERM_PREM_AMT_ITD,
       Sum(TERM_PREM_AMT_YTD) TERM_PREM_AMT_YTD,
       Sum(UALC_EXP_PD_AMT) UALC_EXP_PD_AMT,
       Sum(UALC_EXP_PD_AMT_ITD) UALC_EXP_PD_AMT_ITD,
       Sum(UALC_EXP_PD_AMT_YTD) UALC_EXP_PD_AMT_YTD,
       Sum(UALC_EXP_RSRV_CHNG_AMT) UALC_EXP_RSRV_CHNG_AMT,
       Sum(UALC_EXP_RSRV_CHNG_AMT_ITD) UALC_EXP_RSRV_CHNG_AMT_ITD,
       Sum(UALC_EXP_RSRV_CHNG_AMT_YTD) UALC_EXP_RSRV_CHNG_AMT_YTD,
       Sum(UNEARNED_PREM) UNEARNED_PREM,
       Sum(WRTN_PREM_AMT) WRTN_PREM_AMT,
       Sum(WRTN_PREM_AMT_ITD) WRTN_PREM_AMT_ITD,
       Sum(WRTN_PREM_AMT_YTD) WRTN_PREM_AMT_YTD,
       Sum(p2.USR_DEF_AMT1) USR_DEF_AMT1,
       Sum(p2.USR_DEF_AMT_YTD1) USR_DEF_AMT_YTD1,
       Sum(p2.USR_DEF_AMT_ITD1) USR_DEF_AMT_ITD1,
       Sum(p2.USR_DEF_AMT2) USR_DEF_AMT2,
       Sum(p2.USR_DEF_AMT_YTD2) USR_DEF_AMT_YTD2,
       Sum(p2.USR_DEF_AMT_ITD2) USR_DEF_AMT_ITD2,
       Sum(p2.USR_DEF_AMT3) USR_DEF_AMT3,
       Sum(p2.USR_DEF_AMT_YTD3) USR_DEF_AMT_YTD3,
       Sum(p2.USR_DEF_AMT_ITD3) USR_DEF_AMT_ITD3,
       Sum(p2.USR_DEF_AMT4) USR_DEF_AMT4,
       Sum(p2.USR_DEF_AMT_YTD4) USR_DEF_AMT_YTD4,
       Sum(p2.USR_DEF_AMT_ITD4) USR_DEF_AMT_ITD4,
       Sum(p2.USR_DEF_AMT5) USR_DEF_AMT5,
       Sum(p2.USR_DEF_AMT_YTD5) USR_DEF_AMT_YTD5,
       Sum(p2.USR_DEF_AMT_ITD5) USR_DEF_AMT_ITD5,
       Sum(p2.FPC_USR_DEF_AMT1) FPC_USR_DEF_AMT1,
       Sum(p2.FPC_USR_DEF_AMT_YTD1) FPC_USR_DEF_AMT_YTD1,
       Sum(p2.FPC_USR_DEF_AMT_ITD1) FPC_USR_DEF_AMT_ITD1,
       Sum(p2.FPC_USR_DEF_AMT2) FPC_USR_DEF_AMT2,
       Sum(p2.FPC_USR_DEF_AMT_YTD2) FPC_USR_DEF_AMT_YTD2,
       Sum(p2.FPC_USR_DEF_AMT_ITD2) FPC_USR_DEF_AMT_ITD2,
       Sum(p2.FPC_USR_DEF_AMT3) FPC_USR_DEF_AMT3,
       Sum(p2.FPC_USR_DEF_AMT_YTD3) FPC_USR_DEF_AMT_YTD3,
       Sum(p2.FPC_USR_DEF_AMT_ITD3) FPC_USR_DEF_AMT_ITD3,
       Sum(p2.FPC_USR_DEF_AMT4) FPC_USR_DEF_AMT4,
       Sum(p2.FPC_USR_DEF_AMT_YTD4) FPC_USR_DEF_AMT_YTD4,
       Sum(p2.FPC_USR_DEF_AMT_ITD4) FPC_USR_DEF_AMT_ITD4,
       Sum(p2.FPC_USR_DEF_AMT5) FPC_USR_DEF_AMT5,
       Sum(p2.FPC_USR_DEF_AMT_YTD5) FPC_USR_DEF_AMT_YTD5,
       Sum(p2.FPC_USR_DEF_AMT_ITD5) FPC_USR_DEF_AMT_ITD5,
       Sum(p2.FPC_USR_DEF_AMT6) FPC_USR_DEF_AMT6,
       Sum(p2.FPC_USR_DEF_AMT_YTD6) FPC_USR_DEF_AMT_YTD6,
       Sum(p2.FPC_USR_DEF_AMT_ITD6) FPC_USR_DEF_AMT_ITD6,
       Sum(p2.FPC_USR_DEF_AMT7) FPC_USR_DEF_AMT7,
       Sum(p2.FPC_USR_DEF_AMT_YTD7) FPC_USR_DEF_AMT_YTD7,
       Sum(p2.FPC_USR_DEF_AMT_ITD7) FPC_USR_DEF_AMT_ITD7,
       Sum(p2.FPC_USR_DEF_AMT8) FPC_USR_DEF_AMT8,
       Sum(p2.FPC_USR_DEF_AMT_YTD8) FPC_USR_DEF_AMT_YTD8,
       Sum(p2.FPC_USR_DEF_AMT_ITD8) FPC_USR_DEF_AMT_ITD8,
       Sum(p2.FPC_USR_DEF_AMT9) FPC_USR_DEF_AMT9,
       Sum(p2.FPC_USR_DEF_AMT_YTD9) FPC_USR_DEF_AMT_YTD9,
       Sum(p2.FPC_USR_DEF_AMT_ITD9) FPC_USR_DEF_AMT_ITD9,
       Sum(p2.FPC_USR_DEF_AMT10) FPC_USR_DEF_AMT10,
       Sum(p2.FPC_USR_DEF_AMT_YTD10) FPC_USR_DEF_AMT_YTD10,
       Sum(p2.FPC_USR_DEF_AMT_ITD10) FPC_USR_DEF_AMT_ITD10,
       Sum(p2.FPC_USR_DEF_AMT11) FPC_USR_DEF_AMT11,
       Sum(p2.FPC_USR_DEF_AMT_YTD11) FPC_USR_DEF_AMT_YTD11,
       Sum(p2.FPC_USR_DEF_AMT_ITD11) FPC_USR_DEF_AMT_ITD11,
       Sum(p2.FPC_USR_DEF_AMT12) FPC_USR_DEF_AMT12,
       Sum(p2.FPC_USR_DEF_AMT_YTD12) FPC_USR_DEF_AMT_YTD12,
       Sum(p2.FPC_USR_DEF_AMT_ITD12) FPC_USR_DEF_AMT_ITD12,
       Sum(p2.FPC_USR_DEF_AMT13) FPC_USR_DEF_AMT13,
       Sum(p2.FPC_USR_DEF_AMT_YTD13) FPC_USR_DEF_AMT_YTD13,
       Sum(p2.FPC_USR_DEF_AMT_ITD13) FPC_USR_DEF_AMT_ITD13,
       Sum(p2.FPC_USR_DEF_AMT14) FPC_USR_DEF_AMT14,
       Sum(p2.FPC_USR_DEF_AMT_YTD14) FPC_USR_DEF_AMT_YTD14,
       Sum(p2.FPC_USR_DEF_AMT_ITD14) FPC_USR_DEF_AMT_ITD14,
       Sum(p2.FPC_USR_DEF_AMT15) FPC_USR_DEF_AMT15,
       Sum(p2.FPC_USR_DEF_AMT_YTD15) FPC_USR_DEF_AMT_YTD15,
       Sum(p2.FPC_USR_DEF_AMT_ITD15) FPC_USR_DEF_AMT_ITD15,
       Sum(p2.FPC_USR_DEF_AMT16) FPC_USR_DEF_AMT16,
       Sum(p2.FPC_USR_DEF_AMT_YTD16) FPC_USR_DEF_AMT_YTD16,
       Sum(p2.FPC_USR_DEF_AMT_ITD16) FPC_USR_DEF_AMT_ITD16,
       Sum(p2.FPC_USR_DEF_AMT17) FPC_USR_DEF_AMT17,
       Sum(p2.FPC_USR_DEF_AMT_YTD17) FPC_USR_DEF_AMT_YTD17,
       Sum(p2.FPC_USR_DEF_AMT_ITD17) FPC_USR_DEF_AMT_ITD17,
       Sum(p2.FPC_USR_DEF_AMT18) FPC_USR_DEF_AMT18,
       Sum(p2.FPC_USR_DEF_AMT_YTD18) FPC_USR_DEF_AMT_YTD18,
       Sum(p2.FPC_USR_DEF_AMT_ITD18) FPC_USR_DEF_AMT_ITD18,
       Sum(p2.FPC_USR_DEF_AMT19) FPC_USR_DEF_AMT19,
       Sum(p2.FPC_USR_DEF_AMT_YTD19) FPC_USR_DEF_AMT_YTD19,
       Sum(p2.FPC_USR_DEF_AMT_ITD19) FPC_USR_DEF_AMT_ITD19,
       Sum(p2.FPC_USR_DEF_AMT20) FPC_USR_DEF_AMT20,
       Sum(p2.FPC_USR_DEF_AMT_YTD20) FPC_USR_DEF_AMT_YTD20,
       Sum(p2.FPC_USR_DEF_AMT_ITD20) FPC_USR_DEF_AMT_ITD20,
       Sum(p2.FPC_USR_DEF_AMT21) FPC_USR_DEF_AMT21,
       Sum(p2.FPC_USR_DEF_AMT_YTD21) FPC_USR_DEF_AMT_YTD21,
       Sum(p2.FPC_USR_DEF_AMT_ITD21) FPC_USR_DEF_AMT_ITD21,
       Sum(p2.FPC_USR_DEF_AMT22) FPC_USR_DEF_AMT22,
       Sum(p2.FPC_USR_DEF_AMT_YTD22) FPC_USR_DEF_AMT_YTD22,
       Sum(p2.FPC_USR_DEF_AMT_ITD22) FPC_USR_DEF_AMT_ITD22,
       Sum(p2.FPC_USR_DEF_AMT23) FPC_USR_DEF_AMT23,
       Sum(p2.FPC_USR_DEF_AMT_YTD23) FPC_USR_DEF_AMT_YTD23,
       Sum(p2.FPC_USR_DEF_AMT_ITD23) FPC_USR_DEF_AMT_ITD23,
       Sum(p2.FPC_USR_DEF_AMT24) FPC_USR_DEF_AMT24,
       Sum(p2.FPC_USR_DEF_AMT_YTD24) FPC_USR_DEF_AMT_YTD24,
       Sum(p2.FPC_USR_DEF_AMT_ITD24) FPC_USR_DEF_AMT_ITD24,
       Sum(p2.FPC_USR_DEF_AMT25) FPC_USR_DEF_AMT25,
       Sum(p2.FPC_USR_DEF_AMT_YTD25) FPC_USR_DEF_AMT_YTD25,
       Sum(p2.FPC_USR_DEF_AMT_ITD25) FPC_USR_DEF_AMT_ITD25,
       Sum(p2.FPC_USR_DEF_AMT26) FPC_USR_DEF_AMT26,
       Sum(p2.FPC_USR_DEF_AMT_YTD26) FPC_USR_DEF_AMT_YTD26,
       Sum(p2.FPC_USR_DEF_AMT_ITD26) FPC_USR_DEF_AMT_ITD26,
       Sum(p2.FPC_USR_DEF_AMT27) FPC_USR_DEF_AMT27,
       Sum(p2.FPC_USR_DEF_AMT_YTD27) FPC_USR_DEF_AMT_YTD27,
       Sum(p2.FPC_USR_DEF_AMT_ITD27) FPC_USR_DEF_AMT_ITD27,
       Sum(p2.FPC_USR_DEF_AMT28) FPC_USR_DEF_AMT28,
       Sum(p2.FPC_USR_DEF_AMT_YTD28) FPC_USR_DEF_AMT_YTD28,
       Sum(p2.FPC_USR_DEF_AMT_ITD28) FPC_USR_DEF_AMT_ITD28,
       Sum(p2.FPC_USR_DEF_AMT29) FPC_USR_DEF_AMT29,
       Sum(p2.FPC_USR_DEF_AMT_YTD29) FPC_USR_DEF_AMT_YTD29,
       Sum(p2.FPC_USR_DEF_AMT_ITD29) FPC_USR_DEF_AMT_ITD29,
       Sum(p2.FPC_USR_DEF_AMT30) FPC_USR_DEF_AMT30,
       Sum(p2.FPC_USR_DEF_AMT_YTD30) FPC_USR_DEF_AMT_YTD30,
       Sum(p2.FPC_USR_DEF_AMT_ITD30) FPC_USR_DEF_AMT_ITD30
FROM   TMP_FACT_POLICY_INPUT2 p2,
       TMP_FACT_POL_NEWPOLICY_ID n
WHERE  p2.month_id = n.month_id
AND    p2.max_pol_id = n.policy_id 
GROUP  BY p2.month_id,
       p2.UNDERWRITER_ID,
       p2.producer_id,
       p2.product_id,
       p2.company_id,
       p2.firstinsured_id,
       p2.secondinsured_id,
       p2.thirdinsured_id,
       p2.firstotherinterest_id,
       p2.secondotherinterest_id,
       n.policy_id,
       n.new_policyextension_id,
       n.new_policyeffdate_id,
       n.new_policyexpdate_id,
       n.new_policystatus_id,
       p2.territory_id,
       p2.policyneworrenewal,
       -- Jma 02/09/2017 Add following fields for VL merge
       OFFERINGCOMPANY_ID,
       AGENT_ID,
       STATE_ID,
       SOURCE_SYSTEM
       -- End update  
ORDER BY p2.month_id, n.policy_id;
</sql>
      <useVariableSubstitution>T</useVariableSubstitution>
      <sqlfromfile>F</sqlfromfile>
      <sqlfilename/>
      <sendOneStatement>F</sendOneStatement>
      <connection>4SBI_DataWarehouse</connection>
      <parallel>N</parallel>
      <draw>Y</draw>
      <nr>0</nr>
      <xloc>575</xloc>
      <yloc>201</yloc>
    </entry>
    <entry>
      <name>Success</name>
      <description/>
      <type>SUCCESS</type>
      <parallel>N</parallel>
      <draw>Y</draw>
      <nr>0</nr>
      <xloc>264</xloc>
      <yloc>283</yloc>
    </entry>
  </entries>
  <hops>
    <hop>
      <from>START</from>
      <to>TR_Drop_TMP_FACT_POLICY_Tables</to>
      <from_nr>0</from_nr>
      <to_nr>0</to_nr>
      <enabled>Y</enabled>
      <evaluation>Y</evaluation>
      <unconditional>Y</unconditional>
    </hop>
    <hop>
      <from>TR_Drop_TMP_FACT_POLICY_Tables</from>
      <to>TR_SET_ID_KEY_VARIABLES</to>
      <from_nr>0</from_nr>
      <to_nr>0</to_nr>
      <enabled>Y</enabled>
      <evaluation>Y</evaluation>
      <unconditional>N</unconditional>
    </hop>
    <hop>
      <from>Create tmp_fpc_PTRANS_dates </from>
      <to>Create tmp_fpc_CTRANS_dates</to>
      <from_nr>0</from_nr>
      <to_nr>0</to_nr>
      <enabled>Y</enabled>
      <evaluation>Y</evaluation>
      <unconditional>N</unconditional>
    </hop>
    <hop>
      <from>Create tmp_fpc_CTRANS_dates</from>
      <to>Create tmp_fpc_acct_period</to>
      <from_nr>0</from_nr>
      <to_nr>0</to_nr>
      <enabled>Y</enabled>
      <evaluation>Y</evaluation>
      <unconditional>N</unconditional>
    </hop>
    <hop>
      <from>Create tmp_fpc_acct_period</from>
      <to>Create tmp_fpc_period</to>
      <from_nr>0</from_nr>
      <to_nr>0</to_nr>
      <enabled>Y</enabled>
      <evaluation>Y</evaluation>
      <unconditional>N</unconditional>
    </hop>
    <hop>
      <from>Create tmp_fpc_period</from>
      <to>Create tmp_fpc_genmonths</to>
      <from_nr>0</from_nr>
      <to_nr>0</to_nr>
      <enabled>Y</enabled>
      <evaluation>Y</evaluation>
      <unconditional>N</unconditional>
    </hop>
    <hop>
      <from>Create tmp_fpc_genmonths</from>
      <to>Create TMP_FACT_POLICY_INPUT</to>
      <from_nr>0</from_nr>
      <to_nr>0</to_nr>
      <enabled>Y</enabled>
      <evaluation>Y</evaluation>
      <unconditional>N</unconditional>
    </hop>
    <hop>
      <from>Create TMP_FACT_POLICY_INPUT</from>
      <to>Create TMP_FACT_POL_MAXPOLICY_ID</to>
      <from_nr>0</from_nr>
      <to_nr>0</to_nr>
      <enabled>Y</enabled>
      <evaluation>Y</evaluation>
      <unconditional>N</unconditional>
    </hop>
    <hop>
      <from>Create TMP_FACT_POL_MAXPOLICY_ID</from>
      <to>Create TMP_FACT_POL_NEWPOLICY_ID</to>
      <from_nr>0</from_nr>
      <to_nr>0</to_nr>
      <enabled>Y</enabled>
      <evaluation>Y</evaluation>
      <unconditional>N</unconditional>
    </hop>
    <hop>
      <from>Create TMP_FACT_POL_NEWPOLICY_ID</from>
      <to>Create TMP_FACT_POLICY_INPUT2</to>
      <from_nr>0</from_nr>
      <to_nr>0</to_nr>
      <enabled>Y</enabled>
      <evaluation>Y</evaluation>
      <unconditional>N</unconditional>
    </hop>
    <hop>
      <from>Create TMP_FACT_POLICY_INPUT2</from>
      <to>Create TMP_FACT_POLICY_INPUT3</to>
      <from_nr>0</from_nr>
      <to_nr>0</to_nr>
      <enabled>Y</enabled>
      <evaluation>Y</evaluation>
      <unconditional>N</unconditional>
    </hop>
    <hop>
      <from>Create TMP_FACT_POLICY_INPUT3</from>
      <to>Delete FACT_POLICY</to>
      <from_nr>0</from_nr>
      <to_nr>0</to_nr>
      <enabled>Y</enabled>
      <evaluation>Y</evaluation>
      <unconditional>N</unconditional>
    </hop>
    <hop>
      <from>Delete FACT_POLICY</from>
      <to>TR_POPULATE_FACT_POLICY</to>
      <from_nr>0</from_nr>
      <to_nr>0</to_nr>
      <enabled>Y</enabled>
      <evaluation>Y</evaluation>
      <unconditional>N</unconditional>
    </hop>
    <hop>
      <from>TR_POPULATE_FACT_POLICY</from>
      <to>Success</to>
      <from_nr>0</from_nr>
      <to_nr>0</to_nr>
      <enabled>Y</enabled>
      <evaluation>Y</evaluation>
      <unconditional>N</unconditional>
    </hop>
    <hop>
      <from>TR_SET_ID_KEY_VARIABLES</from>
      <to>Create tmp_fpc_PTRANS_dates </to>
      <from_nr>0</from_nr>
      <to_nr>0</to_nr>
      <enabled>Y</enabled>
      <evaluation>Y</evaluation>
      <unconditional>N</unconditional>
    </hop>
  </hops>
  <notepads>
  </notepads>
</job>
