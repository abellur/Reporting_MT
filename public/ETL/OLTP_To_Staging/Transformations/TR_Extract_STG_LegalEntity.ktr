<transformation>
  <info>
    <name>TR_Extract_STG_LegalEntity</name>
    <description>Extract data to STG_LegalEntity table</description>
    <extended_description>Date         By     Description
04/27/2016   Jma    Updated Get Entity w/ Addr Chg step for daily refresh mode to not check entity role fk or entity class fk.
                    Updated Entity Role and Entity Class steps to include the scenarios when only ENTITY data is updated.</extended_description>
    <trans_version/>
    <trans_type>Normal</trans_type>
    <trans_status>1</trans_status>
    <directory>/public/ETL/OLTP_To_Staging/Transformations</directory>
    <parameters>
    </parameters>
    <log>
      <trans-log-table>
        <connection/>
        <schema/>
        <table/>
        <size_limit_lines/>
        <interval/>
        <timeout_days/>
        <field>
          <id>ID_BATCH</id>
          <enabled>Y</enabled>
          <name>ID_BATCH</name>
        </field>
        <field>
          <id>CHANNEL_ID</id>
          <enabled>Y</enabled>
          <name>CHANNEL_ID</name>
        </field>
        <field>
          <id>TRANSNAME</id>
          <enabled>Y</enabled>
          <name>TRANSNAME</name>
        </field>
        <field>
          <id>STATUS</id>
          <enabled>Y</enabled>
          <name>STATUS</name>
        </field>
        <field>
          <id>LINES_READ</id>
          <enabled>Y</enabled>
          <name>LINES_READ</name>
          <subject/>
        </field>
        <field>
          <id>LINES_WRITTEN</id>
          <enabled>Y</enabled>
          <name>LINES_WRITTEN</name>
          <subject/>
        </field>
        <field>
          <id>LINES_UPDATED</id>
          <enabled>Y</enabled>
          <name>LINES_UPDATED</name>
          <subject/>
        </field>
        <field>
          <id>LINES_INPUT</id>
          <enabled>Y</enabled>
          <name>LINES_INPUT</name>
          <subject/>
        </field>
        <field>
          <id>LINES_OUTPUT</id>
          <enabled>Y</enabled>
          <name>LINES_OUTPUT</name>
          <subject/>
        </field>
        <field>
          <id>LINES_REJECTED</id>
          <enabled>Y</enabled>
          <name>LINES_REJECTED</name>
          <subject/>
        </field>
        <field>
          <id>ERRORS</id>
          <enabled>Y</enabled>
          <name>ERRORS</name>
        </field>
        <field>
          <id>STARTDATE</id>
          <enabled>Y</enabled>
          <name>STARTDATE</name>
        </field>
        <field>
          <id>ENDDATE</id>
          <enabled>Y</enabled>
          <name>ENDDATE</name>
        </field>
        <field>
          <id>LOGDATE</id>
          <enabled>Y</enabled>
          <name>LOGDATE</name>
        </field>
        <field>
          <id>DEPDATE</id>
          <enabled>Y</enabled>
          <name>DEPDATE</name>
        </field>
        <field>
          <id>REPLAYDATE</id>
          <enabled>Y</enabled>
          <name>REPLAYDATE</name>
        </field>
        <field>
          <id>LOG_FIELD</id>
          <enabled>Y</enabled>
          <name>LOG_FIELD</name>
        </field>
        <field>
          <id>EXECUTING_SERVER</id>
          <enabled>N</enabled>
          <name>EXECUTING_SERVER</name>
        </field>
        <field>
          <id>EXECUTING_USER</id>
          <enabled>N</enabled>
          <name>EXECUTING_USER</name>
        </field>
        <field>
          <id>CLIENT</id>
          <enabled>N</enabled>
          <name>CLIENT</name>
        </field>
      </trans-log-table>
      <perf-log-table>
        <connection/>
        <schema/>
        <table/>
        <interval/>
        <timeout_days/>
        <field>
          <id>ID_BATCH</id>
          <enabled>Y</enabled>
          <name>ID_BATCH</name>
        </field>
        <field>
          <id>SEQ_NR</id>
          <enabled>Y</enabled>
          <name>SEQ_NR</name>
        </field>
        <field>
          <id>LOGDATE</id>
          <enabled>Y</enabled>
          <name>LOGDATE</name>
        </field>
        <field>
          <id>TRANSNAME</id>
          <enabled>Y</enabled>
          <name>TRANSNAME</name>
        </field>
        <field>
          <id>STEPNAME</id>
          <enabled>Y</enabled>
          <name>STEPNAME</name>
        </field>
        <field>
          <id>STEP_COPY</id>
          <enabled>Y</enabled>
          <name>STEP_COPY</name>
        </field>
        <field>
          <id>LINES_READ</id>
          <enabled>Y</enabled>
          <name>LINES_READ</name>
        </field>
        <field>
          <id>LINES_WRITTEN</id>
          <enabled>Y</enabled>
          <name>LINES_WRITTEN</name>
        </field>
        <field>
          <id>LINES_UPDATED</id>
          <enabled>Y</enabled>
          <name>LINES_UPDATED</name>
        </field>
        <field>
          <id>LINES_INPUT</id>
          <enabled>Y</enabled>
          <name>LINES_INPUT</name>
        </field>
        <field>
          <id>LINES_OUTPUT</id>
          <enabled>Y</enabled>
          <name>LINES_OUTPUT</name>
        </field>
        <field>
          <id>LINES_REJECTED</id>
          <enabled>Y</enabled>
          <name>LINES_REJECTED</name>
        </field>
        <field>
          <id>ERRORS</id>
          <enabled>Y</enabled>
          <name>ERRORS</name>
        </field>
        <field>
          <id>INPUT_BUFFER_ROWS</id>
          <enabled>Y</enabled>
          <name>INPUT_BUFFER_ROWS</name>
        </field>
        <field>
          <id>OUTPUT_BUFFER_ROWS</id>
          <enabled>Y</enabled>
          <name>OUTPUT_BUFFER_ROWS</name>
        </field>
      </perf-log-table>
      <channel-log-table>
        <connection/>
        <schema/>
        <table/>
        <timeout_days/>
        <field>
          <id>ID_BATCH</id>
          <enabled>Y</enabled>
          <name>ID_BATCH</name>
        </field>
        <field>
          <id>CHANNEL_ID</id>
          <enabled>Y</enabled>
          <name>CHANNEL_ID</name>
        </field>
        <field>
          <id>LOG_DATE</id>
          <enabled>Y</enabled>
          <name>LOG_DATE</name>
        </field>
        <field>
          <id>LOGGING_OBJECT_TYPE</id>
          <enabled>Y</enabled>
          <name>LOGGING_OBJECT_TYPE</name>
        </field>
        <field>
          <id>OBJECT_NAME</id>
          <enabled>Y</enabled>
          <name>OBJECT_NAME</name>
        </field>
        <field>
          <id>OBJECT_COPY</id>
          <enabled>Y</enabled>
          <name>OBJECT_COPY</name>
        </field>
        <field>
          <id>REPOSITORY_DIRECTORY</id>
          <enabled>Y</enabled>
          <name>REPOSITORY_DIRECTORY</name>
        </field>
        <field>
          <id>FILENAME</id>
          <enabled>Y</enabled>
          <name>FILENAME</name>
        </field>
        <field>
          <id>OBJECT_ID</id>
          <enabled>Y</enabled>
          <name>OBJECT_ID</name>
        </field>
        <field>
          <id>OBJECT_REVISION</id>
          <enabled>Y</enabled>
          <name>OBJECT_REVISION</name>
        </field>
        <field>
          <id>PARENT_CHANNEL_ID</id>
          <enabled>Y</enabled>
          <name>PARENT_CHANNEL_ID</name>
        </field>
        <field>
          <id>ROOT_CHANNEL_ID</id>
          <enabled>Y</enabled>
          <name>ROOT_CHANNEL_ID</name>
        </field>
      </channel-log-table>
      <step-log-table>
        <connection/>
        <schema/>
        <table/>
        <timeout_days/>
        <field>
          <id>ID_BATCH</id>
          <enabled>Y</enabled>
          <name>ID_BATCH</name>
        </field>
        <field>
          <id>CHANNEL_ID</id>
          <enabled>Y</enabled>
          <name>CHANNEL_ID</name>
        </field>
        <field>
          <id>LOG_DATE</id>
          <enabled>Y</enabled>
          <name>LOG_DATE</name>
        </field>
        <field>
          <id>TRANSNAME</id>
          <enabled>Y</enabled>
          <name>TRANSNAME</name>
        </field>
        <field>
          <id>STEPNAME</id>
          <enabled>Y</enabled>
          <name>STEPNAME</name>
        </field>
        <field>
          <id>STEP_COPY</id>
          <enabled>Y</enabled>
          <name>STEP_COPY</name>
        </field>
        <field>
          <id>LINES_READ</id>
          <enabled>Y</enabled>
          <name>LINES_READ</name>
        </field>
        <field>
          <id>LINES_WRITTEN</id>
          <enabled>Y</enabled>
          <name>LINES_WRITTEN</name>
        </field>
        <field>
          <id>LINES_UPDATED</id>
          <enabled>Y</enabled>
          <name>LINES_UPDATED</name>
        </field>
        <field>
          <id>LINES_INPUT</id>
          <enabled>Y</enabled>
          <name>LINES_INPUT</name>
        </field>
        <field>
          <id>LINES_OUTPUT</id>
          <enabled>Y</enabled>
          <name>LINES_OUTPUT</name>
        </field>
        <field>
          <id>LINES_REJECTED</id>
          <enabled>Y</enabled>
          <name>LINES_REJECTED</name>
        </field>
        <field>
          <id>ERRORS</id>
          <enabled>Y</enabled>
          <name>ERRORS</name>
        </field>
        <field>
          <id>LOG_FIELD</id>
          <enabled>N</enabled>
          <name>LOG_FIELD</name>
        </field>
      </step-log-table>
      <metrics-log-table>
        <connection/>
        <schema/>
        <table/>
        <timeout_days/>
        <field>
          <id>ID_BATCH</id>
          <enabled>Y</enabled>
          <name>ID_BATCH</name>
        </field>
        <field>
          <id>CHANNEL_ID</id>
          <enabled>Y</enabled>
          <name>CHANNEL_ID</name>
        </field>
        <field>
          <id>LOG_DATE</id>
          <enabled>Y</enabled>
          <name>LOG_DATE</name>
        </field>
        <field>
          <id>METRICS_DATE</id>
          <enabled>Y</enabled>
          <name>METRICS_DATE</name>
        </field>
        <field>
          <id>METRICS_CODE</id>
          <enabled>Y</enabled>
          <name>METRICS_CODE</name>
        </field>
        <field>
          <id>METRICS_DESCRIPTION</id>
          <enabled>Y</enabled>
          <name>METRICS_DESCRIPTION</name>
        </field>
        <field>
          <id>METRICS_SUBJECT</id>
          <enabled>Y</enabled>
          <name>METRICS_SUBJECT</name>
        </field>
        <field>
          <id>METRICS_TYPE</id>
          <enabled>Y</enabled>
          <name>METRICS_TYPE</name>
        </field>
        <field>
          <id>METRICS_VALUE</id>
          <enabled>Y</enabled>
          <name>METRICS_VALUE</name>
        </field>
      </metrics-log-table>
    </log>
    <maxdate>
      <connection/>
      <table/>
      <field/>
      <offset>0.0</offset>
      <maxdiff>0.0</maxdiff>
    </maxdate>
    <size_rowset>10000</size_rowset>
    <sleep_time_empty>50</sleep_time_empty>
    <sleep_time_full>50</sleep_time_full>
    <unique_connections>N</unique_connections>
    <feedback_shown>Y</feedback_shown>
    <feedback_size>50000</feedback_size>
    <using_thread_priorities>Y</using_thread_priorities>
    <shared_objects_file/>
    <capture_step_performance>N</capture_step_performance>
    <step_performance_capturing_delay>1000</step_performance_capturing_delay>
    <step_performance_capturing_size_limit>100</step_performance_capturing_size_limit>
    <dependencies>
    </dependencies>
    <partitionschemas>
    </partitionschemas>
    <slaveservers>
      <slaveserver>
        <name>4Sight BI - PDI Server</name>
        <hostname>10.0.0.21</hostname>
        <port>9080</port>
        <webAppName>pentaho-di</webAppName>
        <username>joe</username>
        <password>Encrypted 2be98afc86aa7f2e4bb18bd63c99dbdde</password>
        <proxy_hostname/>
        <proxy_port/>
        <non_proxy_hosts/>
        <master>Y</master>
        <sslMode>N</sslMode>
      </slaveserver>
      <slaveserver>
        <name>Carte 1</name>
        <hostname>localhost</hostname>
        <port>9081</port>
        <webAppName/>
        <username>cluster</username>
        <password>Encrypted 2be98afc86aa7f2e4cb1aa265cd86aac8</password>
        <proxy_hostname/>
        <proxy_port/>
        <non_proxy_hosts/>
        <master>N</master>
        <sslMode>N</sslMode>
      </slaveserver>
      <slaveserver>
        <name>DI Server</name>
        <hostname>localhost</hostname>
        <port>9080</port>
        <webAppName>pentaho-di</webAppName>
        <username>joe</username>
        <password>Encrypted 2be98afc86aa7f2e4bb18bd63c99dbdde</password>
        <proxy_hostname/>
        <proxy_port/>
        <non_proxy_hosts/>
        <master>Y</master>
        <sslMode>N</sslMode>
      </slaveserver>
      <slaveserver>
        <name>MM_ETL_DEV</name>
        <hostname>magspentaho</hostname>
        <port>9080</port>
        <webAppName>pentaho-di</webAppName>
        <username>shota</username>
        <password>Encrypted 2be98afc86aa7f2e4cb79ce63d69dbbdb</password>
        <proxy_hostname/>
        <proxy_port/>
        <non_proxy_hosts/>
        <master>Y</master>
        <sslMode>N</sslMode>
      </slaveserver>
      <slaveserver>
        <name>MM_ETL_SERVER</name>
        <hostname>http://magspentaho</hostname>
        <port>9080</port>
        <webAppName>pentaho-di</webAppName>
        <username>shota</username>
        <password>Encrypted 2be98afc86aa7f2e4cb79ce63d69dbbdb</password>
        <proxy_hostname/>
        <proxy_port/>
        <non_proxy_hosts/>
        <master>Y</master>
        <sslMode>N</sslMode>
      </slaveserver>
      <slaveserver>
        <name>MM_ETL_TEST</name>
        <hostname>magspentahotest</hostname>
        <port>9080</port>
        <webAppName>pentaho-di</webAppName>
        <username>admin</username>
        <password>Encrypted 2be98afc86aa7f2e4bb18bd63c99dbdde</password>
        <proxy_hostname/>
        <proxy_port/>
        <non_proxy_hosts/>
        <master>N</master>
        <sslMode>N</sslMode>
      </slaveserver>
      <slaveserver>
        <name>MM_PENTAHO</name>
        <hostname>magspentaho</hostname>
        <port>9080</port>
        <webAppName>pentaho-di</webAppName>
        <username>admin</username>
        <password>Encrypted 2be98afc86aa7f2e4bb18bd63c99dbdde</password>
        <proxy_hostname/>
        <proxy_port/>
        <non_proxy_hosts/>
        <master>N</master>
        <sslMode>N</sslMode>
      </slaveserver>
      <slaveserver>
        <name>MM_PENTAHO_BTS</name>
        <hostname>129.144.25.104</hostname>
        <port>9080</port>
        <webAppName>pentaho-di</webAppName>
        <username>admin</username>
        <password>Encrypted 2be98afc86aa7f2e4bb18bd63c99dbdde</password>
        <proxy_hostname/>
        <proxy_port/>
        <non_proxy_hosts/>
        <master>N</master>
        <sslMode>N</sslMode>
      </slaveserver>
      <slaveserver>
        <name>MM_PENTAHO_DEV</name>
        <hostname>magspentahodev</hostname>
        <port>9080</port>
        <webAppName>pentaho-di</webAppName>
        <username>admin</username>
        <password>Encrypted 2be98afc86aa7f2e4bb18bd63c99dbdde</password>
        <proxy_hostname/>
        <proxy_port/>
        <non_proxy_hosts/>
        <master>Y</master>
        <sslMode>N</sslMode>
      </slaveserver>
      <slaveserver>
        <name>Master</name>
        <hostname>localhost</hostname>
        <port>8081</port>
        <webAppName/>
        <username>cluster</username>
        <password>Encrypted 2be98afc86aa7f2e4cb1aa265cd86aac8</password>
        <proxy_hostname/>
        <proxy_port/>
        <non_proxy_hosts/>
        <master>Y</master>
        <sslMode>N</sslMode>
      </slaveserver>
      <slaveserver>
        <name>SERVER1</name>
        <hostname>LOCALHOST</hostname>
        <port>3306</port>
        <webAppName/>
        <username>root</username>
        <password>Encrypted 2be98afc86aa7f2e4bb18bd63c99dbdde</password>
        <proxy_hostname/>
        <proxy_port/>
        <non_proxy_hosts/>
        <master>Y</master>
        <sslMode>N</sslMode>
      </slaveserver>
      <slaveserver>
        <name>SLAVE ONE</name>
        <hostname>192.168.2.101</hostname>
        <port>3306</port>
        <webAppName/>
        <username>root</username>
        <password>Encrypted 2be98afc86aa7f2e4a418bd63c99dbdde</password>
        <proxy_hostname/>
        <proxy_port/>
        <non_proxy_hosts/>
        <master>Y</master>
        <sslMode>N</sslMode>
      </slaveserver>
      <slaveserver>
        <name>SLAVE TWO</name>
        <hostname>192.168.2.101</hostname>
        <port>3306</port>
        <webAppName/>
        <username>root</username>
        <password>Encrypted 2be98afc86aa7f2e4bb18bd63c99dbdde</password>
        <proxy_hostname/>
        <proxy_port/>
        <non_proxy_hosts/>
        <master>N</master>
        <sslMode>N</sslMode>
      </slaveserver>
      <slaveserver>
        <name>Slave1</name>
        <hostname>localhost</hostname>
        <port>8082</port>
        <webAppName/>
        <username>cluster</username>
        <password>Encrypted 2be98afc86aa7f2e4cb1aa265cd86aac8</password>
        <proxy_hostname/>
        <proxy_port/>
        <non_proxy_hosts/>
        <master>N</master>
        <sslMode>N</sslMode>
      </slaveserver>
      <slaveserver>
        <name>Slave2</name>
        <hostname>localhost</hostname>
        <port>8083</port>
        <webAppName/>
        <username>cluster</username>
        <password>Encrypted 2be98afc86aa7f2e4cb1aa265cd86aac8</password>
        <proxy_hostname/>
        <proxy_port/>
        <non_proxy_hosts/>
        <master>N</master>
        <sslMode>N</sslMode>
      </slaveserver>
      <slaveserver>
        <name>Slave3</name>
        <hostname>localhost</hostname>
        <port>8084</port>
        <webAppName/>
        <username>cluster</username>
        <password>Encrypted 2be98afc86aa7f2e4cb1aa265cd86aac8</password>
        <proxy_hostname/>
        <proxy_port/>
        <non_proxy_hosts/>
        <master>N</master>
        <sslMode>N</sslMode>
      </slaveserver>
      <slaveserver>
        <name>local DIS</name>
        <hostname>localhost</hostname>
        <port>9080</port>
        <webAppName>pentaho-di</webAppName>
        <username>admin</username>
        <password>Encrypted 2be98afc86aa7f2e4bb18bd63c99dbdde</password>
        <proxy_hostname/>
        <proxy_port/>
        <non_proxy_hosts/>
        <master>N</master>
        <sslMode>N</sslMode>
      </slaveserver>
      <slaveserver>
        <name>magspentahodev</name>
        <hostname>magspentahodev</hostname>
        <port>9080</port>
        <webAppName>pentaho-di</webAppName>
        <username>admin</username>
        <password>Encrypted 2be98afc86aa7f2e4bb18bd63c99dbdde</password>
        <proxy_hostname/>
        <proxy_port/>
        <non_proxy_hosts/>
        <master>Y</master>
        <sslMode>N</sslMode>
      </slaveserver>
    </slaveservers>
    <clusterschemas>
      <clusterschema>
        <name>4sbi_admin</name>
        <base_port>40000</base_port>
        <sockets_buffer_size>2000</sockets_buffer_size>
        <sockets_flush_interval>5000</sockets_flush_interval>
        <sockets_compressed>Y</sockets_compressed>
        <dynamic>N</dynamic>
        <slaveservers>
        </slaveservers>
      </clusterschema>
      <clusterschema>
        <name>ClusterSchema</name>
        <base_port>40000</base_port>
        <sockets_buffer_size>2000</sockets_buffer_size>
        <sockets_flush_interval>5000</sockets_flush_interval>
        <sockets_compressed>Y</sockets_compressed>
        <dynamic>N</dynamic>
        <slaveservers>
          <name>Slave3</name>
          <name>Slave2</name>
          <name>Slave1</name>
          <name>Master</name>
        </slaveservers>
      </clusterschema>
      <clusterschema>
        <name>cluster A</name>
        <base_port>40000</base_port>
        <sockets_buffer_size>2000</sockets_buffer_size>
        <sockets_flush_interval>5000</sockets_flush_interval>
        <sockets_compressed>Y</sockets_compressed>
        <dynamic>N</dynamic>
        <slaveservers>
          <name>Carte 1</name>
          <name>local DIS</name>
        </slaveservers>
      </clusterschema>
    </clusterschemas>
    <created_user>admin</created_user>
    <created_date>2018/10/12 15:37:57.039</created_date>
    <modified_user>-</modified_user>
    <modified_date>2018/05/15 12:05:59.689</modified_date>
    <key_for_session_key/>
    <is_key_private>N</is_key_private>
  </info>
  <notepads>
    <notepad>
      <note>Developer Notes:
Date        By      Desc
02/21/2012  Jma     Initial version
01/18/2013  Jma     Updated to split the Get Entity Info step to be three separate steps to improve performance.
03/04/2013  Jma     Updated to use different logic to get change eff date for DAILY and Historical load.
                    This is due to Entity's sys_update_time will be updated as SYSDATE when doing data conversion.
                    This is causing problem when getting legalentity IDs in Fact load.
07/31/2014  Jma     Fix dups and inconsistent output records.</note>
      <xloc>633</xloc>
      <yloc>1</yloc>
      <width>922</width>
      <heigth>130</heigth>
      <fontname>Courier New</fontname>
      <fontsize>10</fontsize>
      <fontbold>N</fontbold>
      <fontitalic>N</fontitalic>
      <fontcolorred>0</fontcolorred>
      <fontcolorgreen>0</fontcolorgreen>
      <fontcolorblue>0</fontcolorblue>
      <backgroundcolorred>151</backgroundcolorred>
      <backgroundcolorgreen>223</backgroundcolorgreen>
      <backgroundcolorblue>221</backgroundcolorblue>
      <bordercolorred>100</bordercolorred>
      <bordercolorgreen>100</bordercolorgreen>
      <bordercolorblue>100</bordercolorblue>
      <drawshadow>Y</drawshadow>
    </notepad>
  </notepads>
  <connection>
    <name>4SBI_Staging</name>
    <server>${G_STAGING_DB_HOST}</server>
    <type>ORACLE</type>
    <access>Native</access>
    <database>${G_STAGING_DB_NAME}</database>
    <port>${G_STAGING_DB_PORT}</port>
    <username>${G_STAGING_DB_USERNAME}</username>
    <password>${G_STAGING_DB_PWD}</password>
    <servername/>
    <data_tablespace>${G_STAGING_DB_DATA}</data_tablespace>
    <index_tablespace>${G_STAGING_DB_INDEX}</index_tablespace>
    <attributes>
      <attribute>
        <code>FORCE_IDENTIFIERS_TO_LOWERCASE</code>
        <attribute>N</attribute>
      </attribute>
      <attribute>
        <code>FORCE_IDENTIFIERS_TO_UPPERCASE</code>
        <attribute>N</attribute>
      </attribute>
      <attribute>
        <code>IS_CLUSTERED</code>
        <attribute>N</attribute>
      </attribute>
      <attribute>
        <code>PORT_NUMBER</code>
        <attribute>${G_STAGING_DB_PORT}</attribute>
      </attribute>
      <attribute>
        <code>QUOTE_ALL_FIELDS</code>
        <attribute>N</attribute>
      </attribute>
      <attribute>
        <code>SUPPORTS_BOOLEAN_DATA_TYPE</code>
        <attribute>N</attribute>
      </attribute>
      <attribute>
        <code>USE_POOLING</code>
        <attribute>N</attribute>
      </attribute>
    </attributes>
  </connection>
  <connection>
    <name>Delphi_OLTP</name>
    <server>${G_OLTP_DB_HOST}</server>
    <type>ORACLE</type>
    <access>Native</access>
    <database>${G_OLTP_DB_NAME}</database>
    <port>${G_OLTP_DB_PORT}</port>
    <username>${G_OLTP_DB_USERNAME}</username>
    <password>${G_OLTP_DB_PWD}</password>
    <servername/>
    <data_tablespace>${G_OLTP_DB_DATA}</data_tablespace>
    <index_tablespace>${G_OLTP_DB_INDEX}</index_tablespace>
    <attributes>
      <attribute>
        <code>FORCE_IDENTIFIERS_TO_LOWERCASE</code>
        <attribute>N</attribute>
      </attribute>
      <attribute>
        <code>FORCE_IDENTIFIERS_TO_UPPERCASE</code>
        <attribute>N</attribute>
      </attribute>
      <attribute>
        <code>IS_CLUSTERED</code>
        <attribute>N</attribute>
      </attribute>
      <attribute>
        <code>PORT_NUMBER</code>
        <attribute>${G_OLTP_DB_PORT}</attribute>
      </attribute>
      <attribute>
        <code>QUOTE_ALL_FIELDS</code>
        <attribute>N</attribute>
      </attribute>
      <attribute>
        <code>SUPPORTS_BOOLEAN_DATA_TYPE</code>
        <attribute>N</attribute>
      </attribute>
      <attribute>
        <code>USE_POOLING</code>
        <attribute>N</attribute>
      </attribute>
    </attributes>
  </connection>
  <order>
    <hop>
      <from>Add constants</from>
      <to>Get Variables</to>
      <enabled>Y</enabled>
    </hop>
    <hop>
      <from>Dummy (do nothing)</from>
      <to>Switch / Case</to>
      <enabled>Y</enabled>
    </hop>
    <hop>
      <from>Entity Class</from>
      <to>Dummy (do nothing)</to>
      <enabled>Y</enabled>
    </hop>
    <hop>
      <from>Entity Only</from>
      <to>Dummy (do nothing)</to>
      <enabled>Y</enabled>
    </hop>
    <hop>
      <from>Entity Role</from>
      <to>Dummy (do nothing)</to>
      <enabled>Y</enabled>
    </hop>
    <hop>
      <from>Entity with Address</from>
      <to>Dummy (do nothing)</to>
      <enabled>Y</enabled>
    </hop>
    <hop>
      <from>Entity with address phone</from>
      <to>Dummy (do nothing)</to>
      <enabled>Y</enabled>
    </hop>
    <hop>
      <from>Get Entity Info</from>
      <to>Call DB Procedure</to>
      <enabled>Y</enabled>
    </hop>
    <hop>
      <from>Get Entity Info EC</from>
      <to>Call DB Procedure</to>
      <enabled>Y</enabled>
    </hop>
    <hop>
      <from>Get Entity Info ER</from>
      <to>Call DB Procedure</to>
      <enabled>Y</enabled>
    </hop>
    <hop>
      <from>Get Entity w/ Addr Chg</from>
      <to>Call DB Procedure</to>
      <enabled>Y</enabled>
    </hop>
    <hop>
      <from>Get System Parameter</from>
      <to>Java Script Format variable v_addr_type and v_phone_type</to>
      <enabled>Y</enabled>
    </hop>
    <hop>
      <from>Get Variables</from>
      <to>Get Version Number</to>
      <enabled>Y</enabled>
    </hop>
    <hop>
      <from>Get Version Number</from>
      <to>Select values</to>
      <enabled>Y</enabled>
    </hop>
    <hop>
      <from>If field value is null</from>
      <to>Get System Parameter</to>
      <enabled>Y</enabled>
    </hop>
    <hop>
      <from>If field value is null 2</from>
      <to>Stream lookup Parent ID</to>
      <enabled>Y</enabled>
    </hop>
    <hop>
      <from>Java Script Format variable v_addr_type and v_phone_type</from>
      <to>Entity Class</to>
      <enabled>Y</enabled>
    </hop>
    <hop>
      <from>Java Script Format variable v_addr_type and v_phone_type</from>
      <to>Entity Only</to>
      <enabled>Y</enabled>
    </hop>
    <hop>
      <from>Java Script Format variable v_addr_type and v_phone_type</from>
      <to>Entity Role</to>
      <enabled>Y</enabled>
    </hop>
    <hop>
      <from>Java Script Format variable v_addr_type and v_phone_type</from>
      <to>Entity with Address</to>
      <enabled>Y</enabled>
    </hop>
    <hop>
      <from>Java Script Format variable v_addr_type and v_phone_type</from>
      <to>Entity with address phone</to>
      <enabled>Y</enabled>
    </hop>
    <hop>
      <from>Java Script Format variable v_addr_type and v_phone_type</from>
      <to>Phone</to>
      <enabled>Y</enabled>
    </hop>
    <hop>
      <from>Load refresh date</from>
      <to>Get Variables 2</to>
      <enabled>Y</enabled>
    </hop>
    <hop>
      <from>Phone</from>
      <to>Dummy (do nothing)</to>
      <enabled>Y</enabled>
    </hop>
    <hop>
      <from>Stream lookup</from>
      <to>Java Script Get County Description</to>
      <enabled>Y</enabled>
    </hop>
    <hop>
      <from>Switch / Case Daily</from>
      <to>Get Entity Info</to>
      <enabled>Y</enabled>
    </hop>
    <hop>
      <from>Switch / Case Daily</from>
      <to>Get Entity Info EC</to>
      <enabled>Y</enabled>
    </hop>
    <hop>
      <from>Switch / Case Daily</from>
      <to>Get Entity Info ER</to>
      <enabled>Y</enabled>
    </hop>
    <hop>
      <from>Switch / Case Daily</from>
      <to>Get Entity w/ Addr Chg</to>
      <enabled>Y</enabled>
    </hop>
    <hop>
      <from>Table input County Code</from>
      <to>Stream lookup</to>
      <enabled>Y</enabled>
    </hop>
    <hop>
      <from>Table input Parent ID</from>
      <to>Stream lookup Parent ID</to>
      <enabled>Y</enabled>
    </hop>
    <hop>
      <from>Switch / Case</from>
      <to>Switch / Case Daily</to>
      <enabled>Y</enabled>
    </hop>
    <hop>
      <from>Switch / Case</from>
      <to>Switch / Case Hist</to>
      <enabled>Y</enabled>
    </hop>
    <hop>
      <from>Get Variables 2</from>
      <to>If field value is null</to>
      <enabled>Y</enabled>
    </hop>
    <hop>
      <from>Get Entity Info 2</from>
      <to>Call DB Procedure 2</to>
      <enabled>Y</enabled>
    </hop>
    <hop>
      <from>Get Entity Info EC 2</from>
      <to>Call DB Procedure 2</to>
      <enabled>Y</enabled>
    </hop>
    <hop>
      <from>Get Entity Info ER 2</from>
      <to>Call DB Procedure 2</to>
      <enabled>Y</enabled>
    </hop>
    <hop>
      <from>Get Entity w/ Addr Chg 2</from>
      <to>Call DB Procedure 2</to>
      <enabled>Y</enabled>
    </hop>
    <hop>
      <from>Switch / Case Hist</from>
      <to>Get Entity Info 2</to>
      <enabled>Y</enabled>
    </hop>
    <hop>
      <from>Switch / Case Hist</from>
      <to>Get Entity Info EC 2</to>
      <enabled>Y</enabled>
    </hop>
    <hop>
      <from>Switch / Case Hist</from>
      <to>Get Entity Info ER 2</to>
      <enabled>Y</enabled>
    </hop>
    <hop>
      <from>Switch / Case Hist</from>
      <to>Get Entity w/ Addr Chg 2</to>
      <enabled>Y</enabled>
    </hop>
    <hop>
      <from>Stream lookup Parent ID</from>
      <to>Sequence (STGLEGALENTITY_ID)</to>
      <enabled>Y</enabled>
    </hop>
    <hop>
      <from>Sequence (STGLEGALENTITY_ID)</from>
      <to>Extract Data to STG_LEGALENTITY</to>
      <enabled>Y</enabled>
    </hop>
    <hop>
      <from>Java Script Get County Description</from>
      <to>Add constants</to>
      <enabled>Y</enabled>
    </hop>
    <hop>
      <from>Select values</from>
      <to>Get Min Change Eff Date</to>
      <enabled>Y</enabled>
    </hop>
    <hop>
      <from>Get Min Change Eff Date</from>
      <to>If field value is null 2</to>
      <enabled>Y</enabled>
    </hop>
    <hop>
      <from>Call DB Procedure 2</from>
      <to>Dummy (do nothing) 2</to>
      <enabled>Y</enabled>
    </hop>
    <hop>
      <from>Call DB Procedure</from>
      <to>Dummy (do nothing) 2</to>
      <enabled>Y</enabled>
    </hop>
    <hop>
      <from>Dummy (do nothing) 2</from>
      <to>Stream lookup</to>
      <enabled>Y</enabled>
    </hop>
  </order>
  <step>
    <name>Add constants</name>
    <type>Constant</type>
    <description/>
    <distribute>Y</distribute>
    <custom_distribution/>
    <copies>1</copies>
    <partitioning>
      <method>none</method>
      <schema_name/>
    </partitioning>
    <fields>
      <field>
        <name>FILE_VERSION</name>
        <type>String</type>
        <format/>
        <currency/>
        <decimal/>
        <group/>
        <nullif>LENTY</nullif>
        <length>-1</length>
        <precision>-1</precision>
        <set_empty_string>N</set_empty_string>
      </field>
      <field>
        <name>SOURCE_SYSTEM</name>
        <type>String</type>
        <format/>
        <currency/>
        <decimal/>
        <group/>
        <nullif>OASIS</nullif>
        <length>-1</length>
        <precision>-1</precision>
        <set_empty_string>N</set_empty_string>
      </field>
      <field>
        <name>NULLSTRING</name>
        <type>String</type>
        <format/>
        <currency/>
        <decimal/>
        <group/>
        <nullif/>
        <length>-1</length>
        <precision>-1</precision>
        <set_empty_string>N</set_empty_string>
      </field>
    </fields>
    <cluster_schema/>
    <remotesteps>
      <input>
      </input>
      <output>
      </output>
    </remotesteps>
    <GUI>
      <xloc>413</xloc>
      <yloc>1018</yloc>
      <draw>Y</draw>
    </GUI>
  </step>
  <step>
    <name>Call DB Procedure</name>
    <type>DBProc</type>
    <description/>
    <distribute>Y</distribute>
    <custom_distribution/>
    <copies>1</copies>
    <partitioning>
      <method>none</method>
      <schema_name/>
    </partitioning>
    <connection>Delphi_OLTP</connection>
    <procedure>dw_staging_util.get_phone_numbers</procedure>
    <lookup>
      <arg>
        <name>ADDRESS_PK</name>
        <direction>IN</direction>
        <type>Number</type>
      </arg>
      <arg>
        <name>ENTITY_PK</name>
        <direction>IN</direction>
        <type>Number</type>
      </arg>
      <arg>
        <name>PHONE_NUMBER_PK</name>
        <direction>IN</direction>
        <type>Number</type>
      </arg>
      <arg>
        <name>PROCESS_FLAG</name>
        <direction>IN</direction>
        <type>String</type>
      </arg>
      <arg>
        <name>CURRENT_REFRESH_DATE</name>
        <direction>IN</direction>
        <type>Date</type>
      </arg>
      <arg>
        <name>LAST_REFRESH_START_TIME</name>
        <direction>IN</direction>
        <type>Date</type>
      </arg>
      <arg>
        <name>ENT_PHONE_TYPE</name>
        <direction>IN</direction>
        <type>String</type>
      </arg>
      <arg>
        <name>ENT_FAX_TYPE</name>
        <direction>IN</direction>
        <type>String</type>
      </arg>
      <arg>
        <name>ENT_MOBILE_TYPE</name>
        <direction>IN</direction>
        <type>String</type>
      </arg>
      <arg>
        <name>v_ent_phone_type</name>
        <direction>IN</direction>
        <type>String</type>
      </arg>
      <arg>
        <name>LENTY_TELEPHONE</name>
        <direction>OUT</direction>
        <type>String</type>
      </arg>
      <arg>
        <name>LENTY_FAX</name>
        <direction>OUT</direction>
        <type>String</type>
      </arg>
      <arg>
        <name>LENTY_MOBILE</name>
        <direction>OUT</direction>
        <type>String</type>
      </arg>
    </lookup>
    <result>
      <name/>
      <type>Number</type>
    </result>
    <auto_commit>Y</auto_commit>
    <cluster_schema/>
    <remotesteps>
      <input>
      </input>
      <output>
      </output>
    </remotesteps>
    <GUI>
      <xloc>617</xloc>
      <yloc>588</yloc>
      <draw>Y</draw>
    </GUI>
  </step>
  <step>
    <name>Call DB Procedure 2</name>
    <type>DBProc</type>
    <description/>
    <distribute>Y</distribute>
    <custom_distribution/>
    <copies>1</copies>
    <partitioning>
      <method>none</method>
      <schema_name/>
    </partitioning>
    <connection>Delphi_OLTP</connection>
    <procedure>dw_staging_util.get_phone_numbers</procedure>
    <lookup>
      <arg>
        <name>ADDRESS_PK</name>
        <direction>IN</direction>
        <type>Number</type>
      </arg>
      <arg>
        <name>ENTITY_PK</name>
        <direction>IN</direction>
        <type>Number</type>
      </arg>
      <arg>
        <name>PHONE_NUMBER_PK</name>
        <direction>IN</direction>
        <type>Number</type>
      </arg>
      <arg>
        <name>PROCESS_FLAG</name>
        <direction>IN</direction>
        <type>String</type>
      </arg>
      <arg>
        <name>CURRENT_REFRESH_DATE</name>
        <direction>IN</direction>
        <type>Date</type>
      </arg>
      <arg>
        <name>LAST_REFRESH_START_TIME</name>
        <direction>IN</direction>
        <type>Date</type>
      </arg>
      <arg>
        <name>ENT_PHONE_TYPE</name>
        <direction>IN</direction>
        <type>String</type>
      </arg>
      <arg>
        <name>ENT_FAX_TYPE</name>
        <direction>IN</direction>
        <type>String</type>
      </arg>
      <arg>
        <name>ENT_MOBILE_TYPE</name>
        <direction>IN</direction>
        <type>String</type>
      </arg>
      <arg>
        <name>v_ent_phone_type</name>
        <direction>IN</direction>
        <type>String</type>
      </arg>
      <arg>
        <name>LENTY_TELEPHONE</name>
        <direction>OUT</direction>
        <type>String</type>
      </arg>
      <arg>
        <name>LENTY_FAX</name>
        <direction>OUT</direction>
        <type>String</type>
      </arg>
      <arg>
        <name>LENTY_MOBILE</name>
        <direction>OUT</direction>
        <type>String</type>
      </arg>
    </lookup>
    <result>
      <name/>
      <type>Number</type>
    </result>
    <auto_commit>Y</auto_commit>
    <cluster_schema/>
    <remotesteps>
      <input>
      </input>
      <output>
      </output>
    </remotesteps>
    <GUI>
      <xloc>251</xloc>
      <yloc>597</yloc>
      <draw>Y</draw>
    </GUI>
  </step>
  <step>
    <name>Dummy (do nothing)</name>
    <type>Dummy</type>
    <description/>
    <distribute>Y</distribute>
    <custom_distribution/>
    <copies>1</copies>
    <partitioning>
      <method>none</method>
      <schema_name/>
    </partitioning>
    <cluster_schema/>
    <remotesteps>
      <input>
      </input>
      <output>
      </output>
    </remotesteps>
    <GUI>
      <xloc>413</xloc>
      <yloc>231</yloc>
      <draw>Y</draw>
    </GUI>
  </step>
  <step>
    <name>Dummy (do nothing) 2</name>
    <type>Dummy</type>
    <description/>
    <distribute>Y</distribute>
    <custom_distribution/>
    <copies>1</copies>
    <partitioning>
      <method>none</method>
      <schema_name/>
    </partitioning>
    <cluster_schema/>
    <remotesteps>
      <input>
      </input>
      <output>
      </output>
    </remotesteps>
    <GUI>
      <xloc>413</xloc>
      <yloc>663</yloc>
      <draw>Y</draw>
    </GUI>
  </step>
  <step>
    <name>Entity Class</name>
    <type>DBJoin</type>
    <description/>
    <distribute>Y</distribute>
    <custom_distribution/>
    <copies>1</copies>
    <partitioning>
      <method>none</method>
      <schema_name/>
    </partitioning>
    <connection>Delphi_OLTP</connection>
    <rowlimit>0</rowlimit>
    <sql>select entity_pk, 
       cast (null as number) address_pk,
       cast (null as number) phone_number_pk,
       cast (entity_class_pk as number) role_or_class_pk,
       'EC' process_flag
  from entity_class ec,
       entity e
 WHERE 1 = 1
   AND ((ec.sys_update_time > ? AND 
         ec.sys_update_time &lt;= ?)  
        OR 
        (e.sys_update_time > ? AND 
         e.sys_update_time &lt;= ?))
   and ec.entity_fk = e.entity_pk</sql>
    <outer_join>N</outer_join>
    <replace_vars>N</replace_vars>
    <parameter>
      <field>
        <name>LAST_REFRESH_START_TIME</name>
        <type>Date</type>
      </field>
      <field>
        <name>CURRENT_REFRESH_DATE</name>
        <type>Date</type>
      </field>
      <field>
        <name>LAST_REFRESH_START_TIME</name>
        <type>Date</type>
      </field>
      <field>
        <name>CURRENT_REFRESH_DATE</name>
        <type>Date</type>
      </field>
    </parameter>
    <cluster_schema/>
    <remotesteps>
      <input>
      </input>
      <output>
      </output>
    </remotesteps>
    <GUI>
      <xloc>257</xloc>
      <yloc>164</yloc>
      <draw>Y</draw>
    </GUI>
  </step>
  <step>
    <name>Entity Only</name>
    <type>DBJoin</type>
    <description/>
    <distribute>Y</distribute>
    <custom_distribution/>
    <copies>1</copies>
    <partitioning>
      <method>none</method>
      <schema_name/>
    </partitioning>
    <connection>Delphi_OLTP</connection>
    <rowlimit>0</rowlimit>
    <sql>select entity_pk,
       cast (null as number) address_pk,
       cast (null as number) phone_number_pk,
       cast (null as number) role_or_class_pk,
       'E' PROCESS_FLAG
  from entity
 where sys_update_Time > ?
   and sys_update_time &lt;= ?
   and nvl(DISCARDED_B,'x') &lt;&gt; 'Y'
   and not exists
     (select 1 
      from   entity_role er
      where  er.entity_fk = entity_pk)
   and not exists
     (select 1 
      from   entity_class ec
      where  ec.entity_fk = entity_pk)
  </sql>
    <outer_join>N</outer_join>
    <replace_vars>N</replace_vars>
    <parameter>
      <field>
        <name>LAST_REFRESH_START_TIME</name>
        <type>Date</type>
      </field>
      <field>
        <name>CURRENT_REFRESH_DATE</name>
        <type>Date</type>
      </field>
    </parameter>
    <cluster_schema/>
    <remotesteps>
      <input>
      </input>
      <output>
      </output>
    </remotesteps>
    <GUI>
      <xloc>87</xloc>
      <yloc>164</yloc>
      <draw>Y</draw>
    </GUI>
  </step>
  <step>
    <name>Entity Role</name>
    <type>DBJoin</type>
    <description/>
    <distribute>Y</distribute>
    <custom_distribution/>
    <copies>1</copies>
    <partitioning>
      <method>none</method>
      <schema_name/>
    </partitioning>
    <connection>Delphi_OLTP</connection>
    <rowlimit>0</rowlimit>
    <sql>select entity_pk, 
       cast (null as number) address_pk,
       cast (null as number) phone_number_pk,
       cast (entity_role_pk as number) role_or_class_pk,
       'ER' process_flag
  from entity_role er,
       entity e
 WHERE 1 = 1
   AND ((er.sys_update_time > ? AND 
         er.sys_update_time &lt;= ?)  
        OR 
        (e.sys_update_time > ? AND 
         e.sys_update_time &lt;= ?))
   and er.entity_fk = e.entity_pk</sql>
    <outer_join>N</outer_join>
    <replace_vars>N</replace_vars>
    <parameter>
      <field>
        <name>LAST_REFRESH_START_TIME</name>
        <type>Date</type>
      </field>
      <field>
        <name>CURRENT_REFRESH_DATE</name>
        <type>Date</type>
      </field>
      <field>
        <name>LAST_REFRESH_START_TIME</name>
        <type>Date</type>
      </field>
      <field>
        <name>CURRENT_REFRESH_DATE</name>
        <type>Date</type>
      </field>
    </parameter>
    <cluster_schema/>
    <remotesteps>
      <input>
      </input>
      <output>
      </output>
    </remotesteps>
    <GUI>
      <xloc>413</xloc>
      <yloc>163</yloc>
      <draw>Y</draw>
    </GUI>
  </step>
  <step>
    <name>Entity with Address</name>
    <type>DBJoin</type>
    <description/>
    <distribute>Y</distribute>
    <custom_distribution/>
    <copies>1</copies>
    <partitioning>
      <method>none</method>
      <schema_name/>
    </partitioning>
    <connection>Delphi_OLTP</connection>
    <rowlimit>0</rowlimit>
    <sql>select entity_pk,
       cast (address_pk as number) address_pk,
       cast (address_pk as number) phone_number_pk,
       cast (address_pk as number) role_or_class_pk,
       'A' process_flag
  from address a,
       entity e
 where a.sys_update_time > ?
   and a.sys_update_time &lt;= ?
   and a.source_table_name = 'ENTITY'
   and a.source_record_fk = e.entity_pk
   and (a.primary_address_b = ? or
        a.address_type_code = ?)
   and e.sys_update_time &lt; ?</sql>
    <outer_join>N</outer_join>
    <replace_vars>N</replace_vars>
    <parameter>
      <field>
        <name>LAST_REFRESH_START_TIME</name>
        <type>Date</type>
      </field>
      <field>
        <name>CURRENT_REFRESH_DATE</name>
        <type>Date</type>
      </field>
      <field>
        <name>v_ent_addr_type</name>
        <type>String</type>
      </field>
      <field>
        <name>ENT_ADDR_TYPE</name>
        <type>String</type>
      </field>
      <field>
        <name>CURRENT_REFRESH_DATE</name>
        <type>Date</type>
      </field>
    </parameter>
    <cluster_schema/>
    <remotesteps>
      <input>
      </input>
      <output>
      </output>
    </remotesteps>
    <GUI>
      <xloc>550</xloc>
      <yloc>164</yloc>
      <draw>Y</draw>
    </GUI>
  </step>
  <step>
    <name>Entity with address phone</name>
    <type>DBJoin</type>
    <description/>
    <distribute>Y</distribute>
    <custom_distribution/>
    <copies>1</copies>
    <partitioning>
      <method>none</method>
      <schema_name/>
    </partitioning>
    <connection>Delphi_OLTP</connection>
    <rowlimit>0</rowlimit>
    <sql>select entity_pk,
       cast (address_pk as number) address_pk,
       cast (address_pk as number) phone_number_pk,
       cast (address_pk as number) role_or_class_pk,
       'A' PROCESS_FLAG
  from phone_number pn,
       address a,
       entity e
 where pn.sys_update_time > ?
   and pn.sys_update_time &lt;= ?
   and (pn.primary_number_b = ? or
        pn.phone_number_type_code in(?,?,?))
   and a.address_pk = pn.source_record_fk
   and a.source_record_fk = e.entity_pk
   and e.sys_update_time &lt; ?
   and a.sys_update_time &lt; ?
</sql>
    <outer_join>N</outer_join>
    <replace_vars>N</replace_vars>
    <parameter>
      <field>
        <name>LAST_REFRESH_START_TIME</name>
        <type>Date</type>
      </field>
      <field>
        <name>CURRENT_REFRESH_DATE</name>
        <type>Date</type>
      </field>
      <field>
        <name>v_ent_phone_type</name>
        <type>String</type>
      </field>
      <field>
        <name>ENT_MOBILE_TYPE</name>
        <type>String</type>
      </field>
      <field>
        <name>ENT_FAX_TYPE</name>
        <type>String</type>
      </field>
      <field>
        <name>ENT_PHONE_TYPE</name>
        <type>String</type>
      </field>
      <field>
        <name>CURRENT_REFRESH_DATE</name>
        <type>Date</type>
      </field>
      <field>
        <name>CURRENT_REFRESH_DATE</name>
        <type>Date</type>
      </field>
    </parameter>
    <cluster_schema/>
    <remotesteps>
      <input>
      </input>
      <output>
      </output>
    </remotesteps>
    <GUI>
      <xloc>681</xloc>
      <yloc>164</yloc>
      <draw>Y</draw>
    </GUI>
  </step>
  <step>
    <name>Extract Data to STG_LEGALENTITY</name>
    <type>TableOutput</type>
    <description/>
    <distribute>Y</distribute>
    <custom_distribution/>
    <copies>1</copies>
    <partitioning>
      <method>none</method>
      <schema_name/>
    </partitioning>
    <connection>4SBI_Staging</connection>
    <schema/>
    <table>STG_LEGALENTITY</table>
    <commit>1000</commit>
    <truncate>N</truncate>
    <ignore_errors>N</ignore_errors>
    <use_batch>Y</use_batch>
    <specify_fields>Y</specify_fields>
    <partitioning_enabled>N</partitioning_enabled>
    <partitioning_field/>
    <partitioning_daily>N</partitioning_daily>
    <partitioning_monthly>Y</partitioning_monthly>
    <tablename_in_field>N</tablename_in_field>
    <tablename_field/>
    <tablename_in_table>Y</tablename_in_table>
    <return_keys>N</return_keys>
    <return_field/>
    <fields>
      <field>
        <column_name>SOURCE_SYSTEM</column_name>
        <stream_name>SOURCE_SYSTEM</stream_name>
      </field>
      <field>
        <column_name>EXTRACT_DATE</column_name>
        <stream_name>sysdate</stream_name>
      </field>
      <field>
        <column_name>LEGALENTITY_UNIQUEID</column_name>
        <stream_name>LEGALENTITY_UNIQUEID</stream_name>
      </field>
      <field>
        <column_name>LENTY_ROLE</column_name>
        <stream_name>v_4s_role_type</stream_name>
      </field>
      <field>
        <column_name>LENTY_TYPE</column_name>
        <stream_name>LENTY_ROLE</stream_name>
      </field>
      <field>
        <column_name>LENTY_TYPEDESCRIPTION</column_name>
        <stream_name>LENTY_TYPEDESCRIPTION</stream_name>
      </field>
      <field>
        <column_name>LENTY_NUMBER</column_name>
        <stream_name>LENTY_NUMBER</stream_name>
      </field>
      <field>
        <column_name>LENTY_NAME1</column_name>
        <stream_name>LENTY_NAME1</stream_name>
      </field>
      <field>
        <column_name>LENTY_NAME2</column_name>
        <stream_name>LENTY_NAME2</stream_name>
      </field>
      <field>
        <column_name>LENTY_DOB</column_name>
        <stream_name>LENTY_DOB</stream_name>
      </field>
      <field>
        <column_name>LENTY_GENDER</column_name>
        <stream_name>LENTY_GENDER</stream_name>
      </field>
      <field>
        <column_name>LENTY_MARITALSTATUS</column_name>
        <stream_name>LENTY_MARITALSTATUS</stream_name>
      </field>
      <field>
        <column_name>LENTY_ADDRESS1</column_name>
        <stream_name>LENTY_ADDRESS1</stream_name>
      </field>
      <field>
        <column_name>LENTY_ADDRESS2</column_name>
        <stream_name>LENTY_ADDRESS2</stream_name>
      </field>
      <field>
        <column_name>LENTY_ADDRESS3</column_name>
        <stream_name>LENTY_ADDRESS3</stream_name>
      </field>
      <field>
        <column_name>LENTY_COUNTY</column_name>
        <stream_name>v_county_desc</stream_name>
      </field>
      <field>
        <column_name>LENTY_CITY</column_name>
        <stream_name>LENTY_CITY</stream_name>
      </field>
      <field>
        <column_name>LENTY_STATE</column_name>
        <stream_name>LENTY_STATE</stream_name>
      </field>
      <field>
        <column_name>LENTY_POSTALCODE</column_name>
        <stream_name>LENTY_POSTALCODE</stream_name>
      </field>
      <field>
        <column_name>LENTY_COUNTRY</column_name>
        <stream_name>LENTY_COUNTRY</stream_name>
      </field>
      <field>
        <column_name>LENTY_TELEPHONE</column_name>
        <stream_name>LENTY_TELEPHONE</stream_name>
      </field>
      <field>
        <column_name>LENTY_FAX</column_name>
        <stream_name>LENTY_FAX</stream_name>
      </field>
      <field>
        <column_name>LENTY_MOBILE</column_name>
        <stream_name>LENTY_MOBILE</stream_name>
      </field>
      <field>
        <column_name>LENTY_EMAIL</column_name>
        <stream_name>LENTY_EMAIL</stream_name>
      </field>
      <field>
        <column_name>LENTY_WEBSITE</column_name>
        <stream_name>LENTY_WEBSITE</stream_name>
      </field>
      <field>
        <column_name>LENTY_FEINSSN</column_name>
        <stream_name>LENTY_FEINSSN</stream_name>
      </field>
      <field>
        <column_name>LENTY_JOBTITLE</column_name>
        <stream_name>LENTY_JOBTITLE</stream_name>
      </field>
      <field>
        <column_name>LENTY_CHANGEEFFECTIVEDATE</column_name>
        <stream_name>MIN_UPDATE_TIME</stream_name>
      </field>
      <field>
        <column_name>MMLENTY_MIDDLE_NAME</column_name>
        <stream_name>MMLENTY_MIDDLE_NAME</stream_name>
      </field>
      <field>
        <column_name>MMLENTY_LONG_NAME</column_name>
        <stream_name>MMLENTY_LONG_NAME</stream_name>
      </field>
      <field>
        <column_name>MMLENTY_PREFIX</column_name>
        <stream_name>MMLENTY_PREFIX</stream_name>
      </field>
      <field>
        <column_name>MMLENTY_SUFFIX</column_name>
        <stream_name>MMLENTY_SUFFIX</stream_name>
      </field>
      <field>
        <column_name>MMLENTY_CHAR1</column_name>
        <stream_name>MMLENTY_CHAR1</stream_name>
      </field>
      <field>
        <column_name>MMLENTY_CHAR2</column_name>
        <stream_name>MMLENTY_CHAR2</stream_name>
      </field>
      <field>
        <column_name>MMLENTY_CHAR3</column_name>
        <stream_name>MMLENTY_CHAR3</stream_name>
      </field>
      <field>
        <column_name>MMLENTY_CHAR4</column_name>
        <stream_name>MMLENTY_CHAR4</stream_name>
      </field>
      <field>
        <column_name>MMLENTY_CHAR5</column_name>
        <stream_name>MMLENTY_CHAR5</stream_name>
      </field>
      <field>
        <column_name>MMLENTY_NUM1</column_name>
        <stream_name>MMLENTY_NUM1</stream_name>
      </field>
      <field>
        <column_name>MMLENTY_NUM2</column_name>
        <stream_name>MMLENTY_NUM2</stream_name>
      </field>
      <field>
        <column_name>MMLENTY_NUM3</column_name>
        <stream_name>MMLENTY_NUM3</stream_name>
      </field>
      <field>
        <column_name>MMLENTY_DATE1</column_name>
        <stream_name>MMLENTY_DATE1</stream_name>
      </field>
      <field>
        <column_name>MMLENTY_DATE2</column_name>
        <stream_name>MMLENTY_DATE2</stream_name>
      </field>
      <field>
        <column_name>MMLENTY_DATE3</column_name>
        <stream_name>MMLENTY_DATE3</stream_name>
      </field>
      <field>
        <column_name>LOADDATE</column_name>
        <stream_name>loaddate</stream_name>
      </field>
      <field>
        <column_name>FILE_VERSION</column_name>
        <stream_name>FILE_VERSION_NEW</stream_name>
      </field>
      <field>
        <column_name>LEGALENTITY_PARENTUNIQUEID</column_name>
        <stream_name>LEGALENTITY_PARENTUNIQUE_ID</stream_name>
      </field>
      <field>
        <column_name>MMLENTY_FORMATTED_NAME</column_name>
        <stream_name>MMLENTY_FORMATTED_NAME</stream_name>
      </field>
      <field>
        <column_name>MMLENTY_VIP_B</column_name>
        <stream_name>Very_Important_Person_b</stream_name>
      </field>
      <field>
        <column_name>STGLEGALENTITY_ID</column_name>
        <stream_name>STGLEGALENTITY_ID</stream_name>
      </field>
    </fields>
    <cluster_schema/>
    <remotesteps>
      <input>
      </input>
      <output>
      </output>
    </remotesteps>
    <GUI>
      <xloc>816</xloc>
      <yloc>868</yloc>
      <draw>Y</draw>
    </GUI>
  </step>
  <step>
    <name>Get Entity Info</name>
    <type>DBJoin</type>
    <description/>
    <distribute>Y</distribute>
    <custom_distribution/>
    <copies>1</copies>
    <partitioning>
      <method>none</method>
      <schema_name/>
    </partitioning>
    <connection>Delphi_OLTP</connection>
    <rowlimit>0</rowlimit>
    <sql>-- This part returns Entity based data where we have no address for the entity or an entity role or entity class
--
SELECT e.entity_pk lenty_number,
       e.client_id legalEntity_uniqueID,
       e.title lenty_jobTitle,
       NVL(NVL(e.FIRST_NAME,e.DBA_NAME),' ') lenty_name1,
       NVL(e.LAST_NAME,e.ORGANIZATION_NAME) lenty_name2,
       e.web_address1 lenty_website,
       e.email_address1 lenty_email,
       'UNKNOWN' lenty_role,
       to_char(null) entity_sub_class_code ,       
       'Unknown' lenty_typeshortdesc,
       'Unknown' lenty_typeDescription,
       e.date_of_birth lenty_DOB,
       e.gender lenty_gender,
       e.marital_status lenty_maritalStatus,
       NVL(e.FEDERAL_TAX_ID,e.SOCIAL_SECURITY_NUMBER) lenty_feinSsn,
       e.middle_name mmlenty_middle_name,
       e.very_long_name mmlenty_long_name,
       e.prefix_name mmlenty_prefix,
       e.suffix_name mmlenty_suffix,
       e.char1 mmlenty_char1,
       e.char2 mmlenty_char2,
       e.char3 mmlenty_char3,
       e.char4 mmlenty_char4,
       e.char5 mmlenty_char5,
       e.num1 mmlenty_num1,
       e.num2 mmlenty_num2,
       e.num3 mmlenty_num3,
       trunc(e.date1) mmlenty_date1,
       trunc(e.date2) mmlenty_date2,
       trunc(e.date3) mmlenty_date3,
       null address_pk,
       to_char(null) address_type_code,
       null source_record_fk,
       to_char(null) source_table_name,
       to_char(null) address_name,
       to_char(null) lenty_address1,
       to_char(null) lenty_address2,
       to_char(null) lenty_address3,
       to_char(null) lenty_city,
       to_char(null) county_code,
       to_char(null) lenty_state,
       to_char(null) lenty_postalCode,
       to_char(null) lenty_country,               
       TRUNC(e.Sys_Update_Time) entity_sys_update_time,
       cs_get_client_name_formatted(e.entity_pk,?,?) mmlenty_formatted_name,
       e.Very_Important_Person_b
  FROM entity e
 WHERE entity_pk = ? 
   and not exists(select 'x'
                    from address a
                   where a.source_record_fk = e.entity_pk
                     and (a.primary_address_b = ? or
                          a.address_type_code = ?)) 
   and not exists(select 'x'
                    from entity_role er
                   where e.entity_pk = er.entity_fk)
   and not exists(select 'x'
                    from entity_class ec
                   where ec.entity_fk = e.entity_pk)
--
-- This part returns Entity based data where we have an address for the entity but no  entity role or entity class 
--
UNION  
SELECT e.entity_pk lenty_number,
       e.client_id legalEntity_uniqueID,
       e.title lenty_jobTitle,
       NVL(NVL(e.FIRST_NAME,e.DBA_NAME),' ') lenty_name1,
       NVL(e.LAST_NAME,e.ORGANIZATION_NAME) lenty_name2,
       e.web_address1 lenty_website,
       e.email_address1 lenty_email,
       'UNKNOWN' lenty_role,
       to_char(null) entity_sub_class_code ,       
       'Unknown' lenty_typeshortdesc,
       'Unknown' lenty_typeDescription,
       e.date_of_birth lenty_DOB,
       e.gender lenty_gender,
       e.marital_status lenty_maritalStatus,
       NVL(e.FEDERAL_TAX_ID,e.SOCIAL_SECURITY_NUMBER) lenty_feinSsn,
       e.middle_name mmlenty_middle_name,
       e.very_long_name mmlenty_long_name,
       e.prefix_name mmlenty_prefix,
       e.suffix_name mmlenty_suffix,
       e.char1 mmlenty_char1,
       e.char2 mmlenty_char2,
       e.char3 mmlenty_char3,
       e.char4 mmlenty_char4,
       e.char5 mmlenty_char5,
       e.num1 mmlenty_num1,
       e.num2 mmlenty_num2,
       e.num3 mmlenty_num3,
       trunc(e.date1) mmlenty_date1,
       trunc(e.date2) mmlenty_date2,
       trunc(e.date3) mmlenty_date3,
       a.address_pk,
       a.address_type_code,
       a.source_record_fk,
       a.source_table_name,
       a.address_name,
       a.address_line1,
       a.address_line2,
       a.address_line3,
       a.city,
       a.county_code,
       upper(substr(a.state_code,1,2)) state_code,
       NVL2(a.ZIP_PLUS_FOUR,a.ZIPCODE||'-'||a.ZIP_PLUS_FOUR,a.ZIPCODE) zipcode,
       a.country_code,                
       TRUNC(greatest(e.Sys_Update_Time, nvl(a.sys_update_time,to_date('1/1/1900','mm/dd/yyyy')))) entity_sys_update_time,
       cs_get_client_name_formatted(e.entity_pk,?,?) mmlenty_formatted_name,
       e.Very_Important_Person_b
  FROM entity e, address a
 WHERE entity_pk = ?
   AND a.source_record_fk(+) = e.entity_pk
   and a.address_pk = (select max(address_pk)
                         from address a1
                        where a1.source_record_fk = e.entity_pk
                          and (a1.primary_address_b = ? or
                               a1.address_type_code = ?))
   and not exists(select 'x'
                    from entity_role er
                   where e.entity_pk = er.entity_fk)
   and not exists(select 'x'
                    from entity_class ec
                   where ec.entity_fk = e.entity_pk)</sql>
    <outer_join>N</outer_join>
    <replace_vars>N</replace_vars>
    <parameter>
      <field>
        <name>PERSON_NAME_FORMAT</name>
        <type>String</type>
      </field>
      <field>
        <name>ORG_NAME_FORMAT</name>
        <type>String</type>
      </field>
      <field>
        <name>ENTITY_PK</name>
        <type>Number</type>
      </field>
      <field>
        <name>v_ent_addr_type</name>
        <type>String</type>
      </field>
      <field>
        <name>ENT_ADDR_TYPE</name>
        <type>String</type>
      </field>
      <field>
        <name>PERSON_NAME_FORMAT</name>
        <type>String</type>
      </field>
      <field>
        <name>ORG_NAME_FORMAT</name>
        <type>String</type>
      </field>
      <field>
        <name>ENTITY_PK</name>
        <type>Number</type>
      </field>
      <field>
        <name>v_ent_addr_type</name>
        <type>String</type>
      </field>
      <field>
        <name>ENT_ADDR_TYPE</name>
        <type>String</type>
      </field>
    </parameter>
    <cluster_schema/>
    <remotesteps>
      <input>
      </input>
      <output>
      </output>
    </remotesteps>
    <GUI>
      <xloc>816</xloc>
      <yloc>461</yloc>
      <draw>Y</draw>
    </GUI>
  </step>
  <step>
    <name>Get Entity Info 2</name>
    <type>DBJoin</type>
    <description/>
    <distribute>Y</distribute>
    <custom_distribution/>
    <copies>1</copies>
    <partitioning>
      <method>none</method>
      <schema_name/>
    </partitioning>
    <connection>Delphi_OLTP</connection>
    <rowlimit>0</rowlimit>
    <sql>-- This part returns Entity based data where we have no address for the entity or an entity role or entity class
--
SELECT e.entity_pk lenty_number,
       e.client_id legalEntity_uniqueID,
       e.title lenty_jobTitle,
       NVL(NVL(e.FIRST_NAME,e.DBA_NAME),' ') lenty_name1,
       NVL(e.LAST_NAME,e.ORGANIZATION_NAME) lenty_name2,
       e.web_address1 lenty_website,
       e.email_address1 lenty_email,
       'UNKNOWN' lenty_role,
       to_char(null) entity_sub_class_code ,       
       'Unknown' lenty_typeshortdesc,
       'Unknown' lenty_typeDescription,
       e.date_of_birth lenty_DOB,
       e.gender lenty_gender,
       e.marital_status lenty_maritalStatus,
       NVL(e.FEDERAL_TAX_ID,e.SOCIAL_SECURITY_NUMBER) lenty_feinSsn,
       e.middle_name mmlenty_middle_name,
       e.very_long_name mmlenty_long_name,
       e.prefix_name mmlenty_prefix,
       e.suffix_name mmlenty_suffix,
       e.char1 mmlenty_char1,
       e.char2 mmlenty_char2,
       e.char3 mmlenty_char3,
       e.char4 mmlenty_char4,
       e.char5 mmlenty_char5,
       e.num1 mmlenty_num1,
       e.num2 mmlenty_num2,
       e.num3 mmlenty_num3,
       trunc(e.date1) mmlenty_date1,
       trunc(e.date2) mmlenty_date2,
       trunc(e.date3) mmlenty_date3,
       null address_pk,
       to_char(null) address_type_code,
       null source_record_fk,
       to_char(null) source_table_name,
       to_char(null) address_name,
       to_char(null) lenty_address1,
       to_char(null) lenty_address2,
       to_char(null) lenty_address3,
       to_char(null) lenty_city,
       to_char(null) county_code,
       to_char(null) lenty_state,
       to_char(null) lenty_postalCode,
       to_char(null) lenty_country,               
       TRUNC(e.Sys_Update_Time) entity_sys_update_time,
       cs_get_client_name_formatted(e.entity_pk,?,?) mmlenty_formatted_name,
       e.Very_Important_Person_b
  FROM entity e
 WHERE entity_pk = ? 
   and not exists(select 'x'
                    from address a
                   where a.source_record_fk = e.entity_pk
                     and (a.primary_address_b = ? or
                          a.address_type_code = ?)) 
   and not exists(select 'x'
                    from entity_role er
                   where e.entity_pk = er.entity_fk)
   and not exists(select 'x'
                    from entity_class ec
                   where ec.entity_fk = e.entity_pk)
--
-- This part returns Entity based data where we have an address for the entity but no  entity role or entity class 
--
UNION  
SELECT e.entity_pk lenty_number,
       e.client_id legalEntity_uniqueID,
       e.title lenty_jobTitle,
       NVL(NVL(e.FIRST_NAME,e.DBA_NAME),' ') lenty_name1,
       NVL(e.LAST_NAME,e.ORGANIZATION_NAME) lenty_name2,
       e.web_address1 lenty_website,
       e.email_address1 lenty_email,
       'UNKNOWN' lenty_role,
       to_char(null) entity_sub_class_code ,       
       'Unknown' lenty_typeshortdesc,
       'Unknown' lenty_typeDescription,
       e.date_of_birth lenty_DOB,
       e.gender lenty_gender,
       e.marital_status lenty_maritalStatus,
       NVL(e.FEDERAL_TAX_ID,e.SOCIAL_SECURITY_NUMBER) lenty_feinSsn,
       e.middle_name mmlenty_middle_name,
       e.very_long_name mmlenty_long_name,
       e.prefix_name mmlenty_prefix,
       e.suffix_name mmlenty_suffix,
       e.char1 mmlenty_char1,
       e.char2 mmlenty_char2,
       e.char3 mmlenty_char3,
       e.char4 mmlenty_char4,
       e.char5 mmlenty_char5,
       e.num1 mmlenty_num1,
       e.num2 mmlenty_num2,
       e.num3 mmlenty_num3,
       trunc(e.date1) mmlenty_date1,
       trunc(e.date2) mmlenty_date2,
       trunc(e.date3) mmlenty_date3,
       a.address_pk,
       a.address_type_code,
       a.source_record_fk,
       a.source_table_name,
       a.address_name,
       a.address_line1,
       a.address_line2,
       a.address_line3,
       a.city,
       a.county_code,
       upper(substr(a.state_code,1,2)) state_code,
       NVL2(a.ZIP_PLUS_FOUR,a.ZIPCODE||'-'||a.ZIP_PLUS_FOUR,a.ZIPCODE) zipcode,
       a.country_code,                
       TRUNC(greatest(e.Sys_Update_Time, nvl(a.sys_update_time,to_date('1/1/1900','mm/dd/yyyy')))) entity_sys_update_time,
       cs_get_client_name_formatted(e.entity_pk,?,?) mmlenty_formatted_name,
       e.Very_Important_Person_b
  FROM entity e, address a
 WHERE entity_pk = ?
   AND a.source_record_fk(+) = e.entity_pk
   and a.address_pk = (select max(address_pk)
                         from address a1
                        where a1.source_record_fk = e.entity_pk
                          and (a1.primary_address_b = ? or
                               a1.address_type_code = ?))
   and not exists(select 'x'
                    from entity_role er
                   where e.entity_pk = er.entity_fk)
   and not exists(select 'x'
                    from entity_class ec
                   where ec.entity_fk = e.entity_pk)</sql>
    <outer_join>N</outer_join>
    <replace_vars>N</replace_vars>
    <parameter>
      <field>
        <name>PERSON_NAME_FORMAT</name>
        <type>String</type>
      </field>
      <field>
        <name>ORG_NAME_FORMAT</name>
        <type>String</type>
      </field>
      <field>
        <name>ENTITY_PK</name>
        <type>Number</type>
      </field>
      <field>
        <name>v_ent_addr_type</name>
        <type>String</type>
      </field>
      <field>
        <name>ENT_ADDR_TYPE</name>
        <type>String</type>
      </field>
      <field>
        <name>PERSON_NAME_FORMAT</name>
        <type>String</type>
      </field>
      <field>
        <name>ORG_NAME_FORMAT</name>
        <type>String</type>
      </field>
      <field>
        <name>ENTITY_PK</name>
        <type>Number</type>
      </field>
      <field>
        <name>v_ent_addr_type</name>
        <type>String</type>
      </field>
      <field>
        <name>ENT_ADDR_TYPE</name>
        <type>String</type>
      </field>
    </parameter>
    <cluster_schema/>
    <remotesteps>
      <input>
      </input>
      <output>
      </output>
    </remotesteps>
    <GUI>
      <xloc>376</xloc>
      <yloc>461</yloc>
      <draw>Y</draw>
    </GUI>
  </step>
  <step>
    <name>Get Entity Info EC</name>
    <type>DBJoin</type>
    <description/>
    <distribute>Y</distribute>
    <custom_distribution/>
    <copies>1</copies>
    <partitioning>
      <method>none</method>
      <schema_name/>
    </partitioning>
    <connection>Delphi_OLTP</connection>
    <rowlimit>0</rowlimit>
    <sql>-- This part returns Entity class based data where we have an address for the entity 
SELECT e.entity_pk lenty_number,
       e.client_id legalEntity_uniqueID,
       e.title lenty_jobTitle,
       NVL(NVL(e.FIRST_NAME,e.DBA_NAME),' ') lenty_name1,
       NVL(e.LAST_NAME,e.ORGANIZATION_NAME) lenty_name2,
       e.web_address1 lenty_website,
       e.email_address1 lenty_email,
       ec.entity_class_code lenty_role,
       ec.entity_sub_class_code ,       
       lc.short_description lenty_typeshortdesc,
       lc.Long_Description lenty_typeDescription,
       e.date_of_birth lenty_DOB,
       e.gender lenty_gender,
       e.marital_status lenty_maritalStatus,
       NVL(e.FEDERAL_TAX_ID,e.SOCIAL_SECURITY_NUMBER) lenty_feinSsn,
       e.middle_name mmlenty_middle_name,
       e.very_long_name mmlenty_long_name,
       e.prefix_name mmlenty_prefix,
       e.suffix_name mmlenty_suffix,
       e.char1 mmlenty_char1,
       e.char2 mmlenty_char2,
       e.char3 mmlenty_char3,
       e.char4 mmlenty_char4,
       e.char5 mmlenty_char5,
       e.num1 mmlenty_num1,
       e.num2 mmlenty_num2,
       e.num3 mmlenty_num3,
       trunc(e.date1) mmlenty_date1,
       trunc(e.date2) mmlenty_date2,
       trunc(e.date3) mmlenty_date3,
       a.address_pk,
       a.address_type_code,
       a.source_record_fk,
       a.source_table_name,
       a.address_name,
       a.address_line1 lenty_address1,
       a.address_line2 lenty_address2,
       a.address_line3 lenty_address3,
       a.city lenty_city,
       a.county_code,
       a.state_code lenty_state,
       NVL2(a.ZIP_PLUS_FOUR,a.ZIPCODE||'-'||a.ZIP_PLUS_FOUR,a.ZIPCODE) lenty_postalCode,
       a.country_code lenty_country,
       TRUNC(greatest(e.Sys_Update_Time, nvl(a.sys_update_time,to_date('1/1/1900','mm/dd/yyyy')))) entity_sys_update_time,
       cs_get_client_name_formatted(e.entity_pk,?,?) mmlenty_formatted_name,
       e.Very_Important_Person_b
  FROM entity e, entity_class ec, lookup_code lc, address a
 WHERE e.entity_pk = ec.entity_fk
   AND lc.code = ec.entity_class_code
   AND lc.lookup_type_code = 'ENTITY_CLASS_CODE'
   AND a.source_record_fk  = e.entity_pk
   and a.address_pk = (select max(address_pk)
                         from address a1
                        where a1.source_record_fk   = e.entity_pk
                          and (a1.primary_address_b = ? or
                               a1.address_type_code = ? ))
   and entity_pk = ?
   and entity_class_pk = ?

union    -- This part returns Entity class based data where we have no address for the entity 
SELECT e.entity_pk lenty_number,
       e.client_id legalEntity_uniqueID,
       e.title lenty_jobTitle,
       NVL(NVL(e.FIRST_NAME,e.DBA_NAME),' ') lenty_name1,
       NVL(e.LAST_NAME,e.ORGANIZATION_NAME) lenty_name2,
       e.web_address1 lenty_website,
       e.email_address1 lenty_email,
       ec.entity_class_code lenty_role,
       ec.entity_sub_class_code ,       
       lc.short_description lenty_typeshortdesc,
       lc.Long_Description lenty_typeDescription,
       e.date_of_birth lenty_DOB,
       e.gender lenty_gender,
       e.marital_status lenty_maritalStatus,
       NVL(e.FEDERAL_TAX_ID,e.SOCIAL_SECURITY_NUMBER) lenty_feinSsn,
       e.middle_name mmlenty_middle_name,
       e.very_long_name mmlenty_long_name,
       e.prefix_name mmlenty_prefix,
       e.suffix_name mmlenty_suffix,
       e.char1 mmlenty_char1,
       e.char2 mmlenty_char2,
       e.char3 mmlenty_char3,
       e.char4 mmlenty_char4,
       e.char5 mmlenty_char5,
       e.num1 mmlenty_num1,
       e.num2 mmlenty_num2,
       e.num3 mmlenty_num3,
       trunc(e.date1) mmlenty_date1,
       trunc(e.date2) mmlenty_date2,
       trunc(e.date3) mmlenty_date3,
       null address_pk,
       to_char(null) address_type_code,
       null source_record_fk,
       to_char(null) source_table_name,
       to_char(null) address_name,
       to_char(null)  lenty_address1,
       to_char(null) lenty_address2,
       to_char(null) lenty_address3,
       to_char(null) lenty_city,
       to_char(null) county_code,
       to_char(null) lenty_state,
       to_char(null) lenty_postalCode,
       to_char(null) lenty_country,
       TRUNC(greatest(e.Sys_Update_Time)) entity_sys_update_time,
       cs_get_client_name_formatted(e.entity_pk,?,?) mmlenty_formatted_name,
       e.Very_Important_Person_b
  FROM entity e, entity_class ec, lookup_code lc
 WHERE e.entity_pk = ec.entity_fk
   AND lc.code = ec.entity_class_code
   AND lc.lookup_type_code = 'ENTITY_CLASS_CODE'
   and not exists(select 'x'
                    from address a
                   where a.source_record_fk = e.entity_pk
                     and (a.primary_address_b = ? or
                               a.address_type_code = ? ))
   and entity_pk = ? 
   and entity_class_pk = ?
</sql>
    <outer_join>N</outer_join>
    <replace_vars>N</replace_vars>
    <parameter>
      <field>
        <name>PERSON_NAME_FORMAT</name>
        <type>String</type>
      </field>
      <field>
        <name>ORG_NAME_FORMAT</name>
        <type>String</type>
      </field>
      <field>
        <name>v_ent_addr_type</name>
        <type>String</type>
      </field>
      <field>
        <name>ENT_ADDR_TYPE</name>
        <type>String</type>
      </field>
      <field>
        <name>ENTITY_PK</name>
        <type>Number</type>
      </field>
      <field>
        <name>ROLE_OR_CLASS_PK</name>
        <type>Number</type>
      </field>
      <field>
        <name>PERSON_NAME_FORMAT</name>
        <type>String</type>
      </field>
      <field>
        <name>ORG_NAME_FORMAT</name>
        <type>String</type>
      </field>
      <field>
        <name>v_ent_addr_type</name>
        <type>String</type>
      </field>
      <field>
        <name>ENT_ADDR_TYPE</name>
        <type>String</type>
      </field>
      <field>
        <name>ENTITY_PK</name>
        <type>Number</type>
      </field>
      <field>
        <name>ROLE_OR_CLASS_PK</name>
        <type>Number</type>
      </field>
    </parameter>
    <cluster_schema/>
    <remotesteps>
      <input>
      </input>
      <output>
      </output>
    </remotesteps>
    <GUI>
      <xloc>600</xloc>
      <yloc>461</yloc>
      <draw>Y</draw>
    </GUI>
  </step>
  <step>
    <name>Get Entity Info EC 2</name>
    <type>DBJoin</type>
    <description/>
    <distribute>Y</distribute>
    <custom_distribution/>
    <copies>1</copies>
    <partitioning>
      <method>none</method>
      <schema_name/>
    </partitioning>
    <connection>Delphi_OLTP</connection>
    <rowlimit>0</rowlimit>
    <sql>-- This part returns Entity class based data where we have an address for the entity 
SELECT e.entity_pk lenty_number,
       e.client_id legalEntity_uniqueID,
       e.title lenty_jobTitle,
       NVL(NVL(e.FIRST_NAME,e.DBA_NAME),' ') lenty_name1,
       NVL(e.LAST_NAME,e.ORGANIZATION_NAME) lenty_name2,
       e.web_address1 lenty_website,
       e.email_address1 lenty_email,
       ec.entity_class_code lenty_role,
       ec.entity_sub_class_code ,       
       lc.short_description lenty_typeshortdesc,
       lc.Long_Description lenty_typeDescription,
       e.date_of_birth lenty_DOB,
       e.gender lenty_gender,
       e.marital_status lenty_maritalStatus,
       NVL(e.FEDERAL_TAX_ID,e.SOCIAL_SECURITY_NUMBER) lenty_feinSsn,
       e.middle_name mmlenty_middle_name,
       e.very_long_name mmlenty_long_name,
       e.prefix_name mmlenty_prefix,
       e.suffix_name mmlenty_suffix,
       e.char1 mmlenty_char1,
       e.char2 mmlenty_char2,
       e.char3 mmlenty_char3,
       e.char4 mmlenty_char4,
       e.char5 mmlenty_char5,
       e.num1 mmlenty_num1,
       e.num2 mmlenty_num2,
       e.num3 mmlenty_num3,
       trunc(e.date1) mmlenty_date1,
       trunc(e.date2) mmlenty_date2,
       trunc(e.date3) mmlenty_date3,
       a.address_pk,
       a.address_type_code,
       a.source_record_fk,
       a.source_table_name,
       a.address_name,
       a.address_line1 lenty_address1,
       a.address_line2 lenty_address2,
       a.address_line3 lenty_address3,
       a.city lenty_city,
       a.county_code,
       a.state_code lenty_state,
       NVL2(a.ZIP_PLUS_FOUR,a.ZIPCODE||'-'||a.ZIP_PLUS_FOUR,a.ZIPCODE) lenty_postalCode,
       a.country_code lenty_country,
       TRUNC(least(e.Sys_Update_Time, ec.Sys_Update_Time, nvl(ec.effective_from_date,to_date('1/1/1900','mm/dd/yyyy')), nvl(a.sys_update_time,to_date('1/1/1900','mm/dd/yyyy')))) entity_sys_update_time,
       cs_get_client_name_formatted(e.entity_pk,?,?) mmlenty_formatted_name,
       e.Very_Important_Person_b
  FROM entity e, entity_class ec, lookup_code lc, address a
 WHERE e.entity_pk = ec.entity_fk
   AND lc.code = ec.entity_class_code
   AND lc.lookup_type_code = 'ENTITY_CLASS_CODE'
   AND a.source_record_fk  = e.entity_pk
   and a.address_pk = (select max(address_pk)
                         from address a1
                        where a1.source_record_fk   = e.entity_pk
                          and (a1.primary_address_b = ? or
                               a1.address_type_code = ? ))
   and entity_pk = ?
   and entity_class_pk = ?

union    -- This part returns Entity class based data where we have no address for the entity 
SELECT e.entity_pk lenty_number,
       e.client_id legalEntity_uniqueID,
       e.title lenty_jobTitle,
       NVL(NVL(e.FIRST_NAME,e.DBA_NAME),' ') lenty_name1,
       NVL(e.LAST_NAME,e.ORGANIZATION_NAME) lenty_name2,
       e.web_address1 lenty_website,
       e.email_address1 lenty_email,
       ec.entity_class_code lenty_role,
       ec.entity_sub_class_code ,       
       lc.short_description lenty_typeshortdesc,
       lc.Long_Description lenty_typeDescription,
       e.date_of_birth lenty_DOB,
       e.gender lenty_gender,
       e.marital_status lenty_maritalStatus,
       NVL(e.FEDERAL_TAX_ID,e.SOCIAL_SECURITY_NUMBER) lenty_feinSsn,
       e.middle_name mmlenty_middle_name,
       e.very_long_name mmlenty_long_name,
       e.prefix_name mmlenty_prefix,
       e.suffix_name mmlenty_suffix,
       e.char1 mmlenty_char1,
       e.char2 mmlenty_char2,
       e.char3 mmlenty_char3,
       e.char4 mmlenty_char4,
       e.char5 mmlenty_char5,
       e.num1 mmlenty_num1,
       e.num2 mmlenty_num2,
       e.num3 mmlenty_num3,
       trunc(e.date1) mmlenty_date1,
       trunc(e.date2) mmlenty_date2,
       trunc(e.date3) mmlenty_date3,
       null address_pk,
       to_char(null) address_type_code,
       null source_record_fk,
       to_char(null) source_table_name,
       to_char(null) address_name,
       to_char(null)  lenty_address1,
       to_char(null) lenty_address2,
       to_char(null) lenty_address3,
       to_char(null) lenty_city,
       to_char(null) county_code,
       to_char(null) lenty_state,
       to_char(null) lenty_postalCode,
       to_char(null) lenty_country,
       TRUNC(least(e.Sys_Update_Time,nvl(ec.effective_from_date,to_date('1/1/1900','mm/dd/yyyy')), ec.Sys_Update_Time)) entity_sys_update_time,
       cs_get_client_name_formatted(e.entity_pk,?,?) mmlenty_formatted_name,
       e.Very_Important_Person_b
  FROM entity e, entity_class ec, lookup_code lc
 WHERE e.entity_pk = ec.entity_fk
   AND lc.code = ec.entity_class_code
   AND lc.lookup_type_code = 'ENTITY_CLASS_CODE'
   and not exists(select 'x'
                    from address a
                   where a.source_record_fk = e.entity_pk
                     and (a.primary_address_b = ? or
                               a.address_type_code = ? ))
   and entity_pk = ? 
   and entity_class_pk = ?
</sql>
    <outer_join>N</outer_join>
    <replace_vars>N</replace_vars>
    <parameter>
      <field>
        <name>PERSON_NAME_FORMAT</name>
        <type>String</type>
      </field>
      <field>
        <name>ORG_NAME_FORMAT</name>
        <type>String</type>
      </field>
      <field>
        <name>v_ent_addr_type</name>
        <type>String</type>
      </field>
      <field>
        <name>ENT_ADDR_TYPE</name>
        <type>String</type>
      </field>
      <field>
        <name>ENTITY_PK</name>
        <type>Number</type>
      </field>
      <field>
        <name>ROLE_OR_CLASS_PK</name>
        <type>Number</type>
      </field>
      <field>
        <name>PERSON_NAME_FORMAT</name>
        <type>String</type>
      </field>
      <field>
        <name>ORG_NAME_FORMAT</name>
        <type>String</type>
      </field>
      <field>
        <name>v_ent_addr_type</name>
        <type>String</type>
      </field>
      <field>
        <name>ENT_ADDR_TYPE</name>
        <type>String</type>
      </field>
      <field>
        <name>ENTITY_PK</name>
        <type>Number</type>
      </field>
      <field>
        <name>ROLE_OR_CLASS_PK</name>
        <type>Number</type>
      </field>
    </parameter>
    <cluster_schema/>
    <remotesteps>
      <input>
      </input>
      <output>
      </output>
    </remotesteps>
    <GUI>
      <xloc>155</xloc>
      <yloc>461</yloc>
      <draw>Y</draw>
    </GUI>
  </step>
  <step>
    <name>Get Entity Info ER</name>
    <type>DBJoin</type>
    <description/>
    <distribute>Y</distribute>
    <custom_distribution/>
    <copies>1</copies>
    <partitioning>
      <method>none</method>
      <schema_name/>
    </partitioning>
    <connection>Delphi_OLTP</connection>
    <rowlimit>0</rowlimit>
    <sql>-- This part returns Entity role based data where we have an address for the entity  
--  
SELECT e.entity_pk lenty_number,
       e.client_id legalEntity_uniqueID,
       e.title lenty_jobTitle,
       NVL(NVL(e.FIRST_NAME,e.DBA_NAME),' ') lenty_name1,
       NVL(e.LAST_NAME,e.ORGANIZATION_NAME) lenty_name2,
       e.web_address1 lenty_website,
       e.email_address1 lenty_email,
       er.role_type_code lenty_role,
       er.entity_sub_class_code ,       
       lc.short_description lenty_typeshortdesc,
       lc.Long_Description lenty_typeDescription,
       e.date_of_birth lenty_DOB,
       e.gender lenty_gender,
       e.marital_status lenty_maritalStatus,
       NVL(e.FEDERAL_TAX_ID,e.SOCIAL_SECURITY_NUMBER) lenty_feinSsn,
       e.middle_name mmlenty_middle_name,
       e.very_long_name mmlenty_long_name,
       e.prefix_name mmlenty_prefix,
       e.suffix_name mmlenty_suffix,
       e.char1 mmlenty_char1,
       e.char2 mmlenty_char2,
       e.char3 mmlenty_char3,
       e.char4 mmlenty_char4,
       e.char5 mmlenty_char5,
       e.num1 mmlenty_num1,
       e.num2 mmlenty_num2,
       e.num3 mmlenty_num3,
       trunc(e.date1) mmlenty_date1,
       trunc(e.date2) mmlenty_date2,
       trunc(e.date3) mmlenty_date3,
       a.address_pk,
       a.address_type_code,
       a.source_record_fk,
       a.source_table_name,
       a.address_name,
       a.address_line1 lenty_address1,
       a.address_line2 lenty_address2,
       a.address_line3 lenty_address3,
       a.city lenty_city,
       a.county_code,
       upper(substr(a.state_code,1,2)) lenty_state,
       NVL2(a.ZIP_PLUS_FOUR,a.ZIPCODE||'-'||a.ZIP_PLUS_FOUR,a.ZIPCODE) lenty_postalCode,
       a.country_code lenty_country,                
       TRUNC(greatest(e.Sys_Update_Time, nvl(a.sys_update_time,to_date('1/1/1900','mm/dd/yyyy')))) entity_sys_update_time,
       cs_get_client_name_formatted(e.entity_pk,?,?) mmlenty_formatted_name,
       e.Very_Important_Person_b
  FROM entity e, entity_role er, lookup_code lc, address a
 WHERE e.entity_pk = er.entity_fk
   AND lc.code = er.role_type_code
   AND lc.lookup_type_code = 'ROLE_TYPE_CODE'
   AND a.source_record_fk(+) = e.entity_pk
   and a.address_pk = (select max(address_pk)
                         from address a1
                        where a1.source_record_fk = e.entity_pk
                          and (a1.primary_address_b = ? or
                               a1.address_type_code = ?))
   and entity_pk = ?
   and entity_role_pk = ?
--
-- This part returns Entity role based data where we have no address for the entity  
--
union
SELECT e.entity_pk lenty_number,
       e.client_id legalEntity_uniqueID,
       e.title lenty_jobTitle,
       NVL(NVL(e.FIRST_NAME,e.DBA_NAME),' ') lenty_name1,
       NVL(e.LAST_NAME,e.ORGANIZATION_NAME) lenty_name2,
       e.web_address1 lenty_website,
       e.email_address1 lenty_email,
       er.role_type_code lenty_role,
       er.entity_sub_class_code ,       
       lc.short_description lenty_typeshortdesc,
       lc.Long_Description lenty_typeDescription,
       e.date_of_birth lenty_DOB,
       e.gender lenty_gender,
       e.marital_status lenty_maritalStatus,
       NVL(e.FEDERAL_TAX_ID,e.SOCIAL_SECURITY_NUMBER) lenty_feinSsn,
       e.middle_name mmlenty_middle_name,
       e.very_long_name mmlenty_long_name,
       e.prefix_name mmlenty_prefix,
       e.suffix_name mmlenty_suffix,
       e.char1 mmlenty_char1,
       e.char2 mmlenty_char2,
       e.char3 mmlenty_char3,
       e.char4 mmlenty_char4,
       e.char5 mmlenty_char5,
       e.num1 mmlenty_num1,
       e.num2 mmlenty_num2,
       e.num3 mmlenty_num3,
       trunc(e.date1) mmlenty_date1,
       trunc(e.date2) mmlenty_date2,
       trunc(e.date3) mmlenty_date3,
       null address_pk,
       to_char(null) address_type_code,
       null source_record_fk,
       to_char(null) source_table_name,
       to_char(null) address_name,
       to_char(null)  lenty_address1,
       to_char(null) lenty_address2,
       to_char(null) lenty_address3,
       to_char(null) lenty_city,
       to_char(null) county_code,
       to_char(null) lenty_state,
       to_char(null) lenty_postalCode,
       to_char(null) lenty_country,               
       TRUNC(e.Sys_Update_Time) entity_sys_update_time,
       cs_get_client_name_formatted(e.entity_pk,?,?) mmlenty_formatted_name,
       e.Very_Important_Person_b
  FROM entity e, entity_role er, lookup_code lc
 WHERE e.entity_pk = er.entity_fk
   AND lc.code = er.role_type_code
   AND lc.lookup_type_code = 'ROLE_TYPE_CODE'
   and not exists(select 'x'
                    from address a
                   where a.source_record_fk = e.entity_pk
                     and (a.primary_address_b = ? or
                          a.address_type_code = ?)) 
   and entity_pk = ? 
   and entity_role_pk = ?</sql>
    <outer_join>N</outer_join>
    <replace_vars>N</replace_vars>
    <parameter>
      <field>
        <name>PERSON_NAME_FORMAT</name>
        <type>String</type>
      </field>
      <field>
        <name>ORG_NAME_FORMAT</name>
        <type>Boolean</type>
      </field>
      <field>
        <name>v_ent_addr_type</name>
        <type>String</type>
      </field>
      <field>
        <name>ENT_ADDR_TYPE</name>
        <type>String</type>
      </field>
      <field>
        <name>ENTITY_PK</name>
        <type>Number</type>
      </field>
      <field>
        <name>ROLE_OR_CLASS_PK</name>
        <type>Number</type>
      </field>
      <field>
        <name>PERSON_NAME_FORMAT</name>
        <type>String</type>
      </field>
      <field>
        <name>ORG_NAME_FORMAT</name>
        <type>String</type>
      </field>
      <field>
        <name>v_ent_addr_type</name>
        <type>String</type>
      </field>
      <field>
        <name>ENT_ADDR_TYPE</name>
        <type>String</type>
      </field>
      <field>
        <name>ENTITY_PK</name>
        <type>Number</type>
      </field>
      <field>
        <name>ROLE_OR_CLASS_PK</name>
        <type>Number</type>
      </field>
    </parameter>
    <cluster_schema/>
    <remotesteps>
      <input>
      </input>
      <output>
      </output>
    </remotesteps>
    <GUI>
      <xloc>714</xloc>
      <yloc>461</yloc>
      <draw>Y</draw>
    </GUI>
  </step>
  <step>
    <name>Get Entity Info ER 2</name>
    <type>DBJoin</type>
    <description/>
    <distribute>Y</distribute>
    <custom_distribution/>
    <copies>1</copies>
    <partitioning>
      <method>none</method>
      <schema_name/>
    </partitioning>
    <connection>Delphi_OLTP</connection>
    <rowlimit>0</rowlimit>
    <sql>-- This part returns Entity role based data where we have an address for the entity  
--  
SELECT e.entity_pk lenty_number,
       e.client_id legalEntity_uniqueID,
       e.title lenty_jobTitle,
       NVL(NVL(e.FIRST_NAME,e.DBA_NAME),' ') lenty_name1,
       NVL(e.LAST_NAME,e.ORGANIZATION_NAME) lenty_name2,
       e.web_address1 lenty_website,
       e.email_address1 lenty_email,
       er.role_type_code lenty_role,
       er.entity_sub_class_code ,       
       lc.short_description lenty_typeshortdesc,
       lc.Long_Description lenty_typeDescription,
       e.date_of_birth lenty_DOB,
       e.gender lenty_gender,
       e.marital_status lenty_maritalStatus,
       NVL(e.FEDERAL_TAX_ID,e.SOCIAL_SECURITY_NUMBER) lenty_feinSsn,
       e.middle_name mmlenty_middle_name,
       e.very_long_name mmlenty_long_name,
       e.prefix_name mmlenty_prefix,
       e.suffix_name mmlenty_suffix,
       e.char1 mmlenty_char1,
       e.char2 mmlenty_char2,
       e.char3 mmlenty_char3,
       e.char4 mmlenty_char4,
       e.char5 mmlenty_char5,
       e.num1 mmlenty_num1,
       e.num2 mmlenty_num2,
       e.num3 mmlenty_num3,
       trunc(e.date1) mmlenty_date1,
       trunc(e.date2) mmlenty_date2,
       trunc(e.date3) mmlenty_date3,
       a.address_pk,
       a.address_type_code,
       a.source_record_fk,
       a.source_table_name,
       a.address_name,
       a.address_line1 lenty_address1,
       a.address_line2 lenty_address2,
       a.address_line3 lenty_address3,
       a.city lenty_city,
       a.county_code,
       upper(substr(a.state_code,1,2)) lenty_state,
       NVL2(a.ZIP_PLUS_FOUR,a.ZIPCODE||'-'||a.ZIP_PLUS_FOUR,a.ZIPCODE) lenty_postalCode,
       a.country_code lenty_country,                
       TRUNC(least(e.Sys_Update_Time, er.Sys_Update_Time, nvl(er.effective_from_date,to_date('1/1/1900','mm/dd/yyyy')), nvl(a.sys_update_time,to_date('1/1/1900','mm/dd/yyyy')))) entity_sys_update_time,
       cs_get_client_name_formatted(e.entity_pk,?,?) mmlenty_formatted_name,
       e.Very_Important_Person_b
  FROM entity e, entity_role er, lookup_code lc, address a
 WHERE e.entity_pk = er.entity_fk
   AND lc.code = er.role_type_code
   AND lc.lookup_type_code = 'ROLE_TYPE_CODE'
   AND er.source_table_name &lt;&gt; 'CLAIM'
   AND a.source_record_fk(+) = e.entity_pk
   and a.address_pk = (select max(address_pk)
                         from address a1
                        where a1.source_record_fk = e.entity_pk
                          and (a1.primary_address_b = ? or
                               a1.address_type_code = ?))
   and entity_pk = ?
   and entity_role_pk = ?
--
-- This part returns Entity role based data where we have no address for the entity  
--
union
SELECT e.entity_pk lenty_number,
       e.client_id legalEntity_uniqueID,
       e.title lenty_jobTitle,
       NVL(NVL(e.FIRST_NAME,e.DBA_NAME),' ') lenty_name1,
       NVL(e.LAST_NAME,e.ORGANIZATION_NAME) lenty_name2,
       e.web_address1 lenty_website,
       e.email_address1 lenty_email,
       er.role_type_code lenty_role,
       er.entity_sub_class_code ,       
       lc.short_description lenty_typeshortdesc,
       lc.Long_Description lenty_typeDescription,
       e.date_of_birth lenty_DOB,
       e.gender lenty_gender,
       e.marital_status lenty_maritalStatus,
       NVL(e.FEDERAL_TAX_ID,e.SOCIAL_SECURITY_NUMBER) lenty_feinSsn,
       e.middle_name mmlenty_middle_name,
       e.very_long_name mmlenty_long_name,
       e.prefix_name mmlenty_prefix,
       e.suffix_name mmlenty_suffix,
       e.char1 mmlenty_char1,
       e.char2 mmlenty_char2,
       e.char3 mmlenty_char3,
       e.char4 mmlenty_char4,
       e.char5 mmlenty_char5,
       e.num1 mmlenty_num1,
       e.num2 mmlenty_num2,
       e.num3 mmlenty_num3,
       trunc(e.date1) mmlenty_date1,
       trunc(e.date2) mmlenty_date2,
       trunc(e.date3) mmlenty_date3,
       null address_pk,
       to_char(null) address_type_code,
       null source_record_fk,
       to_char(null) source_table_name,
       to_char(null) address_name,
       to_char(null)  lenty_address1,
       to_char(null) lenty_address2,
       to_char(null) lenty_address3,
       to_char(null) lenty_city,
       to_char(null) county_code,
       to_char(null) lenty_state,
       to_char(null) lenty_postalCode,
       to_char(null) lenty_country,               
       TRUNC(least(e.Sys_Update_Time, er.Sys_Update_Time, nvl(er.effective_from_date,to_date('1/1/1900','mm/dd/yyyy')))) entity_sys_update_time,
       cs_get_client_name_formatted(e.entity_pk,?,?) mmlenty_formatted_name,
       e.Very_Important_Person_b
  FROM entity e, entity_role er, lookup_code lc
 WHERE e.entity_pk = er.entity_fk
   AND lc.code = er.role_type_code
   AND lc.lookup_type_code = 'ROLE_TYPE_CODE'
   AND er.source_table_name &lt;&gt; 'CLAIM'
   and not exists(select 'x'
                    from address a
                   where a.source_record_fk = e.entity_pk
                     and (a.primary_address_b = ? or
                          a.address_type_code = ?)) 
   and entity_pk = ? 
   and entity_role_pk = ?
-- This part returns Entity role based data where we have an address for the entity  
-- This part is for claim roles only 
union
SELECT e.entity_pk lenty_number,
       e.client_id legalEntity_uniqueID,
       e.title lenty_jobTitle,
       NVL(NVL(e.FIRST_NAME,e.DBA_NAME),' ') lenty_name1,
       NVL(e.LAST_NAME,e.ORGANIZATION_NAME) lenty_name2,
       e.web_address1 lenty_website,
       e.email_address1 lenty_email,
       er.role_type_code lenty_role,
       er.entity_sub_class_code ,       
       lc.short_description lenty_typeshortdesc,
       lc.Long_Description lenty_typeDescription,
       e.date_of_birth lenty_DOB,
       e.gender lenty_gender,
       e.marital_status lenty_maritalStatus,
       NVL(e.FEDERAL_TAX_ID,e.SOCIAL_SECURITY_NUMBER) lenty_feinSsn,
       e.middle_name mmlenty_middle_name,
       e.very_long_name mmlenty_long_name,
       e.prefix_name mmlenty_prefix,
       e.suffix_name mmlenty_suffix,
       e.char1 mmlenty_char1,
       e.char2 mmlenty_char2,
       e.char3 mmlenty_char3,
       e.char4 mmlenty_char4,
       e.char5 mmlenty_char5,
       e.num1 mmlenty_num1,
       e.num2 mmlenty_num2,
       e.num3 mmlenty_num3,
       trunc(e.date1) mmlenty_date1,
       trunc(e.date2) mmlenty_date2,
       trunc(e.date3) mmlenty_date3,
       a.address_pk,
       a.address_type_code,
       a.source_record_fk,
       a.source_table_name,
       a.address_name,
       a.address_line1 lenty_address1,
       a.address_line2 lenty_address2,
       a.address_line3 lenty_address3,
       a.city lenty_city,
       a.county_code,
       upper(substr(a.state_code,1,2)) lenty_state,
       NVL2(a.ZIP_PLUS_FOUR,a.ZIPCODE||'-'||a.ZIP_PLUS_FOUR,a.ZIPCODE) lenty_postalCode,
       a.country_code lenty_country,                
       TRUNC(least(e.Sys_Update_Time, er.Sys_Update_Time, nvl(er.effective_from_date,to_date('1/1/1900','mm/dd/yyyy')), nvl(a.sys_update_time,to_date('1/1/1900','mm/dd/yyyy')))) entity_sys_update_time,
       cs_get_client_name_formatted(e.entity_pk,?,?) mmlenty_formatted_name,
       e.Very_Important_Person_b
  FROM entity e, entity_role er, claim_participant_code lc, address a
 WHERE e.entity_pk = er.entity_fk
   AND lc.claim_participant_code = er.role_type_code
   AND er.source_table_name = 'CLAIM'
   AND a.source_record_fk(+) = e.entity_pk
   and a.address_pk = (select max(address_pk)
                         from address a1
                        where a1.source_record_fk = e.entity_pk
                          and (a1.primary_address_b = ? or
                               a1.address_type_code = ?))
   and entity_pk = ?
   and entity_role_pk = ?
--
-- This part returns Entity role based data where we have no address for the entity  
-- This part is for claim roles only
union
SELECT e.entity_pk lenty_number,
       e.client_id legalEntity_uniqueID,
       e.title lenty_jobTitle,
       NVL(NVL(e.FIRST_NAME,e.DBA_NAME),' ') lenty_name1,
       NVL(e.LAST_NAME,e.ORGANIZATION_NAME) lenty_name2,
       e.web_address1 lenty_website,
       e.email_address1 lenty_email,
       er.role_type_code lenty_role,
       er.entity_sub_class_code ,       
       lc.short_description lenty_typeshortdesc,
       lc.Long_Description lenty_typeDescription,
       e.date_of_birth lenty_DOB,
       e.gender lenty_gender,
       e.marital_status lenty_maritalStatus,
       NVL(e.FEDERAL_TAX_ID,e.SOCIAL_SECURITY_NUMBER) lenty_feinSsn,
       e.middle_name mmlenty_middle_name,
       e.very_long_name mmlenty_long_name,
       e.prefix_name mmlenty_prefix,
       e.suffix_name mmlenty_suffix,
       e.char1 mmlenty_char1,
       e.char2 mmlenty_char2,
       e.char3 mmlenty_char3,
       e.char4 mmlenty_char4,
       e.char5 mmlenty_char5,
       e.num1 mmlenty_num1,
       e.num2 mmlenty_num2,
       e.num3 mmlenty_num3,
       trunc(e.date1) mmlenty_date1,
       trunc(e.date2) mmlenty_date2,
       trunc(e.date3) mmlenty_date3,
       null address_pk,
       to_char(null) address_type_code,
       null source_record_fk,
       to_char(null) source_table_name,
       to_char(null) address_name,
       to_char(null)  lenty_address1,
       to_char(null) lenty_address2,
       to_char(null) lenty_address3,
       to_char(null) lenty_city,
       to_char(null) county_code,
       to_char(null) lenty_state,
       to_char(null) lenty_postalCode,
       to_char(null) lenty_country,               
       TRUNC(least(e.Sys_Update_Time, er.Sys_Update_Time, nvl(er.effective_from_date,to_date('1/1/1900','mm/dd/yyyy')))) entity_sys_update_time,
       cs_get_client_name_formatted(e.entity_pk,?,?) mmlenty_formatted_name,
       e.Very_Important_Person_b
  FROM entity e, entity_role er, claim_participant_code lc
 WHERE e.entity_pk = er.entity_fk
   AND lc.claim_participant_code = er.role_type_code
   AND er.source_table_name = 'CLAIM'
   and not exists(select 'x'
                    from address a
                   where a.source_record_fk = e.entity_pk
                     and (a.primary_address_b = ? or
                          a.address_type_code = ?)) 
   and entity_pk = ? 
   and entity_role_pk = ?</sql>
    <outer_join>N</outer_join>
    <replace_vars>N</replace_vars>
    <parameter>
      <field>
        <name>PERSON_NAME_FORMAT</name>
        <type>String</type>
      </field>
      <field>
        <name>ORG_NAME_FORMAT</name>
        <type>Boolean</type>
      </field>
      <field>
        <name>v_ent_addr_type</name>
        <type>String</type>
      </field>
      <field>
        <name>ENT_ADDR_TYPE</name>
        <type>String</type>
      </field>
      <field>
        <name>ENTITY_PK</name>
        <type>Number</type>
      </field>
      <field>
        <name>ROLE_OR_CLASS_PK</name>
        <type>Number</type>
      </field>
      <field>
        <name>PERSON_NAME_FORMAT</name>
        <type>String</type>
      </field>
      <field>
        <name>ORG_NAME_FORMAT</name>
        <type>String</type>
      </field>
      <field>
        <name>v_ent_addr_type</name>
        <type>String</type>
      </field>
      <field>
        <name>ENT_ADDR_TYPE</name>
        <type>String</type>
      </field>
      <field>
        <name>ENTITY_PK</name>
        <type>Number</type>
      </field>
      <field>
        <name>ROLE_OR_CLASS_PK</name>
        <type>Number</type>
      </field>
      <field>
        <name>PERSON_NAME_FORMAT</name>
        <type>String</type>
      </field>
      <field>
        <name>ORG_NAME_FORMAT</name>
        <type>Boolean</type>
      </field>
      <field>
        <name>v_ent_addr_type</name>
        <type>String</type>
      </field>
      <field>
        <name>ENT_ADDR_TYPE</name>
        <type>String</type>
      </field>
      <field>
        <name>ENTITY_PK</name>
        <type>Number</type>
      </field>
      <field>
        <name>ROLE_OR_CLASS_PK</name>
        <type>Number</type>
      </field>
      <field>
        <name>PERSON_NAME_FORMAT</name>
        <type>String</type>
      </field>
      <field>
        <name>ORG_NAME_FORMAT</name>
        <type>String</type>
      </field>
      <field>
        <name>v_ent_addr_type</name>
        <type>String</type>
      </field>
      <field>
        <name>ENT_ADDR_TYPE</name>
        <type>String</type>
      </field>
      <field>
        <name>ENTITY_PK</name>
        <type>Number</type>
      </field>
      <field>
        <name>ROLE_OR_CLASS_PK</name>
        <type>Number</type>
      </field>
    </parameter>
    <cluster_schema/>
    <remotesteps>
      <input>
      </input>
      <output>
      </output>
    </remotesteps>
    <GUI>
      <xloc>273</xloc>
      <yloc>461</yloc>
      <draw>Y</draw>
    </GUI>
  </step>
  <step>
    <name>Get Entity w/ Addr Chg</name>
    <type>DBJoin</type>
    <description/>
    <distribute>Y</distribute>
    <custom_distribution/>
    <copies>1</copies>
    <partitioning>
      <method>none</method>
      <schema_name/>
    </partitioning>
    <connection>Delphi_OLTP</connection>
    <rowlimit>0</rowlimit>
    <sql>-- This part returns Entity class based data where we have an address for the entity 
SELECT e.entity_pk lenty_number,
       e.client_id legalEntity_uniqueID,
       e.title lenty_jobTitle,
       NVL(NVL(e.FIRST_NAME,e.DBA_NAME),' ') lenty_name1,
       NVL(e.LAST_NAME,e.ORGANIZATION_NAME) lenty_name2,
       e.web_address1 lenty_website,
       e.email_address1 lenty_email,
       ec.entity_class_code lenty_role,
       ec.entity_sub_class_code ,       
       lc.short_description lenty_typeshortdesc,
       lc.Long_Description lenty_typeDescription,
       e.date_of_birth lenty_DOB,
       e.gender lenty_gender,
       e.marital_status lenty_maritalStatus,
       NVL(e.FEDERAL_TAX_ID,e.SOCIAL_SECURITY_NUMBER) lenty_feinSsn,
       e.middle_name mmlenty_middle_name,
       e.very_long_name mmlenty_long_name,
       e.prefix_name mmlenty_prefix,
       e.suffix_name mmlenty_suffix,
       e.char1 mmlenty_char1,
       e.char2 mmlenty_char2,
       e.char3 mmlenty_char3,
       e.char4 mmlenty_char4,
       e.char5 mmlenty_char5,
       e.num1 mmlenty_num1,
       e.num2 mmlenty_num2,
       e.num3 mmlenty_num3,
       trunc(e.date1) mmlenty_date1,
       trunc(e.date2) mmlenty_date2,
       trunc(e.date3) mmlenty_date3,
       a.address_pk,
       a.address_type_code,
       a.source_record_fk,
       a.source_table_name,
       a.address_name,
       a.address_line1 lenty_address1,
       a.address_line2 lenty_address2,
       a.address_line3 lenty_address3,
       a.city lenty_city,
       a.county_code,
       a.state_code lenty_state,
       NVL2(a.ZIP_PLUS_FOUR,a.ZIPCODE||'-'||a.ZIP_PLUS_FOUR,a.ZIPCODE) lenty_postalCode,
       a.country_code lenty_country,
       TRUNC(greatest(e.Sys_Update_Time, nvl(a.sys_update_time,to_date('1/1/1900','mm/dd/yyyy')))) entity_sys_update_time,
       cs_get_client_name_formatted(e.entity_pk,?,?) mmlenty_formatted_name,
       e.Very_Important_Person_b
  FROM entity e, entity_class ec, lookup_code lc, address a
 WHERE e.entity_pk = ec.entity_fk
   AND lc.code = ec.entity_class_code
   AND lc.lookup_type_code = 'ENTITY_CLASS_CODE'
   AND a.source_record_fk  = e.entity_pk
   and entity_pk = ?
   and a.address_pk = ?
union    -- This part returns Entity class based data where we have no address for the entity 
SELECT e.entity_pk lenty_number,
       e.client_id legalEntity_uniqueID,
       e.title lenty_jobTitle,
       NVL(NVL(e.FIRST_NAME,e.DBA_NAME),' ') lenty_name1,
       NVL(e.LAST_NAME,e.ORGANIZATION_NAME) lenty_name2,
       e.web_address1 lenty_website,
       e.email_address1 lenty_email,
       er.role_type_code lenty_role,
       er.entity_sub_class_code ,       
       lc.short_description lenty_typeshortdesc,
       lc.Long_Description lenty_typeDescription,
       e.date_of_birth lenty_DOB,
       e.gender lenty_gender,
       e.marital_status lenty_maritalStatus,
       NVL(e.FEDERAL_TAX_ID,e.SOCIAL_SECURITY_NUMBER) lenty_feinSsn,
       e.middle_name mmlenty_middle_name,
       e.very_long_name mmlenty_long_name,
       e.prefix_name mmlenty_prefix,
       e.suffix_name mmlenty_suffix,
       e.char1 mmlenty_char1,
       e.char2 mmlenty_char2,
       e.char3 mmlenty_char3,
       e.char4 mmlenty_char4,
       e.char5 mmlenty_char5,
       e.num1 mmlenty_num1,
       e.num2 mmlenty_num2,
       e.num3 mmlenty_num3,
       trunc(e.date1) mmlenty_date1,
       trunc(e.date2) mmlenty_date2,
       trunc(e.date3) mmlenty_date3,
       a.address_pk,
       a.address_type_code,
       a.source_record_fk,
       a.source_table_name,
       a.address_name,
       a.address_line1,
       a.address_line2,
       a.address_line3,
       a.city,
       a.county_code,
       upper(substr(a.state_code,1,2)) state_code,
       NVL2(a.ZIP_PLUS_FOUR,a.ZIPCODE||'-'||a.ZIP_PLUS_FOUR,a.ZIPCODE) zipcode,
       a.country_code,                
       TRUNC(greatest(e.Sys_Update_Time, nvl(a.sys_update_time,to_date('1/1/1900','mm/dd/yyyy')))) entity_sys_update_time,
       cs_get_client_name_formatted(e.entity_pk,?,?) mmlenty_formatted_name,
       e.Very_Important_Person_b
  FROM entity e, entity_role er, lookup_code lc, address a
 WHERE e.entity_pk = er.entity_fk
   AND lc.code = er.role_type_code
   AND lc.lookup_type_code = 'ROLE_TYPE_CODE'
   AND a.source_record_fk(+) = e.entity_pk
   and entity_pk = ?
   and a.address_pk = ?
</sql>
    <outer_join>N</outer_join>
    <replace_vars>N</replace_vars>
    <parameter>
      <field>
        <name>PERSON_NAME_FORMAT</name>
        <type>String</type>
      </field>
      <field>
        <name>ORG_NAME_FORMAT</name>
        <type>String</type>
      </field>
      <field>
        <name>ENTITY_PK</name>
        <type>Number</type>
      </field>
      <field>
        <name>ADDRESS_PK</name>
        <type>Number</type>
      </field>
      <field>
        <name>PERSON_NAME_FORMAT</name>
        <type>String</type>
      </field>
      <field>
        <name>ORG_NAME_FORMAT</name>
        <type>String</type>
      </field>
      <field>
        <name>ENTITY_PK</name>
        <type>Number</type>
      </field>
      <field>
        <name>ADDRESS_PK</name>
        <type>Number</type>
      </field>
    </parameter>
    <cluster_schema/>
    <remotesteps>
      <input>
      </input>
      <output>
      </output>
    </remotesteps>
    <GUI>
      <xloc>492</xloc>
      <yloc>461</yloc>
      <draw>Y</draw>
    </GUI>
  </step>
  <step>
    <name>Get Entity w/ Addr Chg 2</name>
    <type>DBJoin</type>
    <description/>
    <distribute>Y</distribute>
    <custom_distribution/>
    <copies>1</copies>
    <partitioning>
      <method>none</method>
      <schema_name/>
    </partitioning>
    <connection>Delphi_OLTP</connection>
    <rowlimit>0</rowlimit>
    <sql>-- This part returns Entity class based data where we have an address for the entity 
SELECT e.entity_pk lenty_number,
       e.client_id legalEntity_uniqueID,
       e.title lenty_jobTitle,
       NVL(NVL(e.FIRST_NAME,e.DBA_NAME),' ') lenty_name1,
       NVL(e.LAST_NAME,e.ORGANIZATION_NAME) lenty_name2,
       e.web_address1 lenty_website,
       e.email_address1 lenty_email,
       ec.entity_class_code lenty_role,
       ec.entity_sub_class_code ,       
       lc.short_description lenty_typeshortdesc,
       lc.Long_Description lenty_typeDescription,
       e.date_of_birth lenty_DOB,
       e.gender lenty_gender,
       e.marital_status lenty_maritalStatus,
       NVL(e.FEDERAL_TAX_ID,e.SOCIAL_SECURITY_NUMBER) lenty_feinSsn,
       e.middle_name mmlenty_middle_name,
       e.very_long_name mmlenty_long_name,
       e.prefix_name mmlenty_prefix,
       e.suffix_name mmlenty_suffix,
       e.char1 mmlenty_char1,
       e.char2 mmlenty_char2,
       e.char3 mmlenty_char3,
       e.char4 mmlenty_char4,
       e.char5 mmlenty_char5,
       e.num1 mmlenty_num1,
       e.num2 mmlenty_num2,
       e.num3 mmlenty_num3,
       trunc(e.date1) mmlenty_date1,
       trunc(e.date2) mmlenty_date2,
       trunc(e.date3) mmlenty_date3,
       a.address_pk,
       a.address_type_code,
       a.source_record_fk,
       a.source_table_name,
       a.address_name,
       a.address_line1 lenty_address1,
       a.address_line2 lenty_address2,
       a.address_line3 lenty_address3,
       a.city lenty_city,
       a.county_code,
       a.state_code lenty_state,
       NVL2(a.ZIP_PLUS_FOUR,a.ZIPCODE||'-'||a.ZIP_PLUS_FOUR,a.ZIPCODE) lenty_postalCode,
       a.country_code lenty_country,
       TRUNC(least(e.Sys_Update_Time, nvl(a.sys_update_time,to_date('1/1/1900','mm/dd/yyyy')))) entity_sys_update_time,
       cs_get_client_name_formatted(e.entity_pk,?,?) mmlenty_formatted_name,
       e.Very_Important_Person_b
  FROM entity e, entity_class ec, lookup_code lc, address a
 WHERE e.entity_pk = ec.entity_fk
   AND lc.code = ec.entity_class_code
   AND lc.lookup_type_code = 'ENTITY_CLASS_CODE'
   AND a.source_record_fk  = e.entity_pk
   and entity_pk = ?
   and decode(?,null,entity_class_pk,?) = entity_class_pk
   and a.address_pk = ?

union    -- This part returns Entity class based data where we have no address for the entity 
SELECT e.entity_pk lenty_number,
       e.client_id legalEntity_uniqueID,
       e.title lenty_jobTitle,
       NVL(NVL(e.FIRST_NAME,e.DBA_NAME),' ') lenty_name1,
       NVL(e.LAST_NAME,e.ORGANIZATION_NAME) lenty_name2,
       e.web_address1 lenty_website,
       e.email_address1 lenty_email,
       er.role_type_code lenty_role,
       er.entity_sub_class_code ,       
       lc.short_description lenty_typeshortdesc,
       lc.Long_Description lenty_typeDescription,
       e.date_of_birth lenty_DOB,
       e.gender lenty_gender,
       e.marital_status lenty_maritalStatus,
       NVL(e.FEDERAL_TAX_ID,e.SOCIAL_SECURITY_NUMBER) lenty_feinSsn,
       e.middle_name mmlenty_middle_name,
       e.very_long_name mmlenty_long_name,
       e.prefix_name mmlenty_prefix,
       e.suffix_name mmlenty_suffix,
       e.char1 mmlenty_char1,
       e.char2 mmlenty_char2,
       e.char3 mmlenty_char3,
       e.char4 mmlenty_char4,
       e.char5 mmlenty_char5,
       e.num1 mmlenty_num1,
       e.num2 mmlenty_num2,
       e.num3 mmlenty_num3,
       trunc(e.date1) mmlenty_date1,
       trunc(e.date2) mmlenty_date2,
       trunc(e.date3) mmlenty_date3,
       a.address_pk,
       a.address_type_code,
       a.source_record_fk,
       a.source_table_name,
       a.address_name,
       a.address_line1,
       a.address_line2,
       a.address_line3,
       a.city,
       a.county_code,
       upper(substr(a.state_code,1,2)) state_code,
       NVL2(a.ZIP_PLUS_FOUR,a.ZIPCODE||'-'||a.ZIP_PLUS_FOUR,a.ZIPCODE) zipcode,
       a.country_code,                
       TRUNC(least(e.Sys_Update_Time, nvl(a.sys_update_time,to_date('1/1/1900','mm/dd/yyyy')))) entity_sys_update_time,
       cs_get_client_name_formatted(e.entity_pk,?,?) mmlenty_formatted_name,
       e.Very_Important_Person_b
  FROM entity e, entity_role er, lookup_code lc, address a
 WHERE e.entity_pk = er.entity_fk
   AND lc.code = er.role_type_code
   AND lc.lookup_type_code = 'ROLE_TYPE_CODE'
   AND a.source_record_fk(+) = e.entity_pk
   and entity_pk = ?
   and decode(?,null,entity_role_pk,?) = entity_role_pk
   and a.address_pk = ?
</sql>
    <outer_join>N</outer_join>
    <replace_vars>N</replace_vars>
    <parameter>
      <field>
        <name>PERSON_NAME_FORMAT</name>
        <type>String</type>
      </field>
      <field>
        <name>ORG_NAME_FORMAT</name>
        <type>String</type>
      </field>
      <field>
        <name>ENTITY_PK</name>
        <type>Number</type>
      </field>
      <field>
        <name>ROLE_OR_CLASS_PK</name>
        <type>Number</type>
      </field>
      <field>
        <name>ROLE_OR_CLASS_PK</name>
        <type>Number</type>
      </field>
      <field>
        <name>ADDRESS_PK</name>
        <type>Number</type>
      </field>
      <field>
        <name>PERSON_NAME_FORMAT</name>
        <type>String</type>
      </field>
      <field>
        <name>ORG_NAME_FORMAT</name>
        <type>String</type>
      </field>
      <field>
        <name>ENTITY_PK</name>
        <type>Number</type>
      </field>
      <field>
        <name>ROLE_OR_CLASS_PK</name>
        <type>Number</type>
      </field>
      <field>
        <name>ROLE_OR_CLASS_PK</name>
        <type>Number</type>
      </field>
      <field>
        <name>ADDRESS_PK</name>
        <type>Number</type>
      </field>
    </parameter>
    <cluster_schema/>
    <remotesteps>
      <input>
      </input>
      <output>
      </output>
    </remotesteps>
    <GUI>
      <xloc>45</xloc>
      <yloc>461</yloc>
      <draw>Y</draw>
    </GUI>
  </step>
  <step>
    <name>Get Min Change Eff Date</name>
    <type>MemoryGroupBy</type>
    <description/>
    <distribute>Y</distribute>
    <custom_distribution/>
    <copies>1</copies>
    <partitioning>
      <method>none</method>
      <schema_name/>
    </partitioning>
    <give_back_row>N</give_back_row>
    <group>
      <field>
        <name>SYSDATE</name>
      </field>
      <field>
        <name>LENTY_NUMBER</name>
      </field>
      <field>
        <name>LEGALENTITY_UNIQUEID</name>
      </field>
      <field>
        <name>LENTY_JOBTITLE</name>
      </field>
      <field>
        <name>LENTY_NAME1</name>
      </field>
      <field>
        <name>LENTY_NAME2</name>
      </field>
      <field>
        <name>LENTY_WEBSITE</name>
      </field>
      <field>
        <name>LENTY_EMAIL</name>
      </field>
      <field>
        <name>LENTY_ROLE</name>
      </field>
      <field>
        <name>LENTY_TYPEDESCRIPTION</name>
      </field>
      <field>
        <name>LENTY_DOB</name>
      </field>
      <field>
        <name>LENTY_GENDER</name>
      </field>
      <field>
        <name>LENTY_MARITALSTATUS</name>
      </field>
      <field>
        <name>LENTY_FEINSSN</name>
      </field>
      <field>
        <name>MMLENTY_MIDDLE_NAME</name>
      </field>
      <field>
        <name>MMLENTY_LONG_NAME</name>
      </field>
      <field>
        <name>MMLENTY_PREFIX</name>
      </field>
      <field>
        <name>MMLENTY_SUFFIX</name>
      </field>
      <field>
        <name>MMLENTY_CHAR1</name>
      </field>
      <field>
        <name>MMLENTY_CHAR2</name>
      </field>
      <field>
        <name>MMLENTY_CHAR3</name>
      </field>
      <field>
        <name>MMLENTY_CHAR4</name>
      </field>
      <field>
        <name>MMLENTY_CHAR5</name>
      </field>
      <field>
        <name>MMLENTY_NUM1</name>
      </field>
      <field>
        <name>MMLENTY_NUM2</name>
      </field>
      <field>
        <name>MMLENTY_NUM3</name>
      </field>
      <field>
        <name>MMLENTY_DATE1</name>
      </field>
      <field>
        <name>MMLENTY_DATE2</name>
      </field>
      <field>
        <name>MMLENTY_DATE3</name>
      </field>
      <field>
        <name>LENTY_ADDRESS1</name>
      </field>
      <field>
        <name>LENTY_ADDRESS2</name>
      </field>
      <field>
        <name>LENTY_ADDRESS3</name>
      </field>
      <field>
        <name>LENTY_CITY</name>
      </field>
      <field>
        <name>LENTY_STATE</name>
      </field>
      <field>
        <name>LENTY_POSTALCODE</name>
      </field>
      <field>
        <name>LENTY_COUNTRY</name>
      </field>
      <field>
        <name>MMLENTY_FORMATTED_NAME</name>
      </field>
      <field>
        <name>VERY_IMPORTANT_PERSON_B</name>
      </field>
      <field>
        <name>LENTY_TELEPHONE</name>
      </field>
      <field>
        <name>LENTY_FAX</name>
      </field>
      <field>
        <name>LENTY_MOBILE</name>
      </field>
      <field>
        <name>v_county_desc</name>
      </field>
      <field>
        <name>v_4s_role_type</name>
      </field>
      <field>
        <name>SOURCE_SYSTEM</name>
      </field>
      <field>
        <name>loaddate</name>
      </field>
      <field>
        <name>FILE_VERSION_NEW</name>
      </field>
    </group>
    <fields>
      <field>
        <aggregate>MIN_UPDATE_TIME</aggregate>
        <subject>ENTITY_SYS_UPDATE_TIME</subject>
        <type>MIN</type>
        <valuefield/>
      </field>
    </fields>
    <cluster_schema/>
    <remotesteps>
      <input>
      </input>
      <output>
      </output>
    </remotesteps>
    <GUI>
      <xloc>628</xloc>
      <yloc>857</yloc>
      <draw>Y</draw>
    </GUI>
  </step>
  <step>
    <name>Get System Parameter</name>
    <type>DBJoin</type>
    <description/>
    <distribute>Y</distribute>
    <custom_distribution/>
    <copies>1</copies>
    <partitioning>
      <method>none</method>
      <schema_name/>
    </partitioning>
    <connection>Delphi_OLTP</connection>
    <rowlimit>0</rowlimit>
    <sql>  SELECT 
  dw_staging_util.get_dw_parameter('ENT_ADDR_TYPE') ent_addr_type,
  dw_staging_util.get_dw_parameter('ENT_PHONE_TYPE') ent_phone_type,
  dw_staging_util.get_dw_parameter('ENT_FAX_TYPE') ent_fax_type,
  dw_staging_util.get_dw_parameter('ENT_MOBILE_TYPE') ent_mobile_type,
  dw_staging_util.get_dw_parameter('COUNTY_DESC_TYPE') county_desc_type,
  nvl(dw_staging_util.get_dw_parameter('ENT_PERS_NAME_FORMAT'),'^L^, ^F^ ^M^') person_name_format,
  nvl(dw_staging_util.get_dw_parameter('ENT_ORG_NAME_FORMAT'),'^O^') org_name_format,
  sysdate 
  FROM dual</sql>
    <outer_join>N</outer_join>
    <replace_vars>N</replace_vars>
    <parameter>
    </parameter>
    <cluster_schema/>
    <remotesteps>
      <input>
      </input>
      <output>
      </output>
    </remotesteps>
    <GUI>
      <xloc>413</xloc>
      <yloc>8</yloc>
      <draw>Y</draw>
    </GUI>
  </step>
  <step>
    <name>Get Variables</name>
    <type>GetVariable</type>
    <description/>
    <distribute>Y</distribute>
    <custom_distribution/>
    <copies>1</copies>
    <partitioning>
      <method>none</method>
      <schema_name/>
    </partitioning>
    <fields>
      <field>
        <name>V_NUM</name>
        <variable>${G_VERSION_NUMBER}</variable>
        <type>String</type>
        <format/>
        <currency/>
        <decimal/>
        <group/>
        <length>-1</length>
        <precision>-1</precision>
        <trim_type>none</trim_type>
      </field>
      <field>
        <name>loaddate</name>
        <variable>${loadDate}</variable>
        <type>Date</type>
        <format/>
        <currency/>
        <decimal/>
        <group/>
        <length>-1</length>
        <precision>-1</precision>
        <trim_type>none</trim_type>
      </field>
    </fields>
    <cluster_schema/>
    <remotesteps>
      <input>
      </input>
      <output>
      </output>
    </remotesteps>
    <GUI>
      <xloc>513</xloc>
      <yloc>1018</yloc>
      <draw>Y</draw>
    </GUI>
  </step>
  <step>
    <name>Get Variables 2</name>
    <type>GetVariable</type>
    <description/>
    <distribute>Y</distribute>
    <custom_distribution/>
    <copies>1</copies>
    <partitioning>
      <method>none</method>
      <schema_name/>
    </partitioning>
    <fields>
      <field>
        <name>v_load_type</name>
        <variable>${G_STAGING_LOAD_TYPE}</variable>
        <type>String</type>
        <format/>
        <currency/>
        <decimal/>
        <group/>
        <length>-1</length>
        <precision>-1</precision>
        <trim_type>none</trim_type>
      </field>
    </fields>
    <cluster_schema/>
    <remotesteps>
      <input>
      </input>
      <output>
      </output>
    </remotesteps>
    <GUI>
      <xloc>196</xloc>
      <yloc>8</yloc>
      <draw>Y</draw>
    </GUI>
  </step>
  <step>
    <name>Get Version Number</name>
    <type>Calculator</type>
    <description/>
    <distribute>Y</distribute>
    <custom_distribution/>
    <copies>1</copies>
    <partitioning>
      <method>none</method>
      <schema_name/>
    </partitioning>
    <calculation>
      <field_name>FILE_VERSION_NEW</field_name>
      <calc_type>ADD</calc_type>
      <field_a>V_NUM</field_a>
      <field_b>FILE_VERSION</field_b>
      <field_c/>
      <value_type>String</value_type>
      <value_length>-1</value_length>
      <value_precision>-1</value_precision>
      <remove>N</remove>
      <conversion_mask/>
      <decimal_symbol/>
      <grouping_symbol/>
      <currency_symbol/>
    </calculation>
    <cluster_schema/>
    <remotesteps>
      <input>
      </input>
      <output>
      </output>
    </remotesteps>
    <GUI>
      <xloc>628</xloc>
      <yloc>1018</yloc>
      <draw>Y</draw>
    </GUI>
  </step>
  <step>
    <name>If field value is null</name>
    <type>IfNull</type>
    <description/>
    <distribute>Y</distribute>
    <custom_distribution/>
    <copies>1</copies>
    <partitioning>
      <method>none</method>
      <schema_name/>
    </partitioning>
    <replaceAllByValue/>
    <replaceAllMask/>
    <selectFields>N</selectFields>
    <selectValuesType>Y</selectValuesType>
    <setEmptyStringAll>N</setEmptyStringAll>
    <valuetypes>
      <valuetype>
        <name>Date</name>
        <value>${G_DEFAULT_DATE}</value>
        <mask>MM/dd/yyyy</mask>
        <set_type_empty_string>N</set_type_empty_string>
      </valuetype>
    </valuetypes>
    <fields>
      </fields>
    <cluster_schema/>
    <remotesteps>
      <input>
      </input>
      <output>
      </output>
    </remotesteps>
    <GUI>
      <xloc>298</xloc>
      <yloc>8</yloc>
      <draw>Y</draw>
    </GUI>
  </step>
  <step>
    <name>If field value is null 2</name>
    <type>IfNull</type>
    <description/>
    <distribute>Y</distribute>
    <custom_distribution/>
    <copies>1</copies>
    <partitioning>
      <method>none</method>
      <schema_name/>
    </partitioning>
    <replaceAllByValue/>
    <replaceAllMask/>
    <selectFields>Y</selectFields>
    <selectValuesType>N</selectValuesType>
    <setEmptyStringAll>N</setEmptyStringAll>
    <valuetypes>
      <valuetype>
        <name>Date</name>
        <value>${G_DEFAULT_DATE}</value>
        <mask>MM/dd/yyyy</mask>
        <set_type_empty_string>N</set_type_empty_string>
      </valuetype>
    </valuetypes>
    <fields>
      <field>
        <name>LENTY_NAME1</name>
        <value>${G_DEFAULT_TEXT}</value>
        <mask/>
        <set_empty_string>N</set_empty_string>
      </field>
    </fields>
    <cluster_schema/>
    <remotesteps>
      <input>
      </input>
      <output>
      </output>
    </remotesteps>
    <GUI>
      <xloc>628</xloc>
      <yloc>694</yloc>
      <draw>Y</draw>
    </GUI>
  </step>
  <step>
    <name>Java Script Format variable v_addr_type and v_phone_type</name>
    <type>ScriptValueMod</type>
    <description/>
    <distribute>N</distribute>
    <custom_distribution/>
    <copies>1</copies>
    <partitioning>
      <method>none</method>
      <schema_name/>
    </partitioning>
    <compatible>N</compatible>
    <optimizationLevel>9</optimizationLevel>
    <jsScripts>
      <jsScript>
        <jsScript_type>0</jsScript_type>
        <jsScript_name>Script 1</jsScript_name>
        <jsScript_script>//Script here

// If ENT_ADDR_TYPE is PRIMARY, return 'Y', else return the address type code to V_ADDR_TYPE
// If ENT_PHONE_TYPE is PRIMARY, return 'Y', else return the phone type code to V_PHONE_TYPE

var v_ent_addr_type;
var v_ent_phone_type;

// All entity
if (ENT_ADDR_TYPE == 'PRIMARY')
  {v_ent_addr_type = "Y";}
else
  {v_ent_addr_type = ENT_ADDR_TYPE;}

if (ENT_PHONE_TYPE == 'PRIMARY')
  {v_ent_phone_type = "Y";}
else
  {v_ent_phone_type = ENT_PHONE_TYPE;}


</jsScript_script>
      </jsScript>
    </jsScripts>
    <fields>
      <field>
        <name>v_ent_addr_type</name>
        <rename>v_ent_addr_type</rename>
        <type>String</type>
        <length>-1</length>
        <precision>-1</precision>
        <replace>N</replace>
      </field>
      <field>
        <name>v_ent_phone_type</name>
        <rename>v_ent_phone_type</rename>
        <type>String</type>
        <length>-1</length>
        <precision>-1</precision>
        <replace>N</replace>
      </field>
    </fields>
    <cluster_schema/>
    <remotesteps>
      <input>
      </input>
      <output>
      </output>
    </remotesteps>
    <GUI>
      <xloc>413</xloc>
      <yloc>76</yloc>
      <draw>Y</draw>
    </GUI>
  </step>
  <step>
    <name>Java Script Get County Description</name>
    <type>ScriptValueMod</type>
    <description/>
    <distribute>Y</distribute>
    <custom_distribution/>
    <copies>1</copies>
    <partitioning>
      <method>none</method>
      <schema_name/>
    </partitioning>
    <compatible>N</compatible>
    <optimizationLevel>9</optimizationLevel>
    <jsScripts>
      <jsScript>
        <jsScript_type>0</jsScript_type>
        <jsScript_name>Script 1</jsScript_name>
        <jsScript_script>//Script here


var v_county_desc;
var v_4s_role_type;

if (COUNTY_DESC_TYPE == 'SHORT')
  {v_county_desc = COUNTY_SHORT_DESC;}
else
  {v_county_desc = COUNTY_LONG_DESC;}

if (LENTY_ROLE == 'EXAMINER')
   { v_4s_role_type = 'ADJUSTER';}
else if (LENTY_ROLE == 'ISSUECOMP')
   { v_4s_role_type = 'COMPANY';}
else if (LENTY_ROLE == 'POLHOLDER')
   { v_4s_role_type = 'INSURED';}
else if (LENTY_ROLE == 'AGENT')
   { v_4s_role_type = 'PRODUCER';}
else if (LENTY_ROLE == 'BROKER')
   { v_4s_role_type = 'PRODUCER';}
else if (LENTY_ROLE == 'AGENCY')
   { v_4s_role_type = 'PRODUCER';}
else
   { v_4s_role_type = LENTY_ROLE;}

  
</jsScript_script>
      </jsScript>
    </jsScripts>
    <fields>
      <field>
        <name>v_county_desc</name>
        <rename>v_county_desc</rename>
        <type>String</type>
        <length>-1</length>
        <precision>-1</precision>
        <replace>N</replace>
      </field>
      <field>
        <name>v_4s_role_type</name>
        <rename>v_4s_role_type</rename>
        <type>String</type>
        <length>-1</length>
        <precision>-1</precision>
        <replace>N</replace>
      </field>
    </fields>
    <cluster_schema/>
    <remotesteps>
      <input>
      </input>
      <output>
      </output>
    </remotesteps>
    <GUI>
      <xloc>413</xloc>
      <yloc>868</yloc>
      <draw>Y</draw>
    </GUI>
  </step>
  <step>
    <name>Load refresh date</name>
    <type>TableInput</type>
    <description/>
    <distribute>Y</distribute>
    <custom_distribution/>
    <copies>1</copies>
    <partitioning>
      <method>none</method>
      <schema_name/>
    </partitioning>
    <connection>4SBI_Staging</connection>
    <sql>SELECT
  MAX(CURRENT_REFRESH_DATE) CURRENT_REFRESH_DATE
, MAX(LAST_REFRESH_START_TIME) LAST_REFRESH_START_TIME
FROM DW_REFRESH_DATE 

</sql>
    <limit>0</limit>
    <lookup/>
    <execute_each_row>N</execute_each_row>
    <variables_active>N</variables_active>
    <lazy_conversion_active>N</lazy_conversion_active>
    <cluster_schema/>
    <remotesteps>
      <input>
      </input>
      <output>
      </output>
    </remotesteps>
    <GUI>
      <xloc>86</xloc>
      <yloc>8</yloc>
      <draw>Y</draw>
    </GUI>
  </step>
  <step>
    <name>Phone</name>
    <type>DBJoin</type>
    <description/>
    <distribute>Y</distribute>
    <custom_distribution/>
    <copies>1</copies>
    <partitioning>
      <method>none</method>
      <schema_name/>
    </partitioning>
    <connection>Delphi_OLTP</connection>
    <rowlimit>0</rowlimit>
    <sql>select entity_pk,
       cast (null as number) address_pk,
       cast (pn.phone_number_pk as number) phone_number_pk,
       cast (null as number) role_or_class_pk,
       'E' PROCESS_FLAG
  from phone_number pn,
       entity e
 where pn.sys_update_time > ?
   and pn.sys_update_time &lt;= ?
   and (pn.primary_number_b = ? or
        pn.phone_number_type_code in(?,?,?))
   and e.entity_pk = pn.source_record_fk   
   and e.sys_update_time &lt; ?
   and not exists(select 'x'
                    from address a,
                         phone_number pn1
                   where  a.source_Record_fk = e.entity_pk
                     and  pn1.source_record_fk = a.address_pk
                     and  pn1.sys_update_time > ?
                     and  pn1.sys_update_time &lt;= ?) </sql>
    <outer_join>N</outer_join>
    <replace_vars>N</replace_vars>
    <parameter>
      <field>
        <name>LAST_REFRESH_START_TIME</name>
        <type>Date</type>
      </field>
      <field>
        <name>CURRENT_REFRESH_DATE</name>
        <type>Date</type>
      </field>
      <field>
        <name>v_ent_phone_type</name>
        <type>String</type>
      </field>
      <field>
        <name>ENT_PHONE_TYPE</name>
        <type>String</type>
      </field>
      <field>
        <name>ENT_FAX_TYPE</name>
        <type>String</type>
      </field>
      <field>
        <name>ENT_MOBILE_TYPE</name>
        <type>String</type>
      </field>
      <field>
        <name>CURRENT_REFRESH_DATE</name>
        <type>Date</type>
      </field>
      <field>
        <name>LAST_REFRESH_START_TIME</name>
        <type>Date</type>
      </field>
      <field>
        <name>CURRENT_REFRESH_DATE</name>
        <type>Date</type>
      </field>
    </parameter>
    <cluster_schema/>
    <remotesteps>
      <input>
      </input>
      <output>
      </output>
    </remotesteps>
    <GUI>
      <xloc>816</xloc>
      <yloc>164</yloc>
      <draw>Y</draw>
    </GUI>
  </step>
  <step>
    <name>Select values</name>
    <type>SelectValues</type>
    <description/>
    <distribute>Y</distribute>
    <custom_distribution/>
    <copies>1</copies>
    <partitioning>
      <method>none</method>
      <schema_name/>
    </partitioning>
    <fields>
      <select_unspecified>N</select_unspecified>
      <remove>
        <name>ADDRESS_PK_1</name>
      </remove>
      <remove>
        <name>ADDRESS_PK</name>
      </remove>
      <remove>
        <name>PERSON_NAME_FORMAT</name>
      </remove>
      <remove>
        <name>ORG_NAME_FORMAT</name>
      </remove>
      <remove>
        <name>ENTITY_PK</name>
      </remove>
      <remove>
        <name>PHONE_NUMBER_PK</name>
      </remove>
      <remove>
        <name>ROLE_OR_CLASS_PK</name>
      </remove>
      <remove>
        <name>PROCESS_FLAG</name>
      </remove>
      <remove>
        <name>ADDRESS_TYPE_CODE</name>
      </remove>
      <remove>
        <name>SOURCE_RECORD_FK</name>
      </remove>
      <remove>
        <name>SOURCE_TABLE_NAME</name>
      </remove>
      <remove>
        <name>ADDRESS_NAME</name>
      </remove>
      <remove>
        <name>LENTY_TYPESHORTDESC</name>
      </remove>
      <remove>
        <name>COUNTY_CODE</name>
      </remove>
      <remove>
        <name>COUNTY_DESC_TYPE</name>
      </remove>
      <remove>
        <name>COUNTY_LONG_DESC</name>
      </remove>
      <remove>
        <name>COUNTY_SHORT_DESC</name>
      </remove>
      <remove>
        <name>CURRENT_REFRESH_DATE</name>
      </remove>
      <remove>
        <name>ENT_ADDR_TYPE</name>
      </remove>
      <remove>
        <name>ENT_FAX_TYPE</name>
      </remove>
      <remove>
        <name>ENT_MOBILE_TYPE</name>
      </remove>
      <remove>
        <name>ENT_PHONE_TYPE</name>
      </remove>
      <remove>
        <name>ENTITY_SUB_CLASS_CODE</name>
      </remove>
      <remove>
        <name>FILE_VERSION</name>
      </remove>
      <remove>
        <name>LAST_REFRESH_START_TIME</name>
      </remove>
      <remove>
        <name>NULLSTRING</name>
      </remove>
      <remove>
        <name>v_ent_addr_type</name>
      </remove>
      <remove>
        <name>v_ent_phone_type</name>
      </remove>
      <remove>
        <name>v_load_type</name>
      </remove>
      <remove>
        <name>V_NUM</name>
      </remove>
    </fields>
    <cluster_schema/>
    <remotesteps>
      <input>
      </input>
      <output>
      </output>
    </remotesteps>
    <GUI>
      <xloc>628</xloc>
      <yloc>944</yloc>
      <draw>Y</draw>
    </GUI>
  </step>
  <step>
    <name>Sequence (STGLEGALENTITY_ID)</name>
    <type>Sequence</type>
    <description/>
    <distribute>Y</distribute>
    <custom_distribution/>
    <copies>1</copies>
    <partitioning>
      <method>none</method>
      <schema_name/>
    </partitioning>
    <valuename>STGLEGALENTITY_ID</valuename>
    <use_database>N</use_database>
    <connection/>
    <schema/>
    <seqname>SEQ_</seqname>
    <use_counter>Y</use_counter>
    <counter_name/>
    <start_at>${MAX_STGLEGALENTITY_ID}</start_at>
    <increment_by>1</increment_by>
    <max_value>999999999999999999</max_value>
    <cluster_schema/>
    <remotesteps>
      <input>
      </input>
      <output>
      </output>
    </remotesteps>
    <GUI>
      <xloc>817</xloc>
      <yloc>781</yloc>
      <draw>Y</draw>
    </GUI>
  </step>
  <step>
    <name>Stream lookup</name>
    <type>StreamLookup</type>
    <description/>
    <distribute>Y</distribute>
    <custom_distribution/>
    <copies>1</copies>
    <partitioning>
      <method>none</method>
      <schema_name/>
    </partitioning>
    <from>Table input County Code</from>
    <input_sorted>N</input_sorted>
    <preserve_memory>Y</preserve_memory>
    <sorted_list>N</sorted_list>
    <integer_pair>N</integer_pair>
    <lookup>
      <key>
        <name>COUNTY_CODE</name>
        <field>CODE</field>
      </key>
      <value>
        <name>COUNTY_LONG_DESC</name>
        <rename>COUNTY_LONG_DESC</rename>
        <default/>
        <type>String</type>
      </value>
      <value>
        <name>COUNTY_SHORT_DESC</name>
        <rename>COUNTY_SHORT_DESC</rename>
        <default/>
        <type>String</type>
      </value>
    </lookup>
    <cluster_schema/>
    <remotesteps>
      <input>
      </input>
      <output>
      </output>
    </remotesteps>
    <GUI>
      <xloc>413</xloc>
      <yloc>759</yloc>
      <draw>Y</draw>
    </GUI>
  </step>
  <step>
    <name>Stream lookup Parent ID</name>
    <type>StreamLookup</type>
    <description/>
    <distribute>Y</distribute>
    <custom_distribution/>
    <copies>1</copies>
    <partitioning>
      <method>none</method>
      <schema_name/>
    </partitioning>
    <from>Table input Parent ID</from>
    <input_sorted>N</input_sorted>
    <preserve_memory>Y</preserve_memory>
    <sorted_list>N</sorted_list>
    <integer_pair>N</integer_pair>
    <lookup>
      <key>
        <name>LEGALENTITY_UNIQUEID</name>
        <field>CLIENT_ID</field>
      </key>
      <value>
        <name>LEGALENTITY_PARENTUNIQUE_ID</name>
        <rename>LEGALENTITY_PARENTUNIQUE_ID</rename>
        <default/>
        <type>String</type>
      </value>
    </lookup>
    <cluster_schema/>
    <remotesteps>
      <input>
      </input>
      <output>
      </output>
    </remotesteps>
    <GUI>
      <xloc>816</xloc>
      <yloc>694</yloc>
      <draw>Y</draw>
    </GUI>
  </step>
  <step>
    <name>Switch / Case</name>
    <type>SwitchCase</type>
    <description/>
    <distribute>Y</distribute>
    <custom_distribution/>
    <copies>1</copies>
    <partitioning>
      <method>none</method>
      <schema_name/>
    </partitioning>
    <fieldname>v_load_type</fieldname>
    <use_contains>N</use_contains>
    <case_value_type>String</case_value_type>
    <case_value_format/>
    <case_value_decimal/>
    <case_value_group/>
    <default_target_step>Switch / Case Hist</default_target_step>
    <cases>
      <case>
        <value>DAILY</value>
        <target_step>Switch / Case Daily</target_step>
      </case>
    </cases>
    <cluster_schema/>
    <remotesteps>
      <input>
      </input>
      <output>
      </output>
    </remotesteps>
    <GUI>
      <xloc>413</xloc>
      <yloc>303</yloc>
      <draw>Y</draw>
    </GUI>
  </step>
  <step>
    <name>Switch / Case Daily</name>
    <type>SwitchCase</type>
    <description/>
    <distribute>Y</distribute>
    <custom_distribution/>
    <copies>1</copies>
    <partitioning>
      <method>none</method>
      <schema_name/>
    </partitioning>
    <fieldname>PROCESS_FLAG</fieldname>
    <use_contains>N</use_contains>
    <case_value_type>String</case_value_type>
    <case_value_format/>
    <case_value_decimal/>
    <case_value_group/>
    <default_target_step/>
    <cases>
      <case>
        <value>E</value>
        <target_step>Get Entity Info</target_step>
      </case>
      <case>
        <value>A</value>
        <target_step>Get Entity w/ Addr Chg</target_step>
      </case>
      <case>
        <value>EC</value>
        <target_step>Get Entity Info EC</target_step>
      </case>
      <case>
        <value>ER</value>
        <target_step>Get Entity Info ER</target_step>
      </case>
    </cases>
    <cluster_schema/>
    <remotesteps>
      <input>
      </input>
      <output>
      </output>
    </remotesteps>
    <GUI>
      <xloc>660</xloc>
      <yloc>346</yloc>
      <draw>Y</draw>
    </GUI>
  </step>
  <step>
    <name>Switch / Case Hist</name>
    <type>SwitchCase</type>
    <description/>
    <distribute>Y</distribute>
    <custom_distribution/>
    <copies>1</copies>
    <partitioning>
      <method>none</method>
      <schema_name/>
    </partitioning>
    <fieldname>PROCESS_FLAG</fieldname>
    <use_contains>N</use_contains>
    <case_value_type>String</case_value_type>
    <case_value_format/>
    <case_value_decimal/>
    <case_value_group/>
    <default_target_step/>
    <cases>
      <case>
        <value>E</value>
        <target_step>Get Entity Info 2</target_step>
      </case>
      <case>
        <value>A</value>
        <target_step>Get Entity w/ Addr Chg 2</target_step>
      </case>
      <case>
        <value>EC</value>
        <target_step>Get Entity Info EC 2</target_step>
      </case>
      <case>
        <value>ER</value>
        <target_step>Get Entity Info ER 2</target_step>
      </case>
    </cases>
    <cluster_schema/>
    <remotesteps>
      <input>
      </input>
      <output>
      </output>
    </remotesteps>
    <GUI>
      <xloc>256</xloc>
      <yloc>346</yloc>
      <draw>Y</draw>
    </GUI>
  </step>
  <step>
    <name>Table input County Code</name>
    <type>TableInput</type>
    <description/>
    <distribute>Y</distribute>
    <custom_distribution/>
    <copies>1</copies>
    <partitioning>
      <method>none</method>
      <schema_name/>
    </partitioning>
    <connection>Delphi_OLTP</connection>
    <sql>SELECT cc.code,
	   cc.short_description county_short_desc, 
       cc.long_description county_long_desc
FROM County_Code cc </sql>
    <limit>0</limit>
    <lookup/>
    <execute_each_row>N</execute_each_row>
    <variables_active>N</variables_active>
    <lazy_conversion_active>N</lazy_conversion_active>
    <cluster_schema/>
    <remotesteps>
      <input>
      </input>
      <output>
      </output>
    </remotesteps>
    <GUI>
      <xloc>272</xloc>
      <yloc>759</yloc>
      <draw>Y</draw>
    </GUI>
  </step>
  <step>
    <name>Table input Parent ID</name>
    <type>TableInput</type>
    <description/>
    <distribute>Y</distribute>
    <custom_distribution/>
    <copies>1</copies>
    <partitioning>
      <method>none</method>
      <schema_name/>
    </partitioning>
    <connection>Delphi_OLTP</connection>
    <sql>select ent.client_id,
       entmgr.client_id legalentity_parentunique_id
from   entity entmgr,
       entity ent,
       claims_staff cs,
       claims_staff csmgr
where  ent.entity_pk              = cs.entity_fk
  and  cs.manager_claims_staff_fk = csmgr.claims_staff_pk
  and  csmgr.entity_fk            = entmgr.entity_pk


</sql>
    <limit>0</limit>
    <lookup/>
    <execute_each_row>N</execute_each_row>
    <variables_active>N</variables_active>
    <lazy_conversion_active>N</lazy_conversion_active>
    <cluster_schema/>
    <remotesteps>
      <input>
      </input>
      <output>
      </output>
    </remotesteps>
    <GUI>
      <xloc>816</xloc>
      <yloc>588</yloc>
      <draw>Y</draw>
    </GUI>
  </step>
  <step_error_handling>
  </step_error_handling>
  <slave-step-copy-partition-distribution>
  </slave-step-copy-partition-distribution>
  <slave_transformation>N</slave_transformation>
</transformation>
